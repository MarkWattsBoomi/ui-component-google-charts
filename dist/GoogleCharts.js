!function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t){e.exports=React},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(2))},function(e,t,r){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),a=r(3),s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.onSearchChanged=function(e){this.props.isDesignTime||(manywho.state.setComponent(this.props.id,{search:e.target.value},this.props.flowKey,!0),this.forceUpdate())},t.prototype.onSearchEnter=function(e){13!=e.keyCode||this.props.isDesignTime||(e.stopPropagation(),this.search())},t.prototype.search=function(){if(!this.props.isDesignTime){var e=manywho.model.getComponent(this.props.id,this.props.flowKey),t=manywho.state.getComponent(this.props.id,this.props.flowKey);if(this.clearSelection(),e.objectDataRequest)manywho.engine.objectDataRequest(this.props.id,e.objectDataRequest,this.props.flowKey,manywho.settings.global("paging.table"),t.search,null,null,t.page);else{var r=(manywho.component.getDisplayColumns(e.columns)||[]).map(function(e){return e.typeElementPropertyId.toLowerCase()});this.setState({objectData:e.objectData.filter(function(e){return e.properties.filter(function(e){return-1!=r.indexOf(e.typeElementPropertyId)&&-1!=e.contentValue.toLowerCase().indexOf(t.search.toLowerCase())}).length>0})}),t.page=1,manywho.state.setComponent(this.props.id,t,this.props.flowKey,!0)}}},t.prototype.refresh=function(){this.props.isDesignTime||(manywho.state.setComponent(this.props.id,{search:""},this.props.flowKey,!0),this.search())},t.prototype.clearSelection=function(){this.setState({selectedRows:[]}),manywho.state.setComponent(this.props.id,{objectData:[]},this.props.flowKey,!0)},t.prototype.onRowClicked=function(e){var t=this.state.selectedRows,r=manywho.model.getComponent(this.props.id,this.props.flowKey);-1==t.indexOf(e.currentTarget.id)?r.isMultiSelect?t.push(e.currentTarget.id):t=[e.currentTarget.id]:t.splice(t.indexOf(e.currentTarget.id),1),this.setState({selectedRows:t}),manywho.state.setComponent(this.props.id,{objectData:manywho.component.getSelectedRows(r,t)},this.props.flowKey,!0)},t.prototype.onOutcome=function(e,t){var r=manywho.model.getComponent(this.props.id,this.props.flowKey);manywho.state.setComponent(r.id,{objectData:manywho.component.getSelectedRows(r,[e])},this.props.flowKey,!0);var o=this.props.flowKey,n=manywho.model.getOutcome(t,this.props.flowKey);manywho.engine.move(n,this.props.flowKey).then(function(){n.isOut&&manywho.engine.flowOut(n,o)})},t.prototype.onNext=function(){var e=manywho.model.getComponent(this.props.id,this.props.flowKey),t=manywho.state.getComponent(this.props.id,this.props.flowKey);t.page||(t.page=1),t.page++,manywho.state.setComponent(this.props.id,t,this.props.flowKey,!0),e.objectDataRequest||e.fileDataRequest?this.search():e.attributes.pagination&&manywho.utils.isEqual(e.attributes.pagination,"true",!0)&&this.forceUpdate()},t.prototype.onPrev=function(){var e=manywho.model.getComponent(this.props.id,this.props.flowKey),t=manywho.state.getComponent(this.props.id,this.props.flowKey);t.page--,manywho.state.setComponent(this.props.id,t,this.props.flowKey,!0),e.objectDataRequest||e.fileDataRequest?this.search():e.attributes.pagination&&manywho.utils.isEqual(e.attributes.pagination,"true",!0)&&this.forceUpdate()},t.prototype.getInitialState=function(){var e={};return e.selectedRows=[],e.windowWidth=window.innerWidth,e.sortByOrder="ASC",e.lastOrderBy="",e.objectData=null,e},t.prototype.componentWillMount=function(){var e=manywho.model.getComponent(this.props.id,this.props.flowKey);e.objectDataRequest||this.setState({objectData:e.objectData})},t.prototype.componentDidMount=function(){},t.prototype.componentWillReceiveProps=function(e){var t=manywho.model.getComponent(e.id,e.flowKey),r=this.props.isDesignTime?{error:null,loading:!1}:manywho.state.getComponent(this.props.id,this.props.flowKey)||{};t.objectDataRequest||t.fileDataRequest||!manywho.utils.isNullOrWhitespace(r.search)||!manywho.utils.isNullOrWhitespace(r.page)&&1!=r.page||this.setState({objectData:t.objectData})},t.prototype.componentWillUnmount=function(){},t.prototype.render=function(){manywho.log.info("Rendering Google Chart: "+this.props.id);var e=manywho.model.getComponent(this.props.id,this.props.flowKey),t=this.props.isDesignTime?{error:null,loading:!1}:manywho.state.getComponent(this.props.id,this.props.flowKey)||{};this.outcomes=manywho.model.getOutcomes(this.props.id,this.props.flowKey);var r=this.props.isDesignTime?[]:e.objectData;e.objectData&&t.objectData&&!this.state.objectData&&(r=e.objectData.map(function(e){var r=t.objectData.filter(function(t){return manywho.utils.isEqual(e.externalId,t.externalId)&&manywho.utils.isEqual(e.internalId,t.internalId)})[0];return r?manywho.utils.extend({},[e,r]):e}));var o=this.props.isDesignTime?[]:this.getDisplayColumns(e.columns,this.outcomes),a=e.objectDataRequest&&e.objectDataRequest.hasMoreResults||e.fileDataRequest&&e.fileDataRequest.hasMoreResults,s=null,i=this.outcomes.filter(function(e){return!e.isBulkAction}),l=this.outcomes.filter(function(e){return e.isBulkAction});t.objectData&&(r=t.objectData),s=t.error?n.createElement("div",{className:"table-error"},n.createElement("p",{className:"lead"},"state.error.message"),n.createElement("button",{className:"btn btn-danger",onClick:this.search},"Retry")):0==o.length?n.createElement("div",{className:"table-error"},n.createElement("p",{className:"lead"},"'No display columns have been defined for this table'")):this.renderChart(r||[],i,o);var p=[];if(0!=e.isVisible){p=p.concat(manywho.styling.getClasses(this.props.parentId,this.props.id,"google-chart",this.props.flowKey)),p=e.attributes&&e.attributes.classes?p.join(" ")+" "+e.attributes.classes:p.join(" ");void 0!==e.isValid&&0==e.isValid&&n.createElement("div",{className:"has-error"},n.createElement("span",{className:"help-block"},e.validationMessage)),0==e.isVisible&&(p+=" hidden");var c=[];return c.push(this.renderHeader(t.search,l,this.props.flowKey,e.isSearchable,this.onSearchChanged,this.onSearchEnter,this.search,e.objectDataRequest||e.fileDataRequest,this.refresh,this.props.isDesignTime,e)),c.push(s),c.push(this.renderFooter(t.page||1,a,this.onNext,this.onPrev,this.props.isDesignTime)),c.push(this.renderWait()),n.createElement("div",{className:p},n.createElement("div",{className:"panel panel-default"},n.createElement("div",{className:"panel-heading"},n.createElement("div",{className:"panel-body"},n.createElement("div",null,c)))))}p.push("hidden")},t.prototype.parseBoolean=function(e){return 1==e||0==e?e:null!=e&&"true"==e.toLowerCase()},t.prototype.convertToGoogleType=function(e){var t="string";return null!=e&&(e=e.toUpperCase())==manywho.component.contentTypes.number&&(t="number"),t},t.prototype.getDisplayColumns=function(e,t){var r=manywho.component.getDisplayColumns(e)||[];return t.filter(function(e){return!e.isBulkAction}).length>0&&r.unshift("mw-outcomes"),r},t.prototype.areBulkActionsDefined=function(e){return 0!=e.filter(function(e){return e.isBulkAction}).length},t.prototype.renderHeader=function(e,t,r,o,a,s,i,l,p,c,u){var h,d,f,m=manywho.utils.getLookUpKey(r),g=[],y=document.getElementById(m);if(l&&null!=u.attributes&&1==this.parseBoolean(u.attributes.enableRefresh)||l&&null==u.attributes){var b=!1;c&&(b=!0),f=n.createElement("button",{className:"btn btn-sm btn-default table-refresh",onClick:p,disabled:b},n.createElement("span",{className:"glyphicon glyphicon-refresh"}))}if(o){var v=!1;c&&(v=!0),h=n.createElement("div",{className:"input-group table-search"},n.createElement("input",{type:"text",className:"form-control",value:e,placeholder:"Search",onChange:a,onKeyUp:s},n.createElement("span",{className:"input-group-btn"},n.createElement("button",{className:"btn btn-default",onClick:i,disabled:v},n.createElement("span",{className:"glyphicon glyphicon-search"})))))}if(t){var w=t.map(function(e){return n.createElement(manywho.component.getByName("outcome"),{id:e.id,flowKey:r})});d=n.createElement("div",{className:"table-outcomes"},w)}return g=y&&y.clientWidth<768?[d,h,f]:[f,h,d],g.length>0?n.createElement("div",{className:"table-header clearfix"},g):null},t.prototype.renderFooter=function(e,t,r,o,a){var s=[];return(e>1||t)&&s.push(n.createElement(manywho.component.getByName("pagination"),{pageIndex:e,hasMoreResults:t,containerClasses:"pull-right",onNext:r,onPrev:o,isDesignTime:a})),s.length>0?n.createElement("div",{className:"table-footer clearfix"},s):null},t.prototype.renderChart=function(e,t,r){var o=manywho.model.getComponent(this.props.id,this.props.flowKey),s=[],i=[];if(null!=r&&r.length>0)for(var l=0;l<r.length;l++)i.push(r[l].label);if(s.push(i),null!=e&&e.length>0)for(var l=0;l<e.length;l++)if(null!=e[l].properties&&e[l].properties.length==i.length){for(var p=[],c=0;c<r.length;c++)for(var u=0;u<e[l].properties.length;u++)if(e[l].properties[u].typeElementPropertyId==r[c].typeElementPropertyId){if("number"==this.convertToGoogleType(r[c].contentType)){var h=parseFloat(e[l].properties[u].contentValue);1==isNaN(h)&&(h=0),p.push(h)}else p.push(e[l].properties[u].contentValue);break}s.push(p)}var d;if(o.attributes){var f={};for(var m in o.attributes)switch(m){case"chart":var g=this.chartNameToType(o.attributes[m]);d=g.name;for(var y in g.options)f[y]=g.options[y];break;case"classes":break;default:f[m]=o.attributes[m]}}else d="PieChart";return n.createElement("div",{id:this.props.id},n.createElement(a.default,{chartType:d,width:"100%",height:"100%",legendToggle:!0,data:s,options:f}))},t.prototype.renderWait=function(){},t.prototype.chartNameToType=function(e){var t={name:"",options:{}};switch(e.toLowerCase()){case"annotation":t.name="AnnotationChart";break;case"area":t.name="AreaChart";break;case"bar":t.name="BarChart";break;case"bubble":t.name="BubbleChart";break;case"calendar":t.name="Calendar";break;case"candlestick":t.name="CandlestickChart";break;case"column":t.name="ColumnChart";break;case"gantt":t.name="Gannt";break;case"gauge":t.name="Gauge";break;case"geo":t.name="GeoChart";break;case"line":t.name="LineChart";break;case"org":t.name="OrgChart";break;case"pie":t.name="PieChart";break;case"sankey":t.name="Sankey";break;case"scatter":t.name="ScatterChart";break;case"steppedarea":t.name="SteppedAreaChart";break;case"table":t.name="Table";break;case"timelines":t.name="TimeLine";break;case"treemap":t.name="TreeMap";break;case"trend":t.options.trendlines={0:{}},t.name="ScatterChart";break;case"wordtree":t.options.wordtree={format:"implicit",word:"cats"},t.name="WordTree";break;default:t.name="PieChart"}return t},t}(n.Component);manywho.component.register("GoogleChart",s),t.default=s},function(e,t,r){"use strict";function o(e,t){function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function n(e,t,r,o){return new(r||(r=Promise))(function(n,a){function s(e){try{l(o.next(e))}catch(e){a(e)}}function i(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(s,i)}l((o=o.apply(e,t||[])).next())})}function a(e,t){function r(e){return function(t){return o([e,t])}}function o(r){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,a&&(s=2&r[0]?a.return:r[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,r[1])).done)return s;switch(a=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,a=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){l.label=r[1];break}if(6===r[0]&&l.label<s[1]){l.label=s[1],s=r;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(r);break}s[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(e){r=[6,e],a=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var n,a,s,i,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i}Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"Chart",function(){return y});var s=r(0),i=(r.n(s),r(4)),l=(r.n(i),function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)}),p=function(){return p=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},p.apply(this,arguments)},c=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],u=function(e){function t(t){var r=e.call(this,t)||this,o=document.getElementsByTagName("script");r.loadScript=!0;for(var n=0;n<o.length;n+=1)o[n].src.includes("gstatic.com/charts/loader.js")&&(r.loadScript=!1);return r}return o(t,e),t.prototype.componentDidMount=function(){!1===this.loadScript&&this.props.onLoad()},t.prototype.render=function(){var e=this.props,t=e.onError,r=e.onLoad;return!0===this.loadScript?Object(s.createElement)(i,{url:"https://www.gstatic.com/charts/loader.js",onError:function(){t()},onLoad:r}):null},t}(s.Component),h="#CCCCCC",d=0,f=function(){return"reactgooglegraph-"+(d+=1)},m={graph_id:null,legend_toggle:!1,graphID:null,options:{colors:null},data:null,rows:null,columns:null,diffdata:null,chartEvents:null,legendToggle:!1,chartActions:null,getChartWrapper:function(e,t){},className:"",style:{},formatters:null,spreadSheetUrl:null,spreadSheetQueryParameters:{headers:1,gid:1},rootProps:{}},g=function(e,t,r){return void 0===r&&(r={}),n(void 0,void 0,void 0,function(){return a(this,function(o){return[2,new Promise(function(o,n){var a=r.headers?"headers="+r.headers:"headers=0",s=r.query?"&tq="+encodeURIComponent(r.query):"",i=r.gid?"&gid="+r.gid:"",l=r.sheet?"&sheet="+r.sheet:"",p=""+a+i+l+s,c=t+"/gviz/tq?"+p;new e.visualization.Query(c).send(function(e){e.isError()?n("Error in query:  "+e.getMessage()+" "+e.getDetailedMessage()):o(e.getDataTable())})})]})})},y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={loadingStatus:"loading",google:null,hiddenColumns:[]},t.graphID=null,t.chartWrapper=null,t.getGraphID=function(){var e,r=t.props,o=r.graphID,n=r.graph_id;return e=null===o&&null===n?null===t.graphID?f():t.graphID:null!==o&&null===n?o:null!==n&&null===o?n:o,t.graphID=e,t.graphID},t.draw=function(){return n(t,void 0,void 0,function(){var e,t,r,o,n,s,i,l,p,c,u,h,d,f,m,y,b,v,w,C,D,T,E;return a(this,function(a){switch(a.label){case 0:return null===this.chartWrapper||null===this.state.google?[2]:(e=this.props,t=e.data,r=e.diffdata,o=e.columns,n=e.rows,s=e.options,i=e.legend_toggle,l=e.legendToggle,p=e.chartType,c=e.formatters,u=e.spreadSheetUrl,h=e.spreadSheetQueryParameters,f=null,null!==r&&(m=this.state.google.visualization.arrayToDataTable(r.old),y=this.state.google.visualization.arrayToDataTable(r.new),f=this.state.google.visualization[p].prototype.computeDiff(m,y)),null===t?[3,1]:(d=Array.isArray(t)?this.state.google.visualization.arrayToDataTable(t):new this.state.google.visualization.DataTable(t),[3,5]));case 1:return null===n||null===o?[3,2]:(d=this.state.google.visualization.arrayToDataTable([o].concat(n)),[3,5]);case 2:return null===u?[3,4]:[4,g(this.state.google,u,h)];case 3:return d=a.sent(),[3,5];case 4:d=this.state.google.visualization.arrayToDataTable([]),a.label=5;case 5:for(b=d.getNumberOfColumns(),v=0;v<b;v+=1)w=this.getColumnID(d,v),this.state.hiddenColumns.includes(w)&&(C=d.getColumnLabel(v),D=d.getColumnId(v),T=d.getColumnType(v),d.removeColumn(v),d.addColumn({label:C,id:D,type:T}));return E=this.chartWrapper.getChart(),"Timeline"===this.chartWrapper.getChartType()&&E&&E.clearChart(),this.chartWrapper.setOptions(s),this.chartWrapper.setDataTable(d),this.chartWrapper.draw(),null!==f&&(this.chartWrapper.setDataTable(f),this.chartWrapper.draw()),null!==c&&(this.applyFormatters(d,c),this.chartWrapper.setDataTable(d),this.chartWrapper.draw()),!0!==l&&!0!==i||this.grayOutHiddenColumns(),[2]}})})},t.applyFormatters=function(e,r){if(null!==t.state.google)for(var o=0,n=r;o<n.length;o++){var a=n[o];switch(a.type){case"ArrowFormat":var s=new t.state.google.visualization.ArrowFormat(a.options);s.format(e,a.column);break;case"BarFormat":var s=new t.state.google.visualization.BarFormat(a.options);s.format(e,a.column);break;case"ColorFormat":for(var s=new t.state.google.visualization.ColorFormat(a.options),i=a.ranges,l=0,p=i;l<p.length;l++){var c=p[l];s.addRange.apply(s,c)}s.format(e,a.column);break;case"DateFormat":var s=new t.state.google.visualization.DateFormat(a.options);s.format(e,a.column);break;case"NumberFormat":var s=new t.state.google.visualization.NumberFormat(a.options);s.format(e,a.column);break;case"PatternFormat":var s=new t.state.google.visualization.PatternFormat(a.options);s.format(e,a.column)}}},t.grayOutHiddenColumns=function(){if(null!==t.chartWrapper&&null!==t.state.google){var e=t.chartWrapper.getDataTable();if(null!==e){var r=e.getNumberOfColumns();if(!1!==t.state.hiddenColumns.length>0){var o=t.props.options,n=Array.from({length:r-1}).map(function(r,n){var a=t.getColumnID(e,n+1);return t.state.hiddenColumns.includes(a)?h:void 0!==o.colors&&null!==o.colors?o.colors[n]:c[n]});t.chartWrapper.setOptions(p({},t.props.options,{colors:n})),t.chartWrapper.draw()}}}},t.onResize=function(){null!==t.chartWrapper&&t.chartWrapper.draw()},t.setChartActions=function(e,r){if(null!==t.chartWrapper){for(var o=t.chartWrapper.getChart(),n=0,a=r;n<a.length;n++){var s=a[n];o.removeAction(s.id)}for(var i=0,l=e;i<l.length;i++){var s=l[i];!function(e){o.setAction({id:e.id,text:e.text,action:function(){return e.action(t.chartWrapper)}})}(s)}}},t.getColumnID=function(e,t){return e.getColumnId(t)||e.getColumnLabel(t)},t.listenToChartEvents=function(){if(null!==t.state.google&&null!==t.chartWrapper){t.state.google.visualization.events.removeAllListeners(t.chartWrapper);var e=t.props,r=e.chartEvents,o=e.legend_toggle,n=e.legendToggle;if(null!==r)for(var a=0,s=r;a<s.length;a++){var i=s[a];!function(e){var r=e.eventName,o=e.callback;t.state.google.visualization.events.addListener(t.chartWrapper,r,function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];null!==t.chartWrapper&&null!==t.state.google&&o({chartWrapper:t.chartWrapper,props:t.props,google:t.state.google,state:t.state,eventArgs:e})})}(i)}!0!==n&&!0!==o||t.listenToLegendToggle()}},t.listenToLegendToggle=function(){null!==t.state.google&&null!==t.chartWrapper&&t.state.google.visualization.events.addListener(t.chartWrapper,"select",function(){if(null!==t.chartWrapper){var e=t.chartWrapper.getChart(),r=e.getSelection(),o=t.chartWrapper.getDataTable();if(0!==r.length&&null===r[0].row&&null!==o){var n=r[0].column,a=t.getColumnID(o,n);t.state.hiddenColumns.includes(a)?t.setState(function(e){return p({},e,{hiddenColumns:e.hiddenColumns.filter(function(e){return e!==a}).slice()})},function(){t.draw()}):t.setState(function(e){return p({},e,{hiddenColumns:e.hiddenColumns.concat([a])})},function(){t.draw()})}}})},t.handleGoogleChartsLoaderScriptLoaded=function(e){var r=t.props,o=r.chartVersion,n=r.chartPackages,a=r.chartLanguage,s=r.mapsApiKey;e.charts.load(o||"current",{packages:n||["corechart"],language:a||"en",mapsApiKey:s}),e.charts.setOnLoadCallback(function(){t.setState(function(t){return p({},t,{loadingStatus:"ready",google:e})})})},t.handleGoogleChartsLoaderScriptErrored=function(){t.setState(function(e){return p({},e,{loadingStatus:"errored"})})},t}return o(t,e),t.prototype.componentDidMount=function(){this.setState({loadingStatus:"loading"}),window.addEventListener("resize",this.onResize)},t.prototype.componentDidUpdate=function(e,t){var r=this.props;if("ready"!==t.loadingStatus&&"ready"===this.state.loadingStatus&&null!==this.state.google){var o={chartType:this.props.chartType,options:this.props.options,containerId:this.getGraphID()};return this.chartWrapper=new this.state.google.visualization.ChartWrapper(o),this.listenToChartEvents(),this.draw(),void r.getChartWrapper(this.chartWrapper,this.state.google)}r.chartEvents!==e.chartEvents&&this.listenToChartEvents(),null===r.chartActions&&null===e.chartActions||r.chartActions!==e.chartActions&&this.setChartActions(r.chartActions,e.chartActions),r.data!==e.data&&this.draw(),r.rows===e.rows&&r.columns===e.columns||this.draw()},t.prototype.componentWillUnmount=function(){null!==this.chartWrapper&&null!==this.state.google&&(window.removeEventListener("resize",this.onResize),this.state.google.visualization.events.removeAllListeners(this.chartWrapper),"Timeline"===this.chartWrapper.getChartType()&&this.chartWrapper.getChart()&&this.chartWrapper.getChart().clearChart())},t.prototype.render=function(){var e=this,t=p({height:this.props.height||this.props.options&&this.props.options.height,width:this.props.width||this.props.options&&this.props.options.width},this.props.style);return Object(s.createElement)("div",p({id:this.getGraphID(),style:t,className:this.props.className},this.props.rootProps),Object(s.createElement)(u,{onError:this.handleGoogleChartsLoaderScriptErrored,onLoad:function(){var t=window;t.google&&e.handleGoogleChartsLoaderScriptLoaded(t.google)}}),"loading"===this.state.loadingStatus&&(this.props.loader?this.props.loader:"Rendering Chart..."))},t.defaultProps=m,t}(s.Component);t.default=y},function(e,t,r){"use strict";function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),l=r(0),p=function(e){return e&&e.__esModule?e:{default:e}}(l),c=r(5),u=function(e){function t(e){n(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.scriptLoaderId="id"+r.constructor.idCount++,r}return s(t,e),i(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.onError,r=e.onLoad,n=e.url;return this.constructor.loadedScripts[n]?void r():this.constructor.erroredScripts[n]?void t():this.constructor.scriptObservers[n]?void(this.constructor.scriptObservers[n][this.scriptLoaderId]=this.props):(this.constructor.scriptObservers[n]=o({},this.scriptLoaderId,this.props),void this.createScript())}},{key:"componentWillUnmount",value:function(){var e=this.props.url,t=this.constructor.scriptObservers[e];t&&delete t[this.scriptLoaderId]}},{key:"createScript",value:function(){var e=this,t=this.props,r=t.onCreate,o=t.url,n=t.attributes,a=document.createElement("script");r(),n&&Object.keys(n).forEach(function(e){return a.setAttribute(e,n[e])}),a.src=o,a.hasAttribute("async")||(a.async=1);var s=function(t){var r=e.constructor.scriptObservers[o];Object.keys(r).forEach(function(n){t(r[n])&&delete e.constructor.scriptObservers[o][e.scriptLoaderId]})};a.onload=function(){e.constructor.loadedScripts[o]=!0,s(function(e){return e.onLoad(),!0})},a.onerror=function(){e.constructor.erroredScripts[o]=!0,s(function(e){return e.onError(),!0})},document.body.appendChild(a)}},{key:"render",value:function(){return null}}]),t}(p.default.Component);u.propTypes={attributes:c.PropTypes.object,onCreate:c.PropTypes.func,onError:c.PropTypes.func.isRequired,onLoad:c.PropTypes.func.isRequired,url:c.PropTypes.string.isRequired},u.defaultProps={attributes:{},onCreate:function(){},onError:function(){},onLoad:function(){}},u.scriptObservers={},u.loadedScripts={},u.erroredScripts={},u.idCount=0,t.default=u,e.exports=t.default},function(e,t,r){e.exports=r(6)()},function(e,t,r){"use strict";var o=r(7),n=r(8),a=r(9);e.exports=function(){function e(e,t,r,o,s,i){i!==a&&n(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return r.checkPropTypes=o,r.PropTypes=r,r}},function(e,t,r){"use strict";function o(e){return function(){return e}}var n=function(){};n.thatReturns=o,n.thatReturnsFalse=o(!1),n.thatReturnsTrue=o(!0),n.thatReturnsNull=o(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},function(e,t,r){"use strict";function o(e,t,r,o,a,s,i,l){if(n(t),!e){var p;if(void 0===t)p=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,o,a,s,i,l],u=0;p=new Error(t.replace(/%s/g,function(){return c[u++]})),p.name="Invariant Violation"}throw p.framesToPop=1,p}}var n=function(e){};e.exports=o},function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vR29vZ2xlQ2hhcnRzLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA0MmQyYjhlMjZiOWUyZDBhOGU3MCIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJSZWFjdFwiIiwid2VicGFjazovLy8uL3NyYy9pbmRleC50c3giLCJ3ZWJwYWNrOi8vLy4vc3JjL0dvb2dsZUNoYXJ0LnRzeCIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcmVhY3QtZ29vZ2xlLWNoYXJ0cy9kaXN0L2luZGV4LmVzbS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcmVhY3QtbG9hZC1zY3JpcHQvbGliL2luZGV4LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9wcm9wLXR5cGVzL2luZGV4LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9wcm9wLXR5cGVzL2ZhY3RvcnlXaXRoVGhyb3dpbmdTaGltcy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvZmJqcy9saWIvZW1wdHlGdW5jdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvZmJqcy9saWIvaW52YXJpYW50LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9wcm9wLXR5cGVzL2xpYi9SZWFjdFByb3BUeXBlc1NlY3JldC5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiUmVhY3QiLCJ2YWx1ZSIsIl9fZXh0ZW5kcyIsInRoaXMiLCJleHRlbmRTdGF0aWNzIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsImIiLCJfXyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwicmVhY3RfZ29vZ2xlX2NoYXJ0c18xIiwiR29vZ2xlQ2hhcnQiLCJfc3VwZXIiLCJwcm9wcyIsIm9uU2VhcmNoQ2hhbmdlZCIsImUiLCJpc0Rlc2lnblRpbWUiLCJtYW55d2hvIiwic3RhdGUiLCJzZXRDb21wb25lbnQiLCJpZCIsInNlYXJjaCIsInRhcmdldCIsImZsb3dLZXkiLCJmb3JjZVVwZGF0ZSIsIm9uU2VhcmNoRW50ZXIiLCJrZXlDb2RlIiwic3RvcFByb3BhZ2F0aW9uIiwibW9kZWwiLCJnZXRDb21wb25lbnQiLCJjbGVhclNlbGVjdGlvbiIsIm9iamVjdERhdGFSZXF1ZXN0IiwiZW5naW5lIiwic2V0dGluZ3MiLCJnbG9iYWwiLCJwYWdlIiwiZGlzcGxheUNvbHVtbnMiLCJjb21wb25lbnQiLCJnZXREaXNwbGF5Q29sdW1ucyIsImNvbHVtbnMiLCJtYXAiLCJjb2x1bW4iLCJ0eXBlRWxlbWVudFByb3BlcnR5SWQiLCJ0b0xvd2VyQ2FzZSIsInNldFN0YXRlIiwib2JqZWN0RGF0YSIsImZpbHRlciIsInByb3BlcnRpZXMiLCJpbmRleE9mIiwiY29udGVudFZhbHVlIiwibGVuZ3RoIiwicmVmcmVzaCIsInNlbGVjdGVkUm93cyIsIm9uUm93Q2xpY2tlZCIsImN1cnJlbnRUYXJnZXQiLCJpc011bHRpU2VsZWN0IiwicHVzaCIsInNwbGljZSIsImdldFNlbGVjdGVkUm93cyIsIm9uT3V0Y29tZSIsIm9iamVjdERhdGFJZCIsIm91dGNvbWVJZCIsIm91dGNvbWUiLCJnZXRPdXRjb21lIiwibW92ZSIsInRoZW4iLCJpc091dCIsImZsb3dPdXQiLCJvbk5leHQiLCJmaWxlRGF0YVJlcXVlc3QiLCJhdHRyaWJ1dGVzIiwicGFnaW5hdGlvbiIsInV0aWxzIiwiaXNFcXVhbCIsIm9uUHJldiIsImdldEluaXRpYWxTdGF0ZSIsInJldCIsIndpbmRvd1dpZHRoIiwid2luZG93IiwiaW5uZXJXaWR0aCIsInNvcnRCeU9yZGVyIiwibGFzdE9yZGVyQnkiLCJjb21wb25lbnRXaWxsTW91bnQiLCJjb21wb25lbnREaWRNb3VudCIsImNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMiLCJuZXh0UHJvcHMiLCJlcnJvciIsImxvYWRpbmciLCJpc051bGxPcldoaXRlc3BhY2UiLCJjb21wb25lbnRXaWxsVW5tb3VudCIsInJlbmRlciIsImxvZyIsImluZm8iLCJvdXRjb21lcyIsImdldE91dGNvbWVzIiwibW9kZWxJdGVtIiwic3RhdGVPYmplY3REYXRhIiwic3RhdGVJdGVtIiwiZXh0ZXJuYWxJZCIsImludGVybmFsSWQiLCJleHRlbmQiLCJoYXNNb3JlUmVzdWx0cyIsImNvbnRlbnQiLCJyb3dPdXRjb21lcyIsImlzQnVsa0FjdGlvbiIsImhlYWRlck91dGNvbWVzIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsIm9uQ2xpY2siLCJyZW5kZXJDaGFydCIsImNsYXNzTmFtZXMiLCJpc1Zpc2libGUiLCJjb25jYXQiLCJzdHlsaW5nIiwiZ2V0Q2xhc3NlcyIsInBhcmVudElkIiwiY2xhc3NlcyIsImpvaW4iLCJpc1ZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjb250ZW50SXRlbXMiLCJyZW5kZXJIZWFkZXIiLCJpc1NlYXJjaGFibGUiLCJyZW5kZXJGb290ZXIiLCJyZW5kZXJXYWl0IiwicGFyc2VCb29sZWFuIiwiY29udmVydFRvR29vZ2xlVHlwZSIsImNvbnRlbnRUeXBlIiwiZ29vZ2xlVHlwZSIsInRvVXBwZXJDYXNlIiwiY29udGVudFR5cGVzIiwibnVtYmVyIiwidW5zaGlmdCIsImFyZUJ1bGtBY3Rpb25zRGVmaW5lZCIsInNlYXJjaFZhbHVlIiwiaXNTZWFyY2hFbmFibGVkIiwib25TZWFyY2hFbnRlcmVkIiwiaXNPYmplY3REYXRhIiwic2VhcmNoRWxlbWVudCIsIm91dGNvbWVzRWxlbWVudCIsInJlZnJlc2hFbGVtZW50IiwibG9va1VwS2V5IiwiZ2V0TG9va1VwS2V5IiwiaGVhZGVyRWxlbWVudHMiLCJtYWluRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJlbmFibGVSZWZyZXNoIiwicmVmcmVzaERpc2FibGVkIiwiZGlzYWJsZWQiLCJzZWFyY2hEaXNhYmxlZCIsInR5cGUiLCJwbGFjZWhvbGRlciIsIm9uQ2hhbmdlIiwib25LZXlVcCIsIm91dGNvbWVFbGVtZW50cyIsImdldEJ5TmFtZSIsImNsaWVudFdpZHRoIiwicGFnZUluZGV4IiwiZm9vdGVyRWxlbWVudHMiLCJjb250YWluZXJDbGFzc2VzIiwiZGF0YSIsImxhYmVsIiwicm93IiwiayIsImoiLCJwYXJzZUZsb2F0IiwiaXNOYU4iLCJjaGFydFR5cGUiLCJvcHRpb25zIiwia2V5IiwiY2hhcnRUeXBlUmVzdWx0IiwiY2hhcnROYW1lVG9UeXBlIiwib0tleSIsImRlZmF1bHQiLCJ3aWR0aCIsImhlaWdodCIsImxlZ2VuZFRvZ2dsZSIsInJlc3VsdCIsInRyZW5kbGluZXMiLCIwIiwid29yZHRyZWUiLCJmb3JtYXQiLCJ3b3JkIiwiQ29tcG9uZW50IiwicmVnaXN0ZXIiLCJfX3dlYnBhY2tfZXhwb3J0c19fIiwiX19hd2FpdGVyIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJzdGVwIiwibmV4dCIsInJlamVjdGVkIiwiZG9uZSIsImFwcGx5IiwiX19nZW5lcmF0b3IiLCJib2R5IiwidmVyYiIsInYiLCJvcCIsImYiLCJUeXBlRXJyb3IiLCJfIiwieSIsInQiLCJvcHMiLCJwb3AiLCJ0cnlzIiwiZyIsInNlbnQiLCJ0aHJvdyIsInJldHVybiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiQ2hhcnQiLCJfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfXyIsIl9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9yZWFjdF9sb2FkX3NjcmlwdF9fIiwiX19hc3NpZ24iLCJhc3NpZ24iLCJhcmd1bWVudHMiLCJERUZBVUxUX0NIQVJUX0NPTE9SUyIsIlJlYWN0R29vZ2xlQ2hhcnRzTG9hZGVyIiwiX3RoaXMiLCJkb2N1bWVudFNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImxvYWRTY3JpcHQiLCJzcmMiLCJpbmNsdWRlcyIsIm9uTG9hZCIsIl9hIiwib25FcnJvciIsInVybCIsIkdSQVlfQ09MT1IiLCJ1bmlxdWVJRCIsImdlbmVyYXRlVW5pcXVlSUQiLCJjaGFydERlZmF1bHRQcm9wcyIsImdyYXBoX2lkIiwibGVnZW5kX3RvZ2dsZSIsImdyYXBoSUQiLCJjb2xvcnMiLCJyb3dzIiwiZGlmZmRhdGEiLCJjaGFydEV2ZW50cyIsImNoYXJ0QWN0aW9ucyIsImdldENoYXJ0V3JhcHBlciIsImNoYXJ0V3JhcHBlciIsImdvb2dsZSIsInN0eWxlIiwiZm9ybWF0dGVycyIsInNwcmVhZFNoZWV0VXJsIiwic3ByZWFkU2hlZXRRdWVyeVBhcmFtZXRlcnMiLCJoZWFkZXJzIiwiZ2lkIiwicm9vdFByb3BzIiwibG9hZERhdGFUYWJsZUZyb21TcHJlYWRTaGVldCIsImdvb2dsZVZpeiIsInVybFBhcmFtcyIsInVuZGVmaW5lZCIsInF1ZXJ5U3RyaW5nIiwicXVlcnkiLCJlbmNvZGVVUklDb21wb25lbnQiLCJzaGVldCIsInVybFF1ZXJ5U3RyaW5nIiwidXJsVG9TcHJlYWRTaGVldCIsInZpc3VhbGl6YXRpb24iLCJRdWVyeSIsInNlbmQiLCJyZXNwb25zZSIsImlzRXJyb3IiLCJnZXRNZXNzYWdlIiwiZ2V0RGV0YWlsZWRNZXNzYWdlIiwiZ2V0RGF0YVRhYmxlIiwibG9hZGluZ1N0YXR1cyIsImhpZGRlbkNvbHVtbnMiLCJnZXRHcmFwaElEIiwiaW5zdGFuY2VHcmFwaElEIiwiZHJhdyIsImRhdGFUYWJsZSIsImNoYXJ0RGlmZiIsIm9sZERhdGEiLCJuZXdEYXRhIiwiY29sdW1uQ291bnQiLCJjb2x1bW5JRCIsInByZXZpb3VzQ29sdW1uTGFiZWwiLCJwcmV2aW91c0NvbHVtbklEIiwicHJldmlvdXNDb2x1bW5UeXBlIiwiY2hhcnQiLCJfYiIsImFycmF5VG9EYXRhVGFibGUiLCJvbGQiLCJuZXciLCJjb21wdXRlRGlmZiIsImlzQXJyYXkiLCJEYXRhVGFibGUiLCJnZXROdW1iZXJPZkNvbHVtbnMiLCJnZXRDb2x1bW5JRCIsImdldENvbHVtbkxhYmVsIiwiZ2V0Q29sdW1uSWQiLCJnZXRDb2x1bW5UeXBlIiwicmVtb3ZlQ29sdW1uIiwiYWRkQ29sdW1uIiwiZ2V0Q2hhcnQiLCJnZXRDaGFydFR5cGUiLCJjbGVhckNoYXJ0Iiwic2V0T3B0aW9ucyIsInNldERhdGFUYWJsZSIsImFwcGx5Rm9ybWF0dGVycyIsImdyYXlPdXRIaWRkZW5Db2x1bW5zIiwiX2kiLCJmb3JtYXR0ZXJzXzEiLCJmb3JtYXR0ZXIiLCJ2aXpGb3JtYXR0ZXIiLCJBcnJvd0Zvcm1hdCIsIkJhckZvcm1hdCIsIkNvbG9yRm9ybWF0IiwicmFuZ2VzIiwicmFuZ2VzXzEiLCJyYW5nZSIsImFkZFJhbmdlIiwiRGF0ZUZvcm1hdCIsIk51bWJlckZvcm1hdCIsIlBhdHRlcm5Gb3JtYXQiLCJmcm9tIiwiZG9udGNhcmUiLCJvblJlc2l6ZSIsInNldENoYXJ0QWN0aW9ucyIsImN1cnJlbnRBY3Rpb25zIiwicHJldmlvdXNBY3Rpb25zIiwicHJldmlvdXNBY3Rpb25zXzEiLCJjaGFydEFjdGlvbiIsInJlbW92ZUFjdGlvbiIsImN1cnJlbnRBY3Rpb25zXzEiLCJzZXRBY3Rpb24iLCJ0ZXh0IiwiYWN0aW9uIiwiY29sdW1uSW5kZXgiLCJsaXN0ZW5Ub0NoYXJ0RXZlbnRzIiwiZXZlbnRzIiwicmVtb3ZlQWxsTGlzdGVuZXJzIiwiY2hhcnRFdmVudHNfMSIsImV2ZW50XzEiLCJldmVudE5hbWUiLCJjYWxsYmFjayIsImFkZExpc3RlbmVyIiwiYXJncyIsImV2ZW50QXJncyIsImxpc3RlblRvTGVnZW5kVG9nZ2xlIiwic2VsZWN0aW9uIiwiZ2V0U2VsZWN0aW9uIiwiY29sSUQiLCJzbGljZSIsImhhbmRsZUdvb2dsZUNoYXJ0c0xvYWRlclNjcmlwdExvYWRlZCIsIndpbmRvd0dvb2dsZUNoYXJ0cyIsInZlcnNpb24iLCJjaGFydFZlcnNpb24iLCJwYWNrYWdlcyIsImNoYXJ0UGFja2FnZXMiLCJsYW5ndWFnZSIsImNoYXJ0TGFuZ3VhZ2UiLCJtYXBzQXBpS2V5IiwiY2hhcnRzIiwibG9hZCIsInNldE9uTG9hZENhbGxiYWNrIiwiaGFuZGxlR29vZ2xlQ2hhcnRzTG9hZGVyU2NyaXB0RXJyb3JlZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjb21wb25lbnREaWRVcGRhdGUiLCJwcmV2UHJvcHMiLCJwcmV2U3RhdGUiLCJjaGFydENvbmZpZyIsImNvbnRhaW5lcklkIiwiQ2hhcnRXcmFwcGVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImRpdlN0eWxlIiwid2luZG93V2l0aEdvb2dsZSIsImxvYWRlciIsImRlZmF1bHRQcm9wcyIsIl9kZWZpbmVQcm9wZXJ0eSIsIm9iaiIsIndyaXRhYmxlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsImRlc2NyaXB0b3IiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfcmVhY3QiLCJfcmVhY3QyIiwiX3Byb3BUeXBlcyIsIlNjcmlwdCIsIl9SZWFjdCRDb21wb25lbnQiLCJnZXRQcm90b3R5cGVPZiIsInNjcmlwdExvYWRlcklkIiwiaWRDb3VudCIsIl9wcm9wcyIsImxvYWRlZFNjcmlwdHMiLCJlcnJvcmVkU2NyaXB0cyIsInNjcmlwdE9ic2VydmVycyIsImNyZWF0ZVNjcmlwdCIsIm9ic2VydmVycyIsIl90aGlzMiIsIl9wcm9wczIiLCJvbkNyZWF0ZSIsInNjcmlwdCIsImtleXMiLCJmb3JFYWNoIiwicHJvcCIsInNldEF0dHJpYnV0ZSIsImhhc0F0dHJpYnV0ZSIsImFzeW5jIiwiY2FsbE9ic2VydmVyRnVuY0FuZFJlbW92ZU9ic2VydmVyIiwic2hvdWxkUmVtb3ZlT2JzZXJ2ZXIiLCJvbmxvYWQiLCJvYnNlcnZlciIsIm9uZXJyb3IiLCJhcHBlbmRDaGlsZCIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsImZ1bmMiLCJpc1JlcXVpcmVkIiwic3RyaW5nIiwiZW1wdHlGdW5jdGlvbiIsImludmFyaWFudCIsIlJlYWN0UHJvcFR5cGVzU2VjcmV0Iiwic2hpbSIsInByb3BOYW1lIiwiY29tcG9uZW50TmFtZSIsImxvY2F0aW9uIiwicHJvcEZ1bGxOYW1lIiwic2VjcmV0IiwiZ2V0U2hpbSIsIlJlYWN0UHJvcFR5cGVzIiwiYXJyYXkiLCJib29sIiwic3ltYm9sIiwiYW55IiwiYXJyYXlPZiIsImVsZW1lbnQiLCJpbnN0YW5jZU9mIiwibm9kZSIsIm9iamVjdE9mIiwib25lT2YiLCJvbmVPZlR5cGUiLCJzaGFwZSIsImV4YWN0IiwiY2hlY2tQcm9wVHlwZXMiLCJtYWtlRW1wdHlGdW5jdGlvbiIsImFyZyIsInRoYXRSZXR1cm5zIiwidGhhdFJldHVybnNGYWxzZSIsInRoYXRSZXR1cm5zVHJ1ZSIsInRoYXRSZXR1cm5zTnVsbCIsInRoYXRSZXR1cm5zVGhpcyIsInRoYXRSZXR1cm5zQXJndW1lbnQiLCJjb25kaXRpb24iLCJhIiwidmFsaWRhdGVGb3JtYXQiLCJFcnJvciIsImFyZ0luZGV4IiwicmVwbGFjZSIsImZyYW1lc1RvUG9wIl0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBSSxFQUFBSixFQUNBSyxHQUFBLEVBQ0FILFdBVUEsT0FOQUosR0FBQUUsR0FBQU0sS0FBQUgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUgsR0FHQUksRUFBQUUs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TUEsT0FIQUMsR0FBQWMsZUFBQXhCLEVBQ0FVLEVBQUFkLFVBQUFjLEVBRUFBLElSNHpDTSxTQUFVcmQsRUFBUUQsRUFBU0gsR0FFakMsWVMzMkNBLFNBQUF3ZSxHQUFBQyxHQUNBLGtCQUNBLE1BQUFBLElBU0EsR0FBQTFCLEdBQUEsWUFFQUEsR0FBQTJCLFlBQUFGLEVBQ0F6QixFQUFBNEIsaUJBQUFILEdBQUEsR0FDQXpCLEVBQUE2QixnQkFBQUosR0FBQSxHQUNBekIsRUFBQThCLGdCQUFBTCxFQUFBLE1BQ0F6QixFQUFBK0IsZ0JBQUEsV0FDQSxNQUFBaGQsT0FFQWliLEVBQUFnQyxvQkFBQSxTQUFBTixHQUNBLE1BQUFBLElBR0FyZSxFQUFBRCxRQUFBNGMsR1QyM0NNLFNBQVUzYyxFQUFRRCxFQUFTSCxHQUVqQyxZVWo0Q0EsU0FBQWdkLEdBQUFnQyxFQUFBN1IsRUFBQThSLEVBQUE5YyxFQUFBMUIsRUFBQUMsRUFBQWtDLEVBQUErTCxHQUdBLEdBRkF1USxFQUFBL1IsSUFFQTZSLEVBQUEsQ0FDQSxHQUFBN1gsRUFDQSxRQUFBaUwsS0FBQWpGLEVBQ0FoRyxFQUFBLEdBQUFnWSxPQUFBLHFJQUNLLENBQ0wsR0FBQXhILElBQUFzSCxFQUFBOWMsRUFBQTFCLEVBQUFDLEVBQUFrQyxFQUFBK0wsR0FDQXlRLEVBQUEsQ0FDQWpZLEdBQUEsR0FBQWdZLE9BQUFoUyxFQUFBa1MsUUFBQSxpQkFDQSxNQUFBMUgsR0FBQXlILFFBRUFqWSxFQUFBeEcsS0FBQSxzQkFJQSxLQURBd0csR0FBQW1ZLFlBQUEsRUFDQW5ZLEdBM0JBLEdBQUErWCxHQUFBLFNBQUEvUixJQStCQS9NLEdBQUFELFFBQUE2YyxHVnE2Q00sU0FBVTVjLEVBQVFELEVBQVNILEdBRWpDLFlXaDlDQUksR0FBQUQsUUFGQSIsImZpbGUiOiJHb29nbGVDaGFydHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGk6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bDogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuLyoqKioqKi8gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbi8qKioqKiovIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4vKioqKioqLyBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4vKioqKioqLyBcdFx0XHRcdGdldDogZ2V0dGVyXG4vKioqKioqLyBcdFx0XHR9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbi8qKioqKiovIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuLyoqKioqKi8gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbi8qKioqKiovIFx0XHRyZXR1cm4gZ2V0dGVyO1xuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3Q7XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxyXG5mdW5jdGlvbiBfX2V4cG9ydChtKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5fX2V4cG9ydChfX3dlYnBhY2tfcmVxdWlyZV9fKDIpKTtcclxuXG5cbi8qKiovIH0pLFxuLyogMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxyXG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4vL2RlY2xhcmUgdmFyIGdvb2dsZTphbnk7XHJcbnZhciBSZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XHJcbnZhciByZWFjdF9nb29nbGVfY2hhcnRzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xyXG52YXIgR29vZ2xlQ2hhcnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoR29vZ2xlQ2hhcnQsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBHb29nbGVDaGFydChwcm9wcykge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIEdvb2dsZUNoYXJ0LnByb3RvdHlwZS5vblNlYXJjaENoYW5nZWQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmlzRGVzaWduVGltZSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIG1hbnl3aG8uc3RhdGUuc2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHsgc2VhcmNoOiBlLnRhcmdldC52YWx1ZSB9LCB0aGlzLnByb3BzLmZsb3dLZXksIHRydWUpO1xyXG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgIH07XHJcbiAgICBHb29nbGVDaGFydC5wcm90b3R5cGUub25TZWFyY2hFbnRlciA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAxMyAmJiAhdGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUpIHtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2goKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLnNlYXJjaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB2YXIgbW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgIHZhciBzdGF0ZSA9IG1hbnl3aG8uc3RhdGUuZ2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHRoaXMucHJvcHMuZmxvd0tleSk7XHJcbiAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xyXG4gICAgICAgIGlmIChtb2RlbC5vYmplY3REYXRhUmVxdWVzdCkge1xyXG4gICAgICAgICAgICBtYW55d2hvLmVuZ2luZS5vYmplY3REYXRhUmVxdWVzdCh0aGlzLnByb3BzLmlkLCBtb2RlbC5vYmplY3REYXRhUmVxdWVzdCwgdGhpcy5wcm9wcy5mbG93S2V5LCBtYW55d2hvLnNldHRpbmdzLmdsb2JhbCgncGFnaW5nLnRhYmxlJyksIHN0YXRlLnNlYXJjaCwgbnVsbCwgbnVsbCwgc3RhdGUucGFnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgZGlzcGxheUNvbHVtbnMgPSAobWFueXdoby5jb21wb25lbnQuZ2V0RGlzcGxheUNvbHVtbnMobW9kZWwuY29sdW1ucykgfHwgW10pLm1hcChmdW5jdGlvbiAoY29sdW1uKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29sdW1uLnR5cGVFbGVtZW50UHJvcGVydHlJZC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICBvYmplY3REYXRhOiBtb2RlbC5vYmplY3REYXRhLmZpbHRlcihmdW5jdGlvbiAob2JqZWN0RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmplY3REYXRhLnByb3BlcnRpZXMuZmlsdGVyKGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGlzcGxheUNvbHVtbnMuaW5kZXhPZihwcm9wZXJ0eS50eXBlRWxlbWVudFByb3BlcnR5SWQpICE9IC0xICYmIHByb3BlcnR5LmNvbnRlbnRWYWx1ZS50b0xvd2VyQ2FzZSgpLmluZGV4T2Yoc3RhdGUuc2VhcmNoLnRvTG93ZXJDYXNlKCkpICE9IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgc3RhdGUucGFnZSA9IDE7XHJcbiAgICAgICAgICAgIG1hbnl3aG8uc3RhdGUuc2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHN0YXRlLCB0aGlzLnByb3BzLmZsb3dLZXksIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBHb29nbGVDaGFydC5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICBtYW55d2hvLnN0YXRlLnNldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB7IHNlYXJjaDogJycgfSwgdGhpcy5wcm9wcy5mbG93S2V5LCB0cnVlKTtcclxuICAgICAgICB0aGlzLnNlYXJjaCgpO1xyXG4gICAgfTtcclxuICAgIEdvb2dsZUNoYXJ0LnByb3RvdHlwZS5jbGVhclNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2VsZWN0ZWRSb3dzOiBbXSB9KTtcclxuICAgICAgICBtYW55d2hvLnN0YXRlLnNldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB7IG9iamVjdERhdGE6IFtdIH0sIHRoaXMucHJvcHMuZmxvd0tleSwgdHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLm9uUm93Q2xpY2tlZCA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgdmFyIHNlbGVjdGVkUm93cyA9IHRoaXMuc3RhdGUuc2VsZWN0ZWRSb3dzO1xyXG4gICAgICAgIHZhciBtb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHRoaXMucHJvcHMuZmxvd0tleSk7XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkUm93cy5pbmRleE9mKGUuY3VycmVudFRhcmdldC5pZCkgPT0gLTEpIHtcclxuICAgICAgICAgICAgbW9kZWwuaXNNdWx0aVNlbGVjdCA/IHNlbGVjdGVkUm93cy5wdXNoKGUuY3VycmVudFRhcmdldC5pZCkgOiBzZWxlY3RlZFJvd3MgPSBbZS5jdXJyZW50VGFyZ2V0LmlkXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkUm93cy5zcGxpY2Uoc2VsZWN0ZWRSb3dzLmluZGV4T2YoZS5jdXJyZW50VGFyZ2V0LmlkKSwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzZWxlY3RlZFJvd3M6IHNlbGVjdGVkUm93cyB9KTtcclxuICAgICAgICBtYW55d2hvLnN0YXRlLnNldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB7IG9iamVjdERhdGE6IG1hbnl3aG8uY29tcG9uZW50LmdldFNlbGVjdGVkUm93cyhtb2RlbCwgc2VsZWN0ZWRSb3dzKSB9LCB0aGlzLnByb3BzLmZsb3dLZXksIHRydWUpO1xyXG4gICAgfTtcclxuICAgIEdvb2dsZUNoYXJ0LnByb3RvdHlwZS5vbk91dGNvbWUgPSBmdW5jdGlvbiAob2JqZWN0RGF0YUlkLCBvdXRjb21lSWQpIHtcclxuICAgICAgICB2YXIgbW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgIG1hbnl3aG8uc3RhdGUuc2V0Q29tcG9uZW50KG1vZGVsLmlkLCB7IG9iamVjdERhdGE6IG1hbnl3aG8uY29tcG9uZW50LmdldFNlbGVjdGVkUm93cyhtb2RlbCwgW29iamVjdERhdGFJZF0pIH0sIHRoaXMucHJvcHMuZmxvd0tleSwgdHJ1ZSk7XHJcbiAgICAgICAgdmFyIGZsb3dLZXkgPSB0aGlzLnByb3BzLmZsb3dLZXk7XHJcbiAgICAgICAgdmFyIG91dGNvbWUgPSBtYW55d2hvLm1vZGVsLmdldE91dGNvbWUob3V0Y29tZUlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgIG1hbnl3aG8uZW5naW5lLm1vdmUob3V0Y29tZSwgdGhpcy5wcm9wcy5mbG93S2V5KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvdXRjb21lLmlzT3V0KSB7XHJcbiAgICAgICAgICAgICAgICBtYW55d2hvLmVuZ2luZS5mbG93T3V0KG91dGNvbWUsIGZsb3dLZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgIHZhciBzdGF0ZSA9IG1hbnl3aG8uc3RhdGUuZ2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHRoaXMucHJvcHMuZmxvd0tleSk7XHJcbiAgICAgICAgaWYgKCFzdGF0ZS5wYWdlKSB7XHJcbiAgICAgICAgICAgIHN0YXRlLnBhZ2UgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdGF0ZS5wYWdlKys7XHJcbiAgICAgICAgbWFueXdoby5zdGF0ZS5zZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgc3RhdGUsIHRoaXMucHJvcHMuZmxvd0tleSwgdHJ1ZSk7XHJcbiAgICAgICAgaWYgKG1vZGVsLm9iamVjdERhdGFSZXF1ZXN0IHx8IG1vZGVsLmZpbGVEYXRhUmVxdWVzdClcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2goKTtcclxuICAgICAgICBlbHNlIGlmIChtb2RlbC5hdHRyaWJ1dGVzLnBhZ2luYXRpb24gJiYgbWFueXdoby51dGlscy5pc0VxdWFsKG1vZGVsLmF0dHJpYnV0ZXMucGFnaW5hdGlvbiwgJ3RydWUnLCB0cnVlKSkge1xyXG4gICAgICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEdvb2dsZUNoYXJ0LnByb3RvdHlwZS5vblByZXYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG1vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICB2YXIgc3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgIHN0YXRlLnBhZ2UtLTtcclxuICAgICAgICBtYW55d2hvLnN0YXRlLnNldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCBzdGF0ZSwgdGhpcy5wcm9wcy5mbG93S2V5LCB0cnVlKTtcclxuICAgICAgICBpZiAobW9kZWwub2JqZWN0RGF0YVJlcXVlc3QgfHwgbW9kZWwuZmlsZURhdGFSZXF1ZXN0KVxyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaCgpO1xyXG4gICAgICAgIGVsc2UgaWYgKG1vZGVsLmF0dHJpYnV0ZXMucGFnaW5hdGlvbiAmJiBtYW55d2hvLnV0aWxzLmlzRXF1YWwobW9kZWwuYXR0cmlidXRlcy5wYWdpbmF0aW9uLCAndHJ1ZScsIHRydWUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLmdldEluaXRpYWxTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcmV0ID0ge307XHJcbiAgICAgICAgcmV0LnNlbGVjdGVkUm93cyA9IFtdO1xyXG4gICAgICAgIHJldC53aW5kb3dXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoLFxyXG4gICAgICAgICAgICByZXQuc29ydEJ5T3JkZXIgPSAnQVNDJyxcclxuICAgICAgICAgICAgcmV0Lmxhc3RPcmRlckJ5ID0gJycsXHJcbiAgICAgICAgICAgIHJldC5vYmplY3REYXRhID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfTtcclxuICAgIEdvb2dsZUNoYXJ0LnByb3RvdHlwZS5jb21wb25lbnRXaWxsTW91bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG1vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICBpZiAoIW1vZGVsLm9iamVjdERhdGFSZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBvYmplY3REYXRhOiBtb2RlbC5vYmplY3REYXRhIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBHb29nbGVDaGFydC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLmNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgPSBmdW5jdGlvbiAobmV4dFByb3BzKSB7XHJcbiAgICAgICAgdmFyIG1vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQobmV4dFByb3BzLmlkLCBuZXh0UHJvcHMuZmxvd0tleSk7XHJcbiAgICAgICAgdmFyIHN0YXRlID0gdGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUgPyB7IGVycm9yOiBudWxsLCBsb2FkaW5nOiBmYWxzZSB9IDogbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KSB8fCB7fTtcclxuICAgICAgICBpZiAoIW1vZGVsLm9iamVjdERhdGFSZXF1ZXN0ICYmICFtb2RlbC5maWxlRGF0YVJlcXVlc3QgJiYgbWFueXdoby51dGlscy5pc051bGxPcldoaXRlc3BhY2Uoc3RhdGUuc2VhcmNoKSAmJiAobWFueXdoby51dGlscy5pc051bGxPcldoaXRlc3BhY2Uoc3RhdGUucGFnZSkgfHwgc3RhdGUucGFnZSA9PSAxKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgb2JqZWN0RGF0YTogbW9kZWwub2JqZWN0RGF0YSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgfTtcclxuICAgIEdvb2dsZUNoYXJ0LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbWFueXdoby5sb2cuaW5mbygnUmVuZGVyaW5nIEdvb2dsZSBDaGFydDogJyArIHRoaXMucHJvcHMuaWQpO1xyXG4gICAgICAgIHZhciBtb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHRoaXMucHJvcHMuZmxvd0tleSk7XHJcbiAgICAgICAgdmFyIHN0YXRlID0gdGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUgPyB7IGVycm9yOiBudWxsLCBsb2FkaW5nOiBmYWxzZSB9IDogbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KSB8fCB7fTtcclxuICAgICAgICB0aGlzLm91dGNvbWVzID0gbWFueXdoby5tb2RlbC5nZXRPdXRjb21lcyh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgIHZhciBvYmplY3REYXRhID0gdGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUgPyBbXSA6IG1vZGVsLm9iamVjdERhdGE7XHJcbiAgICAgICAgaWYgKG1vZGVsLm9iamVjdERhdGEgJiYgc3RhdGUub2JqZWN0RGF0YSAmJiAhdGhpcy5zdGF0ZS5vYmplY3REYXRhKSB7XHJcbiAgICAgICAgICAgIG9iamVjdERhdGEgPSBtb2RlbC5vYmplY3REYXRhLm1hcChmdW5jdGlvbiAobW9kZWxJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGVPYmplY3REYXRhID0gc3RhdGUub2JqZWN0RGF0YS5maWx0ZXIoZnVuY3Rpb24gKHN0YXRlSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYW55d2hvLnV0aWxzLmlzRXF1YWwobW9kZWxJdGVtLmV4dGVybmFsSWQsIHN0YXRlSXRlbS5leHRlcm5hbElkKSAmJiBtYW55d2hvLnV0aWxzLmlzRXF1YWwobW9kZWxJdGVtLmludGVybmFsSWQsIHN0YXRlSXRlbS5pbnRlcm5hbElkKTtcclxuICAgICAgICAgICAgICAgIH0pWzBdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlT2JqZWN0RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYW55d2hvLnV0aWxzLmV4dGVuZCh7fSwgW21vZGVsSXRlbSwgc3RhdGVPYmplY3REYXRhXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW9kZWxJdGVtO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRpc3BsYXlDb2x1bW5zID0gKHRoaXMucHJvcHMuaXNEZXNpZ25UaW1lKSA/IFtdIDogdGhpcy5nZXREaXNwbGF5Q29sdW1ucyhtb2RlbC5jb2x1bW5zLCB0aGlzLm91dGNvbWVzKTtcclxuICAgICAgICB2YXIgaGFzTW9yZVJlc3VsdHMgPSAobW9kZWwub2JqZWN0RGF0YVJlcXVlc3QgJiYgbW9kZWwub2JqZWN0RGF0YVJlcXVlc3QuaGFzTW9yZVJlc3VsdHMpIHx8IChtb2RlbC5maWxlRGF0YVJlcXVlc3QgJiYgbW9kZWwuZmlsZURhdGFSZXF1ZXN0Lmhhc01vcmVSZXN1bHRzKTtcclxuICAgICAgICB2YXIgY29udGVudCA9IG51bGw7XHJcbiAgICAgICAgdmFyIHJvd091dGNvbWVzID0gdGhpcy5vdXRjb21lcy5maWx0ZXIoZnVuY3Rpb24gKG91dGNvbWUpIHsgcmV0dXJuICFvdXRjb21lLmlzQnVsa0FjdGlvbjsgfSk7XHJcbiAgICAgICAgdmFyIGhlYWRlck91dGNvbWVzID0gdGhpcy5vdXRjb21lcy5maWx0ZXIoZnVuY3Rpb24gKG91dGNvbWUpIHsgcmV0dXJuIG91dGNvbWUuaXNCdWxrQWN0aW9uOyB9KTtcclxuICAgICAgICBpZiAoc3RhdGUub2JqZWN0RGF0YSkge1xyXG4gICAgICAgICAgICBvYmplY3REYXRhID0gc3RhdGUub2JqZWN0RGF0YTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHN0YXRlLmVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQgPSBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAndGFibGUtZXJyb3InIH0sXHJcbiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwicFwiLCB7IGNsYXNzTmFtZTogJ2xlYWQnIH0sIFwic3RhdGUuZXJyb3IubWVzc2FnZVwiKSxcclxuICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgeyBjbGFzc05hbWU6ICdidG4gYnRuLWRhbmdlcicsIG9uQ2xpY2s6IHRoaXMuc2VhcmNoIH0sIFwiUmV0cnlcIikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkaXNwbGF5Q29sdW1ucy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICBjb250ZW50ID0gUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogJ3RhYmxlLWVycm9yJyB9LFxyXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcInBcIiwgeyBjbGFzc05hbWU6ICdsZWFkJyB9LCBcIidObyBkaXNwbGF5IGNvbHVtbnMgaGF2ZSBiZWVuIGRlZmluZWQgZm9yIHRoaXMgdGFibGUnXCIpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQgPSB0aGlzLnJlbmRlckNoYXJ0KG9iamVjdERhdGEgfHwgW10sIHJvd091dGNvbWVzLCBkaXNwbGF5Q29sdW1ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjbGFzc05hbWVzID0gW107XHJcbiAgICAgICAgaWYgKG1vZGVsLmlzVmlzaWJsZSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBjbGFzc05hbWVzLnB1c2goJ2hpZGRlbicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY2xhc3NOYW1lcyA9IGNsYXNzTmFtZXMuY29uY2F0KG1hbnl3aG8uc3R5bGluZy5nZXRDbGFzc2VzKHRoaXMucHJvcHMucGFyZW50SWQsIHRoaXMucHJvcHMuaWQsIFwiZ29vZ2xlLWNoYXJ0XCIsIHRoaXMucHJvcHMuZmxvd0tleSkpO1xyXG4gICAgICAgICAgICBpZiAobW9kZWwuYXR0cmlidXRlcyAmJiBtb2RlbC5hdHRyaWJ1dGVzLmNsYXNzZXMpIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZXMgPSBjbGFzc05hbWVzLmpvaW4oJyAnKSArICcgJyArIG1vZGVsLmF0dHJpYnV0ZXMuY2xhc3NlcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZXMgPSBjbGFzc05hbWVzLmpvaW4oJyAnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdmFsaWRhdGlvbkVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbW9kZWwuaXNWYWxpZCAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kZWwuaXNWYWxpZCA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgdmFsaWRhdGlvbkVsZW1lbnQgPSBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAnaGFzLWVycm9yJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiAnaGVscC1ibG9jaycgfSwgbW9kZWwudmFsaWRhdGlvbk1lc3NhZ2UpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobW9kZWwuaXNWaXNpYmxlID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWVzICs9ICcgaGlkZGVuJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgY29udGVudEl0ZW1zID0gW107XHJcbiAgICAgICAgICAgIGNvbnRlbnRJdGVtcy5wdXNoKHRoaXMucmVuZGVySGVhZGVyKHN0YXRlLnNlYXJjaCwgaGVhZGVyT3V0Y29tZXMsIHRoaXMucHJvcHMuZmxvd0tleSwgbW9kZWwuaXNTZWFyY2hhYmxlLCB0aGlzLm9uU2VhcmNoQ2hhbmdlZCwgdGhpcy5vblNlYXJjaEVudGVyLCB0aGlzLnNlYXJjaCwgKG1vZGVsLm9iamVjdERhdGFSZXF1ZXN0IHx8IG1vZGVsLmZpbGVEYXRhUmVxdWVzdCksIHRoaXMucmVmcmVzaCwgdGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUsIG1vZGVsKSk7XHJcbiAgICAgICAgICAgIGNvbnRlbnRJdGVtcy5wdXNoKGNvbnRlbnQpO1xyXG4gICAgICAgICAgICBjb250ZW50SXRlbXMucHVzaCh0aGlzLnJlbmRlckZvb3RlcihzdGF0ZS5wYWdlIHx8IDEsIGhhc01vcmVSZXN1bHRzLCB0aGlzLm9uTmV4dCwgdGhpcy5vblByZXYsIHRoaXMucHJvcHMuaXNEZXNpZ25UaW1lKSk7XHJcbiAgICAgICAgICAgIGNvbnRlbnRJdGVtcy5wdXNoKHRoaXMucmVuZGVyV2FpdCgpKTtcclxuICAgICAgICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IGNsYXNzTmFtZXMgfSxcclxuICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6ICdwYW5lbCBwYW5lbC1kZWZhdWx0JyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6ICdwYW5lbC1oZWFkaW5nJyB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAncGFuZWwtYm9keScgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgbnVsbCwgY29udGVudEl0ZW1zKSkpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEdvb2dsZUNoYXJ0LnByb3RvdHlwZS5wYXJzZUJvb2xlYW4gPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUgPT0gdHJ1ZSB8fCB2YWx1ZSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWx1ZSAhPSBudWxsICYmXHJcbiAgICAgICAgICAgIHZhbHVlLnRvTG93ZXJDYXNlKCkgPT0gJ3RydWUnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLmNvbnZlcnRUb0dvb2dsZVR5cGUgPSBmdW5jdGlvbiAoY29udGVudFR5cGUpIHtcclxuICAgICAgICB2YXIgZ29vZ2xlVHlwZSA9ICdzdHJpbmcnO1xyXG4gICAgICAgIGlmIChjb250ZW50VHlwZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlID0gY29udGVudFR5cGUudG9VcHBlckNhc2UoKTtcclxuICAgICAgICAgICAgaWYgKGNvbnRlbnRUeXBlID09IG1hbnl3aG8uY29tcG9uZW50LmNvbnRlbnRUeXBlcy5udW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIGdvb2dsZVR5cGUgPSAnbnVtYmVyJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZ29vZ2xlVHlwZTtcclxuICAgIH07XHJcbiAgICBHb29nbGVDaGFydC5wcm90b3R5cGUuZ2V0RGlzcGxheUNvbHVtbnMgPSBmdW5jdGlvbiAoY29sdW1ucywgb3V0Y29tZXMpIHtcclxuICAgICAgICB2YXIgZGlzcGxheUNvbHVtbnMgPSBtYW55d2hvLmNvbXBvbmVudC5nZXREaXNwbGF5Q29sdW1ucyhjb2x1bW5zKSB8fCBbXTtcclxuICAgICAgICBpZiAob3V0Y29tZXMuZmlsdGVyKGZ1bmN0aW9uIChvdXRjb21lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhb3V0Y29tZS5pc0J1bGtBY3Rpb247XHJcbiAgICAgICAgfSkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBkaXNwbGF5Q29sdW1ucy51bnNoaWZ0KCdtdy1vdXRjb21lcycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGlzcGxheUNvbHVtbnM7XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLmFyZUJ1bGtBY3Rpb25zRGVmaW5lZCA9IGZ1bmN0aW9uIChvdXRjb21lcykge1xyXG4gICAgICAgIHJldHVybiBvdXRjb21lcy5maWx0ZXIoZnVuY3Rpb24gKG91dGNvbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG91dGNvbWUuaXNCdWxrQWN0aW9uO1xyXG4gICAgICAgIH0pLmxlbmd0aCAhPSAwO1xyXG4gICAgfTtcclxuICAgIEdvb2dsZUNoYXJ0LnByb3RvdHlwZS5yZW5kZXJIZWFkZXIgPSBmdW5jdGlvbiAoc2VhcmNoVmFsdWUsIG91dGNvbWVzLCBmbG93S2V5LCBpc1NlYXJjaEVuYWJsZWQsIG9uU2VhcmNoQ2hhbmdlZCwgb25TZWFyY2hFbnRlcmVkLCBzZWFyY2gsIGlzT2JqZWN0RGF0YSwgcmVmcmVzaCwgaXNEZXNpZ25UaW1lLCBtb2RlbCkge1xyXG4gICAgICAgIHZhciBsb29rVXBLZXkgPSBtYW55d2hvLnV0aWxzLmdldExvb2tVcEtleShmbG93S2V5KTtcclxuICAgICAgICB2YXIgaGVhZGVyRWxlbWVudHMgPSBbXTtcclxuICAgICAgICB2YXIgc2VhcmNoRWxlbWVudDtcclxuICAgICAgICB2YXIgb3V0Y29tZXNFbGVtZW50O1xyXG4gICAgICAgIHZhciByZWZyZXNoRWxlbWVudDtcclxuICAgICAgICB2YXIgbWFpbkVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsb29rVXBLZXkpO1xyXG4gICAgICAgIGlmICgoaXNPYmplY3REYXRhICYmXHJcbiAgICAgICAgICAgIG1vZGVsLmF0dHJpYnV0ZXMgIT0gbnVsbCAmJlxyXG4gICAgICAgICAgICB0aGlzLnBhcnNlQm9vbGVhbihtb2RlbC5hdHRyaWJ1dGVzLmVuYWJsZVJlZnJlc2gpID09IHRydWUpIHx8XHJcbiAgICAgICAgICAgIChpc09iamVjdERhdGEgJiZcclxuICAgICAgICAgICAgICAgIG1vZGVsLmF0dHJpYnV0ZXMgPT0gbnVsbCkpIHtcclxuICAgICAgICAgICAgdmFyIHJlZnJlc2hEaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoaXNEZXNpZ25UaW1lKVxyXG4gICAgICAgICAgICAgICAgcmVmcmVzaERpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmVmcmVzaEVsZW1lbnQgPSBSZWFjdC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIHsgY2xhc3NOYW1lOiAnYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCB0YWJsZS1yZWZyZXNoJywgb25DbGljazogcmVmcmVzaCwgZGlzYWJsZWQ6IHJlZnJlc2hEaXNhYmxlZCB9LFxyXG4gICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6ICdnbHlwaGljb24gZ2x5cGhpY29uLXJlZnJlc2gnIH0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzU2VhcmNoRW5hYmxlZCkge1xyXG4gICAgICAgICAgICB2YXIgc2VhcmNoRGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKGlzRGVzaWduVGltZSlcclxuICAgICAgICAgICAgICAgIHNlYXJjaERpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2VhcmNoRWxlbWVudCA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6ICdpbnB1dC1ncm91cCB0YWJsZS1zZWFyY2gnIH0sXHJcbiAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwgeyB0eXBlOiAndGV4dCcsIGNsYXNzTmFtZTogJ2Zvcm0tY29udHJvbCcsIHZhbHVlOiBzZWFyY2hWYWx1ZSwgcGxhY2Vob2xkZXI6ICdTZWFyY2gnLCBvbkNoYW5nZTogb25TZWFyY2hDaGFuZ2VkLCBvbktleVVwOiBvblNlYXJjaEVudGVyZWQgfSxcclxuICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IGNsYXNzTmFtZTogJ2lucHV0LWdyb3VwLWJ0bicgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCB7IGNsYXNzTmFtZTogJ2J0biBidG4tZGVmYXVsdCcsIG9uQ2xpY2s6IHNlYXJjaCwgZGlzYWJsZWQ6IHNlYXJjaERpc2FibGVkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IGNsYXNzTmFtZTogJ2dseXBoaWNvbiBnbHlwaGljb24tc2VhcmNoJyB9KSkpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvdXRjb21lcykge1xyXG4gICAgICAgICAgICB2YXIgb3V0Y29tZUVsZW1lbnRzID0gb3V0Y29tZXMubWFwKGZ1bmN0aW9uIChvdXRjb21lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChtYW55d2hvLmNvbXBvbmVudC5nZXRCeU5hbWUoJ291dGNvbWUnKSwgeyBpZDogb3V0Y29tZS5pZCwgZmxvd0tleTogZmxvd0tleSB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG91dGNvbWVzRWxlbWVudCA9IFJlYWN0LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6ICd0YWJsZS1vdXRjb21lcycgfSwgb3V0Y29tZUVsZW1lbnRzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG1haW5FbGVtZW50ICYmIG1haW5FbGVtZW50LmNsaWVudFdpZHRoIDwgNzY4KSB7XHJcbiAgICAgICAgICAgIGhlYWRlckVsZW1lbnRzID0gW291dGNvbWVzRWxlbWVudCwgc2VhcmNoRWxlbWVudCwgcmVmcmVzaEVsZW1lbnRdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaGVhZGVyRWxlbWVudHMgPSBbcmVmcmVzaEVsZW1lbnQsIHNlYXJjaEVsZW1lbnQsIG91dGNvbWVzRWxlbWVudF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChoZWFkZXJFbGVtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAndGFibGUtaGVhZGVyIGNsZWFyZml4JyB9LCBoZWFkZXJFbGVtZW50cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLnJlbmRlckZvb3RlciA9IGZ1bmN0aW9uIChwYWdlSW5kZXgsIGhhc01vcmVSZXN1bHRzLCBvbk5leHQsIG9uUHJldiwgaXNEZXNpZ25UaW1lKSB7XHJcbiAgICAgICAgdmFyIGZvb3RlckVsZW1lbnRzID0gW107XHJcbiAgICAgICAgaWYgKHBhZ2VJbmRleCA+IDEgfHwgaGFzTW9yZVJlc3VsdHMpIHtcclxuICAgICAgICAgICAgZm9vdGVyRWxlbWVudHMucHVzaChSZWFjdC5jcmVhdGVFbGVtZW50KG1hbnl3aG8uY29tcG9uZW50LmdldEJ5TmFtZSgncGFnaW5hdGlvbicpLCB7XHJcbiAgICAgICAgICAgICAgICBwYWdlSW5kZXg6IHBhZ2VJbmRleCxcclxuICAgICAgICAgICAgICAgIGhhc01vcmVSZXN1bHRzOiBoYXNNb3JlUmVzdWx0cyxcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lckNsYXNzZXM6ICdwdWxsLXJpZ2h0JyxcclxuICAgICAgICAgICAgICAgIG9uTmV4dDogb25OZXh0LFxyXG4gICAgICAgICAgICAgICAgb25QcmV2OiBvblByZXYsXHJcbiAgICAgICAgICAgICAgICBpc0Rlc2lnblRpbWU6IGlzRGVzaWduVGltZVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmb290ZXJFbGVtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAndGFibGUtZm9vdGVyIGNsZWFyZml4JyB9LCBmb290ZXJFbGVtZW50cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLnJlbmRlckNoYXJ0ID0gZnVuY3Rpb24gKG9iamVjdERhdGEsIG91dGNvbWVzLCBkaXNwbGF5Q29sdW1ucykge1xyXG4gICAgICAgIHZhciBtb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHRoaXMucHJvcHMuZmxvd0tleSk7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gXCIxMDAlXCI7XHJcbiAgICAgICAgdmFyIGhlaWdodCA9IFwiMTAwJVwiO1xyXG4gICAgICAgIHZhciBkYXRhID0gW107XHJcbiAgICAgICAgLy9hZGQgdGhlIGRpc3BsYXkgY29sdW1uc1xyXG4gICAgICAgIHZhciBjb2x1bW5zID0gW107XHJcbiAgICAgICAgaWYgKGRpc3BsYXlDb2x1bW5zICE9IG51bGwgJiYgZGlzcGxheUNvbHVtbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRpc3BsYXlDb2x1bW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb2x1bW5zLnB1c2goZGlzcGxheUNvbHVtbnNbaV0ubGFiZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRhdGEucHVzaChjb2x1bW5zKTtcclxuICAgICAgICBpZiAob2JqZWN0RGF0YSAhPSBudWxsICYmIG9iamVjdERhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdERhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChvYmplY3REYXRhW2ldLnByb3BlcnRpZXMgIT0gbnVsbCAmJiBvYmplY3REYXRhW2ldLnByb3BlcnRpZXMubGVuZ3RoID09IGNvbHVtbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvdyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vbG9vcCBvdmVyIHRoZSBkaXNwbGF5IGNvbHVtbnMgZ2V0dGluZyB0aGUgb2JqZWN0RGF0YS5wcm9wZXJ0eSBmb3IgdGhhdCBpZFxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZGlzcGxheUNvbHVtbnMubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBvYmplY3REYXRhW2ldLnByb3BlcnRpZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmplY3REYXRhW2ldLnByb3BlcnRpZXNbal0udHlwZUVsZW1lbnRQcm9wZXJ0eUlkID09IGRpc3BsYXlDb2x1bW5zW2tdLnR5cGVFbGVtZW50UHJvcGVydHlJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnZlcnRUb0dvb2dsZVR5cGUoZGlzcGxheUNvbHVtbnNba10uY29udGVudFR5cGUpID09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBudW1iZXIgPSBwYXJzZUZsb2F0KG9iamVjdERhdGFbaV0ucHJvcGVydGllc1tqXS5jb250ZW50VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4obnVtYmVyKSA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXIgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdy5wdXNoKG51bWJlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cucHVzaChvYmplY3REYXRhW2ldLnByb3BlcnRpZXNbal0uY29udGVudFZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKHJvdyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNoYXJ0VHlwZTtcclxuICAgICAgICBpZiAobW9kZWwuYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHt9O1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gbW9kZWwuYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY2hhcnRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoYXJ0VHlwZVJlc3VsdCA9IHRoaXMuY2hhcnROYW1lVG9UeXBlKG1vZGVsLmF0dHJpYnV0ZXNba2V5XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0VHlwZSA9IGNoYXJ0VHlwZVJlc3VsdC5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBvS2V5IGluIGNoYXJ0VHlwZVJlc3VsdC5vcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zW29LZXldID0gY2hhcnRUeXBlUmVzdWx0Lm9wdGlvbnNbb0tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9leGNsdWRlIHRoZXNlXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNsYXNzZXNcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9kbyBub3RoaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNba2V5XSA9IG1vZGVsLmF0dHJpYnV0ZXNba2V5XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY2hhcnRUeXBlID0gXCJQaWVDaGFydFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGlkOiB0aGlzLnByb3BzLmlkIH0sXHJcbiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQocmVhY3RfZ29vZ2xlX2NoYXJ0c18xLmRlZmF1bHQsIHsgY2hhcnRUeXBlOiBjaGFydFR5cGUsIHdpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQsIGxlZ2VuZFRvZ2dsZTogdHJ1ZSwgZGF0YTogZGF0YSwgb3B0aW9uczogb3B0aW9ucyB9KSk7XHJcbiAgICB9O1xyXG4gICAgR29vZ2xlQ2hhcnQucHJvdG90eXBlLnJlbmRlcldhaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy9yZXR1cm4gPHttYW55d2hvLmNvbXBvbmVudC5nZXRCeU5hbWUoJ3dhaXQnKX0+XHJcbiAgICAgICAgLy9SZWFjdC5jcmVhdGVFbGVtZW50KG1hbnl3aG8uY29tcG9uZW50LmdldEJ5TmFtZSgnd2FpdCcpLCB7IGlzVmlzaWJsZTogc3RhdGUubG9hZGluZywgbWVzc2FnZTogc3RhdGUubG9hZGluZyAmJiBzdGF0ZS5sb2FkaW5nLm1lc3NhZ2UsIGlzU21hbGw6IHRydWUgfSwgbnVsbClcclxuICAgIH07XHJcbiAgICBHb29nbGVDaGFydC5wcm90b3R5cGUuY2hhcnROYW1lVG9UeXBlID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0geyBuYW1lOiBcIlwiLCBvcHRpb25zOiB7fSB9O1xyXG4gICAgICAgIHN3aXRjaCAobmFtZS50b0xvd2VyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Fubm90YXRpb24nOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIkFubm90YXRpb25DaGFydFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2FyZWEnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIkFyZWFDaGFydFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Jhcic6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQubmFtZSA9IFwiQmFyQ2hhcnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdidWJibGUnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIkJ1YmJsZUNoYXJ0XCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY2FsZW5kYXInOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIkNhbGVuZGFyXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY2FuZGxlc3RpY2snOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIkNhbmRsZXN0aWNrQ2hhcnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdjb2x1bW4nOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIkNvbHVtbkNoYXJ0XCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZ2FudHQnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIkdhbm50XCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZ2F1Z2UnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIkdhdWdlXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZ2VvJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gXCJHZW9DaGFydFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2xpbmUnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIkxpbmVDaGFydFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ29yZyc6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQubmFtZSA9IFwiT3JnQ2hhcnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdwaWUnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBcIlBpZUNoYXJ0XCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnc2Fua2V5JzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gXCJTYW5rZXlcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdzY2F0dGVyJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gXCJTY2F0dGVyQ2hhcnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdzdGVwcGVkYXJlYSc6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQubmFtZSA9IFwiU3RlcHBlZEFyZWFDaGFydFwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RhYmxlJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gXCJUYWJsZVwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3RpbWVsaW5lcyc6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQubmFtZSA9IFwiVGltZUxpbmVcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd0cmVlbWFwJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gXCJUcmVlTWFwXCI7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndHJlbmQnOlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm9wdGlvbnMudHJlbmRsaW5lcyA9IHsgMDoge30gfTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gXCJTY2F0dGVyQ2hhcnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd3b3JkdHJlZSc6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQub3B0aW9ucy53b3JkdHJlZSA9IHsgZm9ybWF0OiAnaW1wbGljaXQnLCB3b3JkOiAnY2F0cycgfTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gXCJXb3JkVHJlZVwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQubmFtZSA9IFwiUGllQ2hhcnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBHb29nbGVDaGFydDtcclxufShSZWFjdC5Db21wb25lbnQpKTtcclxubWFueXdoby5jb21wb25lbnQucmVnaXN0ZXIoJ0dvb2dsZUNoYXJ0JywgR29vZ2xlQ2hhcnQpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBHb29nbGVDaGFydDtcclxuXG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShfX3dlYnBhY2tfZXhwb3J0c19fLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qIGhhcm1vbnkgZXhwb3J0IChiaW5kaW5nKSAqLyBfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJDaGFydFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIENoYXJ0OyB9KTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfXyA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3JlYWN0X19fZGVmYXVsdCA9IF9fd2VicGFja19yZXF1aXJlX18ubihfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfXyk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX3JlYWN0X2xvYWRfc2NyaXB0X18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9yZWFjdF9sb2FkX3NjcmlwdF9fX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm4oX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX3JlYWN0X2xvYWRfc2NyaXB0X18pO1xuXG5cblxuLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxudmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxuXG52YXIgREVGQVVMVF9DSEFSVF9DT0xPUlMgPSBbXHJcbiAgICBcIiMzMzY2Q0NcIixcclxuICAgIFwiI0RDMzkxMlwiLFxyXG4gICAgXCIjRkY5OTAwXCIsXHJcbiAgICBcIiMxMDk2MThcIixcclxuICAgIFwiIzk5MDA5OVwiLFxyXG4gICAgXCIjM0IzRUFDXCIsXHJcbiAgICBcIiMwMDk5QzZcIixcclxuICAgIFwiI0RENDQ3N1wiLFxyXG4gICAgXCIjNjZBQTAwXCIsXHJcbiAgICBcIiNCODJFMkVcIixcclxuICAgIFwiIzMxNjM5NVwiLFxyXG4gICAgXCIjOTk0NDk5XCIsXHJcbiAgICBcIiMyMkFBOTlcIixcclxuICAgIFwiI0FBQUExMVwiLFxyXG4gICAgXCIjNjYzM0NDXCIsXHJcbiAgICBcIiNFNjczMDBcIixcclxuICAgIFwiIzhCMDcwN1wiLFxyXG4gICAgXCIjMzI5MjYyXCIsXHJcbiAgICBcIiM1NTc0QTZcIixcclxuICAgIFwiIzNCM0VBQ1wiXHJcbl07XG5cbnZhciBSZWFjdEdvb2dsZUNoYXJ0c0xvYWRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoUmVhY3RHb29nbGVDaGFydHNMb2FkZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBSZWFjdEdvb2dsZUNoYXJ0c0xvYWRlcihwcm9wcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xyXG4gICAgICAgIHZhciBkb2N1bWVudFNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcclxuICAgICAgICBfdGhpcy5sb2FkU2NyaXB0ID0gdHJ1ZTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRvY3VtZW50U2NyaXB0cy5sZW5ndGg7IGkgKz0gMSkge1xyXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnRTY3JpcHRzW2ldLnNyYy5pbmNsdWRlcyhcImdzdGF0aWMuY29tL2NoYXJ0cy9sb2FkZXIuanNcIikpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmxvYWRTY3JpcHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBSZWFjdEdvb2dsZUNoYXJ0c0xvYWRlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubG9hZFNjcmlwdCA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5wcm9wcy5vbkxvYWQoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVhY3RHb29nbGVDaGFydHNMb2FkZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX2EgPSB0aGlzLnByb3BzLCBvbkVycm9yID0gX2Eub25FcnJvciwgb25Mb2FkID0gX2Eub25Mb2FkO1xyXG4gICAgICAgIGlmICh0aGlzLmxvYWRTY3JpcHQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChPYmplY3QoX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3JlYWN0X19bXCJjcmVhdGVFbGVtZW50XCJdKShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfcmVhY3RfbG9hZF9zY3JpcHRfXywgeyB1cmw6IFwiaHR0cHM6Ly93d3cuZ3N0YXRpYy5jb20vY2hhcnRzL2xvYWRlci5qc1wiLCBvbkVycm9yOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgfSwgb25Mb2FkOiBvbkxvYWQgfSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBSZWFjdEdvb2dsZUNoYXJ0c0xvYWRlcjtcclxufShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfX1tcIkNvbXBvbmVudFwiXSkpO1xuXG52YXIgX3RoaXMgPSB1bmRlZmluZWQ7XHJcbnZhciBHUkFZX0NPTE9SID0gXCIjQ0NDQ0NDXCI7XHJcbnZhciB1bmlxdWVJRCA9IDA7XHJcbnZhciBnZW5lcmF0ZVVuaXF1ZUlEID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdW5pcXVlSUQgKz0gMTtcclxuICAgIHJldHVybiBcInJlYWN0Z29vZ2xlZ3JhcGgtXCIgKyB1bmlxdWVJRDtcclxufTtcclxudmFyIGNoYXJ0RGVmYXVsdFByb3BzID0ge1xyXG4gICAgZ3JhcGhfaWQ6IG51bGwsXHJcbiAgICBsZWdlbmRfdG9nZ2xlOiBmYWxzZSxcclxuICAgIGdyYXBoSUQ6IG51bGwsXHJcbiAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgY29sb3JzOiBudWxsXHJcbiAgICB9LFxyXG4gICAgZGF0YTogbnVsbCxcclxuICAgIHJvd3M6IG51bGwsXHJcbiAgICBjb2x1bW5zOiBudWxsLFxyXG4gICAgZGlmZmRhdGE6IG51bGwsXHJcbiAgICBjaGFydEV2ZW50czogbnVsbCxcclxuICAgIGxlZ2VuZFRvZ2dsZTogZmFsc2UsXHJcbiAgICBjaGFydEFjdGlvbnM6IG51bGwsXHJcbiAgICBnZXRDaGFydFdyYXBwZXI6IGZ1bmN0aW9uIChjaGFydFdyYXBwZXIsIGdvb2dsZSkgeyB9LFxyXG4gICAgY2xhc3NOYW1lOiBcIlwiLFxyXG4gICAgc3R5bGU6IHt9LFxyXG4gICAgZm9ybWF0dGVyczogbnVsbCxcclxuICAgIHNwcmVhZFNoZWV0VXJsOiBudWxsLFxyXG4gICAgc3ByZWFkU2hlZXRRdWVyeVBhcmFtZXRlcnM6IHtcclxuICAgICAgICBoZWFkZXJzOiAxLFxyXG4gICAgICAgIGdpZDogMVxyXG4gICAgfSxcclxuICAgIHJvb3RQcm9wczoge31cclxufTtcclxudmFyIGxvYWREYXRhVGFibGVGcm9tU3ByZWFkU2hlZXQgPSBmdW5jdGlvbiAoZ29vZ2xlVml6LCBzcHJlYWRTaGVldFVybCwgdXJsUGFyYW1zKSB7XHJcbiAgICBpZiAodXJsUGFyYW1zID09PSB2b2lkIDApIHsgdXJsUGFyYW1zID0ge307IH1cclxuICAgIHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gWzIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IFwiXCIgKyAodXJsUGFyYW1zLmhlYWRlcnMgPyBcImhlYWRlcnM9XCIgKyB1cmxQYXJhbXMuaGVhZGVycyA6IFwiaGVhZGVycz0wXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeVN0cmluZyA9IFwiXCIgKyAodXJsUGFyYW1zLnF1ZXJ5ID8gXCImdHE9XCIgKyBlbmNvZGVVUklDb21wb25lbnQodXJsUGFyYW1zLnF1ZXJ5KSA6IFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBnaWQgPSBcIlwiICsgKHVybFBhcmFtcy5naWQgPyBcIiZnaWQ9XCIgKyB1cmxQYXJhbXMuZ2lkIDogXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoZWV0ID0gXCJcIiArICh1cmxQYXJhbXMuc2hlZXQgPyBcIiZzaGVldD1cIiArIHVybFBhcmFtcy5zaGVldCA6IFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmxRdWVyeVN0cmluZyA9IFwiXCIgKyBoZWFkZXJzICsgZ2lkICsgc2hlZXQgKyBxdWVyeVN0cmluZztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsVG9TcHJlYWRTaGVldCA9IHNwcmVhZFNoZWV0VXJsICsgXCIvZ3Zpei90cT9cIiArIHVybFF1ZXJ5U3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IG5ldyBnb29nbGVWaXoudmlzdWFsaXphdGlvbi5RdWVyeSh1cmxUb1NwcmVhZFNoZWV0KTtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeS5zZW5kKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuaXNFcnJvcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJFcnJvciBpbiBxdWVyeTogIFwiICsgcmVzcG9uc2UuZ2V0TWVzc2FnZSgpICsgXCIgXCIgKyByZXNwb25zZS5nZXREZXRhaWxlZE1lc3NhZ2UoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlLmdldERhdGFUYWJsZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcbnZhciBDaGFydCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoQ2hhcnQsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBDaGFydCgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgbG9hZGluZ1N0YXR1czogXCJsb2FkaW5nXCIsXHJcbiAgICAgICAgICAgIGdvb2dsZTogbnVsbCxcclxuICAgICAgICAgICAgaGlkZGVuQ29sdW1uczogW11cclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmdyYXBoSUQgPSBudWxsO1xyXG4gICAgICAgIF90aGlzLmNoYXJ0V3JhcHBlciA9IG51bGw7XHJcbiAgICAgICAgX3RoaXMuZ2V0R3JhcGhJRCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hID0gX3RoaXNcclxuICAgICAgICAgICAgICAgIC5wcm9wcywgZ3JhcGhJRCA9IF9hLmdyYXBoSUQsIGdyYXBoX2lkID0gX2EuZ3JhcGhfaWQ7XHJcbiAgICAgICAgICAgIHZhciBpbnN0YW5jZUdyYXBoSUQ7XHJcbiAgICAgICAgICAgIGlmIChncmFwaElEID09PSBudWxsICYmIGdyYXBoX2lkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuZ3JhcGhJRCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlR3JhcGhJRCA9IGdlbmVyYXRlVW5pcXVlSUQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlR3JhcGhJRCA9IF90aGlzLmdyYXBoSUQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZ3JhcGhJRCAhPT0gbnVsbCAmJiBncmFwaF9pZCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2VHcmFwaElEID0gZ3JhcGhJRDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChncmFwaF9pZCAhPT0gbnVsbCAmJiBncmFwaElEID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZUdyYXBoSUQgPSBncmFwaF9pZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlR3JhcGhJRCA9IGdyYXBoSUQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuZ3JhcGhJRCA9IGluc3RhbmNlR3JhcGhJRDtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmdyYXBoSUQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBfdGhpcy5kcmF3ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2EsIGRhdGEsIGRpZmZkYXRhLCBjb2x1bW5zLCByb3dzLCBvcHRpb25zLCBsZWdlbmRfdG9nZ2xlLCBsZWdlbmRUb2dnbGUsIGNoYXJ0VHlwZSwgZm9ybWF0dGVycywgc3ByZWFkU2hlZXRVcmwsIHNwcmVhZFNoZWV0UXVlcnlQYXJhbWV0ZXJzLCBkYXRhVGFibGUsIGNoYXJ0RGlmZiwgb2xkRGF0YSwgbmV3RGF0YSwgY29sdW1uQ291bnQsIGksIGNvbHVtbklELCBwcmV2aW91c0NvbHVtbkxhYmVsLCBwcmV2aW91c0NvbHVtbklELCBwcmV2aW91c0NvbHVtblR5cGUsIGNoYXJ0O1xyXG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGFydFdyYXBwZXIgPT09IG51bGwgfHwgdGhpcy5zdGF0ZS5nb29nbGUgPT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXMucHJvcHMsIGRhdGEgPSBfYS5kYXRhLCBkaWZmZGF0YSA9IF9hLmRpZmZkYXRhLCBjb2x1bW5zID0gX2EuY29sdW1ucywgcm93cyA9IF9hLnJvd3MsIG9wdGlvbnMgPSBfYS5vcHRpb25zLCBsZWdlbmRfdG9nZ2xlID0gX2EubGVnZW5kX3RvZ2dsZSwgbGVnZW5kVG9nZ2xlID0gX2EubGVnZW5kVG9nZ2xlLCBjaGFydFR5cGUgPSBfYS5jaGFydFR5cGUsIGZvcm1hdHRlcnMgPSBfYS5mb3JtYXR0ZXJzLCBzcHJlYWRTaGVldFVybCA9IF9hLnNwcmVhZFNoZWV0VXJsLCBzcHJlYWRTaGVldFF1ZXJ5UGFyYW1ldGVycyA9IF9hLnNwcmVhZFNoZWV0UXVlcnlQYXJhbWV0ZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFydERpZmYgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlmZmRhdGEgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZERhdGEgPSB0aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLmFycmF5VG9EYXRhVGFibGUoZGlmZmRhdGEub2xkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0RhdGEgPSB0aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLmFycmF5VG9EYXRhVGFibGUoZGlmZmRhdGEubmV3KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0RGlmZiA9IHRoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb25bY2hhcnRUeXBlXS5wcm90b3R5cGUuY29tcHV0ZURpZmYob2xkRGF0YSwgbmV3RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGF0YSAhPT0gbnVsbCkpIHJldHVybiBbMywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVGFibGUgPSB0aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLmFycmF5VG9EYXRhVGFibGUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVGFibGUgPSBuZXcgdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5EYXRhVGFibGUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJvd3MgIT09IG51bGwgJiYgY29sdW1ucyAhPT0gbnVsbCkpIHJldHVybiBbMywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUYWJsZSA9IHRoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uYXJyYXlUb0RhdGFUYWJsZShbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uY29uY2F0KHJvd3MpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHNwcmVhZFNoZWV0VXJsICE9PSBudWxsKSkgcmV0dXJuIFszLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBsb2FkRGF0YVRhYmxlRnJvbVNwcmVhZFNoZWV0KHRoaXMuc3RhdGUuZ29vZ2xlLCBzcHJlYWRTaGVldFVybCwgc3ByZWFkU2hlZXRRdWVyeVBhcmFtZXRlcnMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUYWJsZSA9IChfYi5zZW50KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVRhYmxlID0gdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5hcnJheVRvRGF0YVRhYmxlKFtdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uQ291bnQgPSBkYXRhVGFibGUuZ2V0TnVtYmVyT2ZDb2x1bW5zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb2x1bW5Db3VudDsgaSArPSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5JRCA9IHRoaXMuZ2V0Q29sdW1uSUQoZGF0YVRhYmxlLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmhpZGRlbkNvbHVtbnMuaW5jbHVkZXMoY29sdW1uSUQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNDb2x1bW5MYWJlbCA9IGRhdGFUYWJsZS5nZXRDb2x1bW5MYWJlbChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c0NvbHVtbklEID0gZGF0YVRhYmxlLmdldENvbHVtbklkKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzQ29sdW1uVHlwZSA9IGRhdGFUYWJsZS5nZXRDb2x1bW5UeXBlKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUYWJsZS5yZW1vdmVDb2x1bW4oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVRhYmxlLmFkZENvbHVtbih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBwcmV2aW91c0NvbHVtbkxhYmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogcHJldmlvdXNDb2x1bW5JRCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogcHJldmlvdXNDb2x1bW5UeXBlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnQgPSB0aGlzLmNoYXJ0V3JhcHBlci5nZXRDaGFydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGFydFdyYXBwZXIuZ2V0Q2hhcnRUeXBlKCkgPT09IFwiVGltZWxpbmVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnQgJiYgY2hhcnQuY2xlYXJDaGFydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyLnNldE9wdGlvbnMob3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyLnNldERhdGFUYWJsZShkYXRhVGFibGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJ0V3JhcHBlci5kcmF3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFydERpZmYgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyLnNldERhdGFUYWJsZShjaGFydERpZmYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFydFdyYXBwZXIuZHJhdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXR0ZXJzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0dGVycyhkYXRhVGFibGUsIGZvcm1hdHRlcnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFydFdyYXBwZXIuc2V0RGF0YVRhYmxlKGRhdGFUYWJsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJ0V3JhcHBlci5kcmF3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxlZ2VuZFRvZ2dsZSA9PT0gdHJ1ZSB8fCBsZWdlbmRfdG9nZ2xlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdyYXlPdXRIaWRkZW5Db2x1bW5zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH07XHJcbiAgICAgICAgX3RoaXMuYXBwbHlGb3JtYXR0ZXJzID0gZnVuY3Rpb24gKGRhdGFUYWJsZSwgZm9ybWF0dGVycykge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuc3RhdGUuZ29vZ2xlID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGZvcm1hdHRlcnNfMSA9IGZvcm1hdHRlcnM7IF9pIDwgZm9ybWF0dGVyc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvcm1hdHRlciA9IGZvcm1hdHRlcnNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGZvcm1hdHRlci50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIkFycm93Rm9ybWF0XCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpekZvcm1hdHRlciA9IG5ldyBfdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5BcnJvd0Zvcm1hdChmb3JtYXR0ZXIub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5mb3JtYXQoZGF0YVRhYmxlLCBmb3JtYXR0ZXIuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJCYXJGb3JtYXRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdml6Rm9ybWF0dGVyID0gbmV3IF90aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLkJhckZvcm1hdChmb3JtYXR0ZXIub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5mb3JtYXQoZGF0YVRhYmxlLCBmb3JtYXR0ZXIuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJDb2xvckZvcm1hdFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aXpGb3JtYXR0ZXIgPSBuZXcgX3RoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uQ29sb3JGb3JtYXQoZm9ybWF0dGVyLm9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmFuZ2VzID0gZm9ybWF0dGVyLnJhbmdlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCByYW5nZXNfMSA9IHJhbmdlczsgX2EgPCByYW5nZXNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHJhbmdlc18xW19hXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5hZGRSYW5nZS5hcHBseSh2aXpGb3JtYXR0ZXIsIHJhbmdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aXpGb3JtYXR0ZXIuZm9ybWF0KGRhdGFUYWJsZSwgZm9ybWF0dGVyLmNvbHVtbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiRGF0ZUZvcm1hdFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aXpGb3JtYXR0ZXIgPSBuZXcgX3RoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uRGF0ZUZvcm1hdChmb3JtYXR0ZXIub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5mb3JtYXQoZGF0YVRhYmxlLCBmb3JtYXR0ZXIuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJOdW1iZXJGb3JtYXRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdml6Rm9ybWF0dGVyID0gbmV3IF90aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLk51bWJlckZvcm1hdChmb3JtYXR0ZXIub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5mb3JtYXQoZGF0YVRhYmxlLCBmb3JtYXR0ZXIuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJQYXR0ZXJuRm9ybWF0XCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpekZvcm1hdHRlciA9IG5ldyBfdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5QYXR0ZXJuRm9ybWF0KGZvcm1hdHRlci5vcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdml6Rm9ybWF0dGVyLmZvcm1hdChkYXRhVGFibGUsIGZvcm1hdHRlci5jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmdyYXlPdXRIaWRkZW5Db2x1bW5zID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuY2hhcnRXcmFwcGVyID09PSBudWxsIHx8IF90aGlzLnN0YXRlLmdvb2dsZSA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdmFyIGRhdGFUYWJsZSA9IF90aGlzLmNoYXJ0V3JhcHBlci5nZXREYXRhVGFibGUoKTtcclxuICAgICAgICAgICAgaWYgKGRhdGFUYWJsZSA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdmFyIGNvbHVtbkNvdW50ID0gZGF0YVRhYmxlLmdldE51bWJlck9mQ29sdW1ucygpO1xyXG4gICAgICAgICAgICB2YXIgaGFzQUhpZGRlbkNvbHVtbiA9IF90aGlzLnN0YXRlLmhpZGRlbkNvbHVtbnMubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgaWYgKGhhc0FIaWRkZW5Db2x1bW4gPT09IGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IF90aGlzLnByb3BzLm9wdGlvbnM7XHJcbiAgICAgICAgICAgIHZhciBjb2xvcnMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBjb2x1bW5Db3VudCAtIDEgfSkubWFwKGZ1bmN0aW9uIChkb250Y2FyZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbklEID0gX3RoaXMuZ2V0Q29sdW1uSUQoZGF0YVRhYmxlLCBpICsgMSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc3RhdGUuaGlkZGVuQ29sdW1ucy5pbmNsdWRlcyhjb2x1bW5JRCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gR1JBWV9DT0xPUjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLmNvbG9ycyAhPT0gXCJ1bmRlZmluZWRcIiAmJlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuY29sb3JzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnMuY29sb3JzW2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERFRkFVTFRfQ0hBUlRfQ09MT1JTW2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgX3RoaXMuY2hhcnRXcmFwcGVyLnNldE9wdGlvbnMoX19hc3NpZ24oe30sIF90aGlzLnByb3BzLm9wdGlvbnMsIHsgY29sb3JzOiBjb2xvcnMgfSkpO1xyXG4gICAgICAgICAgICBfdGhpcy5jaGFydFdyYXBwZXIuZHJhdygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgX3RoaXMub25SZXNpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5jaGFydFdyYXBwZXIgPT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIF90aGlzLmNoYXJ0V3JhcHBlci5kcmF3KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBfdGhpcy5zZXRDaGFydEFjdGlvbnMgPSBmdW5jdGlvbiAoY3VycmVudEFjdGlvbnMsIHByZXZpb3VzQWN0aW9ucykge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuY2hhcnRXcmFwcGVyID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB2YXIgY2hhcnQgPSBfdGhpcy5jaGFydFdyYXBwZXIuZ2V0Q2hhcnQoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBwcmV2aW91c0FjdGlvbnNfMSA9IHByZXZpb3VzQWN0aW9uczsgX2kgPCBwcmV2aW91c0FjdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGFydEFjdGlvbiA9IHByZXZpb3VzQWN0aW9uc18xW19pXTtcclxuICAgICAgICAgICAgICAgIGNoYXJ0LnJlbW92ZUFjdGlvbihjaGFydEFjdGlvbi5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoY2hhcnRBY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGNoYXJ0LnNldEFjdGlvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGNoYXJ0QWN0aW9uLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGNoYXJ0QWN0aW9uLnRleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGFydEFjdGlvbi5hY3Rpb24oX3RoaXMuY2hhcnRXcmFwcGVyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBjdXJyZW50QWN0aW9uc18xID0gY3VycmVudEFjdGlvbnM7IF9hIDwgY3VycmVudEFjdGlvbnNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGFydEFjdGlvbiA9IGN1cnJlbnRBY3Rpb25zXzFbX2FdO1xyXG4gICAgICAgICAgICAgICAgX2xvb3BfMShjaGFydEFjdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmdldENvbHVtbklEID0gZnVuY3Rpb24gKGRhdGFUYWJsZSwgY29sdW1uSW5kZXgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChkYXRhVGFibGUuZ2V0Q29sdW1uSWQoY29sdW1uSW5kZXgpIHx8XHJcbiAgICAgICAgICAgICAgICBkYXRhVGFibGUuZ2V0Q29sdW1uTGFiZWwoY29sdW1uSW5kZXgpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmxpc3RlblRvQ2hhcnRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS5nb29nbGUgPT09IG51bGwgfHwgX3RoaXMuY2hhcnRXcmFwcGVyID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uZXZlbnRzLnJlbW92ZUFsbExpc3RlbmVycyhfdGhpcy5jaGFydFdyYXBwZXIpO1xyXG4gICAgICAgICAgICB2YXIgX2EgPSBfdGhpc1xyXG4gICAgICAgICAgICAgICAgLnByb3BzLCBjaGFydEV2ZW50cyA9IF9hLmNoYXJ0RXZlbnRzLCBsZWdlbmRfdG9nZ2xlID0gX2EubGVnZW5kX3RvZ2dsZSwgbGVnZW5kVG9nZ2xlID0gX2EubGVnZW5kVG9nZ2xlO1xyXG4gICAgICAgICAgICBpZiAoY2hhcnRFdmVudHMgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBfbG9vcF8yID0gZnVuY3Rpb24gKGV2ZW50XzEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnROYW1lID0gZXZlbnRfMS5ldmVudE5hbWUsIGNhbGxiYWNrID0gZXZlbnRfMS5jYWxsYmFjaztcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5ldmVudHMuYWRkTGlzdGVuZXIoX3RoaXMuY2hhcnRXcmFwcGVyLCBldmVudE5hbWUsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY2hhcnRXcmFwcGVyICE9PSBudWxsICYmIF90aGlzLnN0YXRlLmdvb2dsZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0V3JhcHBlcjogX3RoaXMuY2hhcnRXcmFwcGVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzOiBfdGhpcy5wcm9wcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb29nbGU6IF90aGlzLnN0YXRlLmdvb2dsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZTogX3RoaXMuc3RhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRBcmdzOiBhcmdzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgY2hhcnRFdmVudHNfMSA9IGNoYXJ0RXZlbnRzOyBfaSA8IGNoYXJ0RXZlbnRzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50XzEgPSBjaGFydEV2ZW50c18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICBfbG9vcF8yKGV2ZW50XzEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChsZWdlbmRUb2dnbGUgPT09IHRydWUgfHwgbGVnZW5kX3RvZ2dsZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubGlzdGVuVG9MZWdlbmRUb2dnbGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgX3RoaXMubGlzdGVuVG9MZWdlbmRUb2dnbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS5nb29nbGUgPT09IG51bGwgfHwgX3RoaXMuY2hhcnRXcmFwcGVyID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uZXZlbnRzLmFkZExpc3RlbmVyKF90aGlzLmNoYXJ0V3JhcHBlciwgXCJzZWxlY3RcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmNoYXJ0V3JhcHBlciA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hhcnQgPSBfdGhpcy5jaGFydFdyYXBwZXIuZ2V0Q2hhcnQoKTtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rpb24gPSBjaGFydC5nZXRTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhVGFibGUgPSBfdGhpcy5jaGFydFdyYXBwZXIuZ2V0RGF0YVRhYmxlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0aW9uLmxlbmd0aCA9PT0gMCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvblswXS5yb3cgIT09IG51bGwgfHxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhVGFibGUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgY29sdW1uSW5kZXggPSBzZWxlY3Rpb25bMF0uY29sdW1uO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbklEID0gX3RoaXMuZ2V0Q29sdW1uSUQoZGF0YVRhYmxlLCBjb2x1bW5JbmRleCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc3RhdGUuaGlkZGVuQ29sdW1ucy5pbmNsdWRlcyhjb2x1bW5JRCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAoc3RhdGUpIHsgcmV0dXJuIChfX2Fzc2lnbih7fSwgc3RhdGUsIHsgaGlkZGVuQ29sdW1uczogc3RhdGUuaGlkZGVuQ29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKGNvbElEKSB7IHJldHVybiBjb2xJRCAhPT0gY29sdW1uSUQ7IH0pLnNsaWNlKCkgfSkpOyB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRyYXcoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gKF9fYXNzaWduKHt9LCBzdGF0ZSwgeyBoaWRkZW5Db2x1bW5zOiBzdGF0ZS5oaWRkZW5Db2x1bW5zLmNvbmNhdChbY29sdW1uSURdKSB9KSk7IH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZHJhdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmhhbmRsZUdvb2dsZUNoYXJ0c0xvYWRlclNjcmlwdExvYWRlZCA9IGZ1bmN0aW9uICh3aW5kb3dHb29nbGVDaGFydHMpIHtcclxuICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIHZlcnNpb24gPSBfYS5jaGFydFZlcnNpb24sIHBhY2thZ2VzID0gX2EuY2hhcnRQYWNrYWdlcywgbGFuZ3VhZ2UgPSBfYS5jaGFydExhbmd1YWdlLCBtYXBzQXBpS2V5ID0gX2EubWFwc0FwaUtleTtcclxuICAgICAgICAgICAgd2luZG93R29vZ2xlQ2hhcnRzLmNoYXJ0cy5sb2FkKHZlcnNpb24gfHwgXCJjdXJyZW50XCIsIHtcclxuICAgICAgICAgICAgICAgIHBhY2thZ2VzOiBwYWNrYWdlcyB8fCBbXCJjb3JlY2hhcnRcIl0sXHJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZTogbGFuZ3VhZ2UgfHwgXCJlblwiLFxyXG4gICAgICAgICAgICAgICAgbWFwc0FwaUtleTogbWFwc0FwaUtleVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgd2luZG93R29vZ2xlQ2hhcnRzLmNoYXJ0cy5zZXRPbkxvYWRDYWxsYmFjayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAoc3RhdGUpIHsgcmV0dXJuIChfX2Fzc2lnbih7fSwgc3RhdGUsIHsgbG9hZGluZ1N0YXR1czogXCJyZWFkeVwiLCBnb29nbGU6IHdpbmRvd0dvb2dsZUNoYXJ0cyB9KSk7IH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmhhbmRsZUdvb2dsZUNoYXJ0c0xvYWRlclNjcmlwdEVycm9yZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gKF9fYXNzaWduKHt9LCBzdGF0ZSwgeyBsb2FkaW5nU3RhdHVzOiBcImVycm9yZWRcIiB9KSk7IH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgQ2hhcnQucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBsb2FkaW5nU3RhdHVzOiBcImxvYWRpbmdcIiB9KTtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLm9uUmVzaXplKTtcclxuICAgIH07XHJcbiAgICBDaGFydC5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XHJcbiAgICAgICAgdmFyIHByb3BzID0gdGhpcy5wcm9wcztcclxuICAgICAgICBpZiAocHJldlN0YXRlLmxvYWRpbmdTdGF0dXMgIT09IFwicmVhZHlcIiAmJlxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmxvYWRpbmdTdGF0dXMgPT09IFwicmVhZHlcIiAmJlxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmdvb2dsZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgY2hhcnRDb25maWcgPSB7XHJcbiAgICAgICAgICAgICAgICBjaGFydFR5cGU6IHRoaXMucHJvcHMuY2hhcnRUeXBlLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczogdGhpcy5wcm9wcy5vcHRpb25zLFxyXG4gICAgICAgICAgICAgICAgY29udGFpbmVySWQ6IHRoaXMuZ2V0R3JhcGhJRCgpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyID0gbmV3IHRoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uQ2hhcnRXcmFwcGVyKGNoYXJ0Q29uZmlnKTtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5Ub0NoYXJ0RXZlbnRzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhdygpO1xyXG4gICAgICAgICAgICBwcm9wcy5nZXRDaGFydFdyYXBwZXIodGhpcy5jaGFydFdyYXBwZXIsIHRoaXMuc3RhdGUuZ29vZ2xlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJvcHMuY2hhcnRFdmVudHMgIT09IHByZXZQcm9wcy5jaGFydEV2ZW50cykge1xyXG4gICAgICAgICAgICB0aGlzLmxpc3RlblRvQ2hhcnRFdmVudHMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByb3BzLmNoYXJ0QWN0aW9ucyAhPT0gbnVsbCB8fCBwcmV2UHJvcHMuY2hhcnRBY3Rpb25zICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChwcm9wcy5jaGFydEFjdGlvbnMgIT09IHByZXZQcm9wcy5jaGFydEFjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0Q2hhcnRBY3Rpb25zKHByb3BzLmNoYXJ0QWN0aW9ucywgcHJldlByb3BzLmNoYXJ0QWN0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByb3BzLmRhdGEgIT09IHByZXZQcm9wcy5kYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJvcHMucm93cyAhPT0gcHJldlByb3BzLnJvd3MgfHwgcHJvcHMuY29sdW1ucyAhPT0gcHJldlByb3BzLmNvbHVtbnMpIHtcclxuICAgICAgICAgICAgdGhpcy5kcmF3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIENoYXJ0LnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5jaGFydFdyYXBwZXIgPT09IG51bGwgfHwgdGhpcy5zdGF0ZS5nb29nbGUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLm9uUmVzaXplKTtcclxuICAgICAgICB0aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLmV2ZW50cy5yZW1vdmVBbGxMaXN0ZW5lcnModGhpcy5jaGFydFdyYXBwZXIpO1xyXG4gICAgICAgIGlmICh0aGlzLmNoYXJ0V3JhcHBlci5nZXRDaGFydFR5cGUoKSA9PT0gXCJUaW1lbGluZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyLmdldENoYXJ0KCkgJiYgdGhpcy5jaGFydFdyYXBwZXIuZ2V0Q2hhcnQoKS5jbGVhckNoYXJ0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIENoYXJ0LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZGl2U3R5bGUgPSBfX2Fzc2lnbih7IGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQgfHwgKHRoaXMucHJvcHMub3B0aW9ucyAmJiB0aGlzLnByb3BzLm9wdGlvbnMuaGVpZ2h0KSwgd2lkdGg6IHRoaXMucHJvcHMud2lkdGggfHwgKHRoaXMucHJvcHMub3B0aW9ucyAmJiB0aGlzLnByb3BzLm9wdGlvbnMud2lkdGgpIH0sIHRoaXMucHJvcHMuc3R5bGUpO1xyXG4gICAgICAgIHJldHVybiAoT2JqZWN0KF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fW1wiY3JlYXRlRWxlbWVudFwiXSkoXCJkaXZcIiwgX19hc3NpZ24oeyBpZDogdGhpcy5nZXRHcmFwaElEKCksIHN0eWxlOiBkaXZTdHlsZSwgY2xhc3NOYW1lOiB0aGlzLnByb3BzLmNsYXNzTmFtZSB9LCB0aGlzLnByb3BzLnJvb3RQcm9wcyksXHJcbiAgICAgICAgICAgIE9iamVjdChfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfcmVhY3RfX1tcImNyZWF0ZUVsZW1lbnRcIl0pKFJlYWN0R29vZ2xlQ2hhcnRzTG9hZGVyLCB7IG9uRXJyb3I6IHRoaXMuaGFuZGxlR29vZ2xlQ2hhcnRzTG9hZGVyU2NyaXB0RXJyb3JlZCwgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdpbmRvd1dpdGhHb29nbGUgPSB3aW5kb3c7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvd1dpdGhHb29nbGUuZ29vZ2xlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmhhbmRsZUdvb2dsZUNoYXJ0c0xvYWRlclNjcmlwdExvYWRlZCh3aW5kb3dXaXRoR29vZ2xlLmdvb2dsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSB9KSxcclxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5sb2FkaW5nU3RhdHVzID09PSBcImxvYWRpbmdcIiAmJlxyXG4gICAgICAgICAgICAgICAgKHRoaXMucHJvcHMubG9hZGVyID8gdGhpcy5wcm9wcy5sb2FkZXIgOiBcIlJlbmRlcmluZyBDaGFydC4uLlwiKSkpO1xyXG4gICAgfTtcclxuICAgIENoYXJ0LmRlZmF1bHRQcm9wcyA9IGNoYXJ0RGVmYXVsdFByb3BzO1xyXG4gICAgcmV0dXJuIENoYXJ0O1xyXG59KF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9yZWFjdF9fW1wiQ29tcG9uZW50XCJdKSk7XG5cbi8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi8gX193ZWJwYWNrX2V4cG9ydHNfX1tcImRlZmF1bHRcIl0gPSAoQ2hhcnQpO1xuXG5cblxuLyoqKi8gfSksXG4vKiA0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxudmFyIF9wcm9wVHlwZXMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7IGlmIChrZXkgaW4gb2JqKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgeyB2YWx1ZTogdmFsdWUsIGVudW1lcmFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7IH0gZWxzZSB7IG9ialtrZXldID0gdmFsdWU7IH0gcmV0dXJuIG9iajsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbnZhciBTY3JpcHQgPSBmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuICBfaW5oZXJpdHMoU2NyaXB0LCBfUmVhY3QkQ29tcG9uZW50KTtcblxuICAvLyBBIGRpY3Rpb25hcnkgbWFwcGluZyBzY3JpcHQgVVJMIHRvIGEgYm9vbGVhbiB2YWx1ZSBpbmRpY2F0aW5nIGlmIHRoZSBzY3JpcHRcbiAgLy8gaGFzIGZhaWxlZCB0byBsb2FkLlxuXG5cbiAgLy8gQSBkaWN0aW9uYXJ5IG1hcHBpbmcgc2NyaXB0IFVSTHMgdG8gYSBkaWN0aW9uYXJ5IG1hcHBpbmdcbiAgLy8gY29tcG9uZW50IGtleSB0byBjb21wb25lbnQgZm9yIGFsbCBjb21wb25lbnRzIHRoYXQgYXJlIHdhaXRpbmdcbiAgLy8gZm9yIHRoZSBzY3JpcHQgdG8gbG9hZC5cbiAgZnVuY3Rpb24gU2NyaXB0KHByb3BzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNjcmlwdCk7XG5cbiAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoU2NyaXB0Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU2NyaXB0KSkuY2FsbCh0aGlzLCBwcm9wcykpO1xuXG4gICAgX3RoaXMuc2NyaXB0TG9hZGVySWQgPSAnaWQnICsgX3RoaXMuY29uc3RydWN0b3IuaWRDb3VudCsrOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHNwYWNlLXVuYXJ5LW9wcywgbm8tcGx1c3BsdXNcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICAvLyBBIGNvdW50ZXIgdXNlZCB0byBnZW5lcmF0ZSBhIHVuaXF1ZSBpZCBmb3IgZWFjaCBjb21wb25lbnQgdGhhdCB1c2VzXG4gIC8vIFNjcmlwdExvYWRlck1peGluLlxuXG5cbiAgLy8gQSBkaWN0aW9uYXJ5IG1hcHBpbmcgc2NyaXB0IFVSTCB0byBhIGJvb2xlYW4gdmFsdWUgaW5kaWNhdGluZyBpZiB0aGUgc2NyaXB0XG4gIC8vIGhhcyBhbHJlYWR5IGJlZW4gbG9hZGVkLlxuXG5cbiAgX2NyZWF0ZUNsYXNzKFNjcmlwdCwgW3tcbiAgICBrZXk6ICdjb21wb25lbnREaWRNb3VudCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdmFyIF9wcm9wcyA9IHRoaXMucHJvcHMsXG4gICAgICAgICAgb25FcnJvciA9IF9wcm9wcy5vbkVycm9yLFxuICAgICAgICAgIG9uTG9hZCA9IF9wcm9wcy5vbkxvYWQsXG4gICAgICAgICAgdXJsID0gX3Byb3BzLnVybDtcblxuXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3Rvci5sb2FkZWRTY3JpcHRzW3VybF0pIHtcbiAgICAgICAgb25Mb2FkKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IuZXJyb3JlZFNjcmlwdHNbdXJsXSkge1xuICAgICAgICBvbkVycm9yKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgdGhlIHNjcmlwdCBpcyBsb2FkaW5nLCBhZGQgdGhlIGNvbXBvbmVudCB0byB0aGUgc2NyaXB0J3Mgb2JzZXJ2ZXJzXG4gICAgICAvLyBhbmQgcmV0dXJuLiBPdGhlcndpc2UsIGluaXRpYWxpemUgdGhlIHNjcmlwdCdzIG9ic2VydmVycyB3aXRoIHRoZSBjb21wb25lbnRcbiAgICAgIC8vIGFuZCBzdGFydCBsb2FkaW5nIHRoZSBzY3JpcHQuXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3Rvci5zY3JpcHRPYnNlcnZlcnNbdXJsXSkge1xuICAgICAgICB0aGlzLmNvbnN0cnVjdG9yLnNjcmlwdE9ic2VydmVyc1t1cmxdW3RoaXMuc2NyaXB0TG9hZGVySWRdID0gdGhpcy5wcm9wcztcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmNvbnN0cnVjdG9yLnNjcmlwdE9ic2VydmVyc1t1cmxdID0gX2RlZmluZVByb3BlcnR5KHt9LCB0aGlzLnNjcmlwdExvYWRlcklkLCB0aGlzLnByb3BzKTtcblxuICAgICAgdGhpcy5jcmVhdGVTY3JpcHQoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdjb21wb25lbnRXaWxsVW5tb3VudCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgdmFyIHVybCA9IHRoaXMucHJvcHMudXJsO1xuXG4gICAgICB2YXIgb2JzZXJ2ZXJzID0gdGhpcy5jb25zdHJ1Y3Rvci5zY3JpcHRPYnNlcnZlcnNbdXJsXTtcblxuICAgICAgLy8gSWYgdGhlIGNvbXBvbmVudCBpcyB3YWl0aW5nIGZvciB0aGUgc2NyaXB0IHRvIGxvYWQsIHJlbW92ZSB0aGVcbiAgICAgIC8vIGNvbXBvbmVudCBmcm9tIHRoZSBzY3JpcHQncyBvYnNlcnZlcnMgYmVmb3JlIHVubW91bnRpbmcgdGhlIGNvbXBvbmVudC5cbiAgICAgIGlmIChvYnNlcnZlcnMpIHtcbiAgICAgICAgZGVsZXRlIG9ic2VydmVyc1t0aGlzLnNjcmlwdExvYWRlcklkXTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdjcmVhdGVTY3JpcHQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVTY3JpcHQoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdmFyIF9wcm9wczIgPSB0aGlzLnByb3BzLFxuICAgICAgICAgIG9uQ3JlYXRlID0gX3Byb3BzMi5vbkNyZWF0ZSxcbiAgICAgICAgICB1cmwgPSBfcHJvcHMyLnVybCxcbiAgICAgICAgICBhdHRyaWJ1dGVzID0gX3Byb3BzMi5hdHRyaWJ1dGVzO1xuXG4gICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cbiAgICAgIG9uQ3JlYXRlKCk7XG5cbiAgICAgIC8vIGFkZCAnZGF0YS0nIG9yIG5vbiBzdGFuZGFyZCBhdHRyaWJ1dGVzIHRvIHRoZSBzY3JpcHQgdGFnXG4gICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgICAgICAgcmV0dXJuIHNjcmlwdC5zZXRBdHRyaWJ1dGUocHJvcCwgYXR0cmlidXRlc1twcm9wXSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBzY3JpcHQuc3JjID0gdXJsO1xuXG4gICAgICAvLyBkZWZhdWx0IGFzeW5jIHRvIHRydWUgaWYgbm90IHNldCB3aXRoIGN1c3RvbSBhdHRyaWJ1dGVzXG4gICAgICBpZiAoIXNjcmlwdC5oYXNBdHRyaWJ1dGUoJ2FzeW5jJykpIHtcbiAgICAgICAgc2NyaXB0LmFzeW5jID0gMTtcbiAgICAgIH1cblxuICAgICAgdmFyIGNhbGxPYnNlcnZlckZ1bmNBbmRSZW1vdmVPYnNlcnZlciA9IGZ1bmN0aW9uIGNhbGxPYnNlcnZlckZ1bmNBbmRSZW1vdmVPYnNlcnZlcihzaG91bGRSZW1vdmVPYnNlcnZlcikge1xuICAgICAgICB2YXIgb2JzZXJ2ZXJzID0gX3RoaXMyLmNvbnN0cnVjdG9yLnNjcmlwdE9ic2VydmVyc1t1cmxdO1xuICAgICAgICBPYmplY3Qua2V5cyhvYnNlcnZlcnMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIGlmIChzaG91bGRSZW1vdmVPYnNlcnZlcihvYnNlcnZlcnNba2V5XSkpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBfdGhpczIuY29uc3RydWN0b3Iuc2NyaXB0T2JzZXJ2ZXJzW3VybF1bX3RoaXMyLnNjcmlwdExvYWRlcklkXTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIHNjcmlwdC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMi5jb25zdHJ1Y3Rvci5sb2FkZWRTY3JpcHRzW3VybF0gPSB0cnVlO1xuICAgICAgICBjYWxsT2JzZXJ2ZXJGdW5jQW5kUmVtb3ZlT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgb2JzZXJ2ZXIub25Mb2FkKCk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgc2NyaXB0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMi5jb25zdHJ1Y3Rvci5lcnJvcmVkU2NyaXB0c1t1cmxdID0gdHJ1ZTtcbiAgICAgICAgY2FsbE9ic2VydmVyRnVuY0FuZFJlbW92ZU9ic2VydmVyKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgIG9ic2VydmVyLm9uRXJyb3IoKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAncmVuZGVyJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFNjcmlwdDtcbn0oX3JlYWN0Mi5kZWZhdWx0LkNvbXBvbmVudCk7XG5cblNjcmlwdC5wcm9wVHlwZXMgPSB7XG4gIGF0dHJpYnV0ZXM6IF9wcm9wVHlwZXMuUHJvcFR5cGVzLm9iamVjdCwgLy8gZXNsaW50LWRpc2FibGUtbGluZSByZWFjdC9mb3JiaWQtcHJvcC10eXBlc1xuICBvbkNyZWF0ZTogX3Byb3BUeXBlcy5Qcm9wVHlwZXMuZnVuYyxcbiAgb25FcnJvcjogX3Byb3BUeXBlcy5Qcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICBvbkxvYWQ6IF9wcm9wVHlwZXMuUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgdXJsOiBfcHJvcFR5cGVzLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxufTtcblNjcmlwdC5kZWZhdWx0UHJvcHMgPSB7XG4gIGF0dHJpYnV0ZXM6IHt9LFxuICBvbkNyZWF0ZTogZnVuY3Rpb24gb25DcmVhdGUoKSB7fSxcbiAgb25FcnJvcjogZnVuY3Rpb24gb25FcnJvcigpIHt9LFxuICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZCgpIHt9IH07XG5TY3JpcHQuc2NyaXB0T2JzZXJ2ZXJzID0ge307XG5TY3JpcHQubG9hZGVkU2NyaXB0cyA9IHt9O1xuU2NyaXB0LmVycm9yZWRTY3JpcHRzID0ge307XG5TY3JpcHQuaWRDb3VudCA9IDA7XG5leHBvcnRzLmRlZmF1bHQgPSBTY3JpcHQ7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSksXG4vKiA1ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDEzLXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuaWYgKGZhbHNlKSB7XG4gIHZhciBSRUFDVF9FTEVNRU5UX1RZUEUgPSAodHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgIFN5bWJvbC5mb3IgJiZcbiAgICBTeW1ib2wuZm9yKCdyZWFjdC5lbGVtZW50JykpIHx8XG4gICAgMHhlYWM3O1xuXG4gIHZhciBpc1ZhbGlkRWxlbWVudCA9IGZ1bmN0aW9uKG9iamVjdCkge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JyAmJlxuICAgICAgb2JqZWN0ICE9PSBudWxsICYmXG4gICAgICBvYmplY3QuJCR0eXBlb2YgPT09IFJFQUNUX0VMRU1FTlRfVFlQRTtcbiAgfTtcblxuICAvLyBCeSBleHBsaWNpdGx5IHVzaW5nIGBwcm9wLXR5cGVzYCB5b3UgYXJlIG9wdGluZyBpbnRvIG5ldyBkZXZlbG9wbWVudCBiZWhhdmlvci5cbiAgLy8gaHR0cDovL2ZiLm1lL3Byb3AtdHlwZXMtaW4tcHJvZFxuICB2YXIgdGhyb3dPbkRpcmVjdEFjY2VzcyA9IHRydWU7XG4gIG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9mYWN0b3J5V2l0aFR5cGVDaGVja2VycycpKGlzVmFsaWRFbGVtZW50LCB0aHJvd09uRGlyZWN0QWNjZXNzKTtcbn0gZWxzZSB7XG4gIC8vIEJ5IGV4cGxpY2l0bHkgdXNpbmcgYHByb3AtdHlwZXNgIHlvdSBhcmUgb3B0aW5nIGludG8gbmV3IHByb2R1Y3Rpb24gYmVoYXZpb3IuXG4gIC8vIGh0dHA6Ly9mYi5tZS9wcm9wLXR5cGVzLWluLXByb2RcbiAgbW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpKCk7XG59XG5cblxuLyoqKi8gfSksXG4vKiA2ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTMtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG5cblxudmFyIGVtcHR5RnVuY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpO1xudmFyIGludmFyaWFudCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG52YXIgUmVhY3RQcm9wVHlwZXNTZWNyZXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiBzaGltKHByb3BzLCBwcm9wTmFtZSwgY29tcG9uZW50TmFtZSwgbG9jYXRpb24sIHByb3BGdWxsTmFtZSwgc2VjcmV0KSB7XG4gICAgaWYgKHNlY3JldCA9PT0gUmVhY3RQcm9wVHlwZXNTZWNyZXQpIHtcbiAgICAgIC8vIEl0IGlzIHN0aWxsIHNhZmUgd2hlbiBjYWxsZWQgZnJvbSBSZWFjdC5cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaW52YXJpYW50KFxuICAgICAgZmFsc2UsXG4gICAgICAnQ2FsbGluZyBQcm9wVHlwZXMgdmFsaWRhdG9ycyBkaXJlY3RseSBpcyBub3Qgc3VwcG9ydGVkIGJ5IHRoZSBgcHJvcC10eXBlc2AgcGFja2FnZS4gJyArXG4gICAgICAnVXNlIFByb3BUeXBlcy5jaGVja1Byb3BUeXBlcygpIHRvIGNhbGwgdGhlbS4gJyArXG4gICAgICAnUmVhZCBtb3JlIGF0IGh0dHA6Ly9mYi5tZS91c2UtY2hlY2stcHJvcC10eXBlcydcbiAgICApO1xuICB9O1xuICBzaGltLmlzUmVxdWlyZWQgPSBzaGltO1xuICBmdW5jdGlvbiBnZXRTaGltKCkge1xuICAgIHJldHVybiBzaGltO1xuICB9O1xuICAvLyBJbXBvcnRhbnQhXG4gIC8vIEtlZXAgdGhpcyBsaXN0IGluIHN5bmMgd2l0aCBwcm9kdWN0aW9uIHZlcnNpb24gaW4gYC4vZmFjdG9yeVdpdGhUeXBlQ2hlY2tlcnMuanNgLlxuICB2YXIgUmVhY3RQcm9wVHlwZXMgPSB7XG4gICAgYXJyYXk6IHNoaW0sXG4gICAgYm9vbDogc2hpbSxcbiAgICBmdW5jOiBzaGltLFxuICAgIG51bWJlcjogc2hpbSxcbiAgICBvYmplY3Q6IHNoaW0sXG4gICAgc3RyaW5nOiBzaGltLFxuICAgIHN5bWJvbDogc2hpbSxcblxuICAgIGFueTogc2hpbSxcbiAgICBhcnJheU9mOiBnZXRTaGltLFxuICAgIGVsZW1lbnQ6IHNoaW0sXG4gICAgaW5zdGFuY2VPZjogZ2V0U2hpbSxcbiAgICBub2RlOiBzaGltLFxuICAgIG9iamVjdE9mOiBnZXRTaGltLFxuICAgIG9uZU9mOiBnZXRTaGltLFxuICAgIG9uZU9mVHlwZTogZ2V0U2hpbSxcbiAgICBzaGFwZTogZ2V0U2hpbSxcbiAgICBleGFjdDogZ2V0U2hpbVxuICB9O1xuXG4gIFJlYWN0UHJvcFR5cGVzLmNoZWNrUHJvcFR5cGVzID0gZW1wdHlGdW5jdGlvbjtcbiAgUmVhY3RQcm9wVHlwZXMuUHJvcFR5cGVzID0gUmVhY3RQcm9wVHlwZXM7XG5cbiAgcmV0dXJuIFJlYWN0UHJvcFR5cGVzO1xufTtcblxuXG4vKioqLyB9KSxcbi8qIDcgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTMtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBcbiAqL1xuXG5mdW5jdGlvbiBtYWtlRW1wdHlGdW5jdGlvbihhcmcpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gYXJnO1xuICB9O1xufVxuXG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gYWNjZXB0cyBhbmQgZGlzY2FyZHMgaW5wdXRzOyBpdCBoYXMgbm8gc2lkZSBlZmZlY3RzLiBUaGlzIGlzXG4gKiBwcmltYXJpbHkgdXNlZnVsIGlkaW9tYXRpY2FsbHkgZm9yIG92ZXJyaWRhYmxlIGZ1bmN0aW9uIGVuZHBvaW50cyB3aGljaFxuICogYWx3YXlzIG5lZWQgdG8gYmUgY2FsbGFibGUsIHNpbmNlIEpTIGxhY2tzIGEgbnVsbC1jYWxsIGlkaW9tIGFsYSBDb2NvYS5cbiAqL1xudmFyIGVtcHR5RnVuY3Rpb24gPSBmdW5jdGlvbiBlbXB0eUZ1bmN0aW9uKCkge307XG5cbmVtcHR5RnVuY3Rpb24udGhhdFJldHVybnMgPSBtYWtlRW1wdHlGdW5jdGlvbjtcbmVtcHR5RnVuY3Rpb24udGhhdFJldHVybnNGYWxzZSA9IG1ha2VFbXB0eUZ1bmN0aW9uKGZhbHNlKTtcbmVtcHR5RnVuY3Rpb24udGhhdFJldHVybnNUcnVlID0gbWFrZUVtcHR5RnVuY3Rpb24odHJ1ZSk7XG5lbXB0eUZ1bmN0aW9uLnRoYXRSZXR1cm5zTnVsbCA9IG1ha2VFbXB0eUZ1bmN0aW9uKG51bGwpO1xuZW1wdHlGdW5jdGlvbi50aGF0UmV0dXJuc1RoaXMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzO1xufTtcbmVtcHR5RnVuY3Rpb24udGhhdFJldHVybnNBcmd1bWVudCA9IGZ1bmN0aW9uIChhcmcpIHtcbiAgcmV0dXJuIGFyZztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZW1wdHlGdW5jdGlvbjtcblxuLyoqKi8gfSksXG4vKiA4ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTMtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKi9cblxuXG5cbi8qKlxuICogVXNlIGludmFyaWFudCgpIHRvIGFzc2VydCBzdGF0ZSB3aGljaCB5b3VyIHByb2dyYW0gYXNzdW1lcyB0byBiZSB0cnVlLlxuICpcbiAqIFByb3ZpZGUgc3ByaW50Zi1zdHlsZSBmb3JtYXQgKG9ubHkgJXMgaXMgc3VwcG9ydGVkKSBhbmQgYXJndW1lbnRzXG4gKiB0byBwcm92aWRlIGluZm9ybWF0aW9uIGFib3V0IHdoYXQgYnJva2UgYW5kIHdoYXQgeW91IHdlcmVcbiAqIGV4cGVjdGluZy5cbiAqXG4gKiBUaGUgaW52YXJpYW50IG1lc3NhZ2Ugd2lsbCBiZSBzdHJpcHBlZCBpbiBwcm9kdWN0aW9uLCBidXQgdGhlIGludmFyaWFudFxuICogd2lsbCByZW1haW4gdG8gZW5zdXJlIGxvZ2ljIGRvZXMgbm90IGRpZmZlciBpbiBwcm9kdWN0aW9uLlxuICovXG5cbnZhciB2YWxpZGF0ZUZvcm1hdCA9IGZ1bmN0aW9uIHZhbGlkYXRlRm9ybWF0KGZvcm1hdCkge307XG5cbmlmIChmYWxzZSkge1xuICB2YWxpZGF0ZUZvcm1hdCA9IGZ1bmN0aW9uIHZhbGlkYXRlRm9ybWF0KGZvcm1hdCkge1xuICAgIGlmIChmb3JtYXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbnZhcmlhbnQgcmVxdWlyZXMgYW4gZXJyb3IgbWVzc2FnZSBhcmd1bWVudCcpO1xuICAgIH1cbiAgfTtcbn1cblxuZnVuY3Rpb24gaW52YXJpYW50KGNvbmRpdGlvbiwgZm9ybWF0LCBhLCBiLCBjLCBkLCBlLCBmKSB7XG4gIHZhbGlkYXRlRm9ybWF0KGZvcm1hdCk7XG5cbiAgaWYgKCFjb25kaXRpb24pIHtcbiAgICB2YXIgZXJyb3I7XG4gICAgaWYgKGZvcm1hdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBlcnJvciA9IG5ldyBFcnJvcignTWluaWZpZWQgZXhjZXB0aW9uIG9jY3VycmVkOyB1c2UgdGhlIG5vbi1taW5pZmllZCBkZXYgZW52aXJvbm1lbnQgJyArICdmb3IgdGhlIGZ1bGwgZXJyb3IgbWVzc2FnZSBhbmQgYWRkaXRpb25hbCBoZWxwZnVsIHdhcm5pbmdzLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgYXJncyA9IFthLCBiLCBjLCBkLCBlLCBmXTtcbiAgICAgIHZhciBhcmdJbmRleCA9IDA7XG4gICAgICBlcnJvciA9IG5ldyBFcnJvcihmb3JtYXQucmVwbGFjZSgvJXMvZywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gYXJnc1thcmdJbmRleCsrXTtcbiAgICAgIH0pKTtcbiAgICAgIGVycm9yLm5hbWUgPSAnSW52YXJpYW50IFZpb2xhdGlvbic7XG4gICAgfVxuXG4gICAgZXJyb3IuZnJhbWVzVG9Qb3AgPSAxOyAvLyB3ZSBkb24ndCBjYXJlIGFib3V0IGludmFyaWFudCdzIG93biBmcmFtZVxuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaW52YXJpYW50O1xuXG4vKioqLyB9KSxcbi8qIDkgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENvcHlyaWdodCAoYykgMjAxMy1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cblxuXG52YXIgUmVhY3RQcm9wVHlwZXNTZWNyZXQgPSAnU0VDUkVUX0RPX05PVF9QQVNTX1RISVNfT1JfWU9VX1dJTExfQkVfRklSRUQnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0UHJvcFR5cGVzU2VjcmV0O1xuXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gR29vZ2xlQ2hhcnRzLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgNDJkMmI4ZTI2YjllMmQwYThlNzAiLCJtb2R1bGUuZXhwb3J0cyA9IFJlYWN0O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiUmVhY3RcIlxuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJleHBvcnQgKiBmcm9tICcuL0dvb2dsZUNoYXJ0JztcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC50c3giLCJkZWNsYXJlIHZhciBtYW55d2hvOiBhbnk7XHJcbi8vZGVjbGFyZSB2YXIgZ29vZ2xlOmFueTtcclxuXHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IENoYXJ0IGZyb20gJ3JlYWN0LWdvb2dsZS1jaGFydHMnO1xyXG5cclxuXHJcbmNsYXNzIEdvb2dsZUNoYXJ0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PGFueSwgYW55PiBcclxue1xyXG5cclxuICAgIG91dGNvbWVzIDogYW55O1xyXG4gICAgXHJcbiAgICBvblNlYXJjaENoYW5nZWQoZSA6IGFueSkgXHJcbiAgICB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuaXNEZXNpZ25UaW1lKSAgcmV0dXJuO1xyXG5cclxuICAgICAgICBtYW55d2hvLnN0YXRlLnNldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB7IHNlYXJjaDogZS50YXJnZXQudmFsdWUgfSwgdGhpcy5wcm9wcy5mbG93S2V5LCB0cnVlKTtcclxuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TZWFyY2hFbnRlcihlIDogYW55KSBcclxuICAgIHtcclxuICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzICYmICF0aGlzLnByb3BzLmlzRGVzaWduVGltZSkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZWFyY2goKSBcclxuICAgIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUpIHJldHVybjtcclxuXHJcbiAgICAgICAgdmFyIG1vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICB2YXIgc3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG5cclxuICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XHJcblxyXG4gICAgICAgIGlmIChtb2RlbC5vYmplY3REYXRhUmVxdWVzdCkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBtYW55d2hvLmVuZ2luZS5vYmplY3REYXRhUmVxdWVzdCh0aGlzLnByb3BzLmlkLCBtb2RlbC5vYmplY3REYXRhUmVxdWVzdCwgdGhpcy5wcm9wcy5mbG93S2V5LCBtYW55d2hvLnNldHRpbmdzLmdsb2JhbCgncGFnaW5nLnRhYmxlJyksIHN0YXRlLnNlYXJjaCwgbnVsbCwgbnVsbCwgc3RhdGUucGFnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgZGlzcGxheUNvbHVtbnMgPSAobWFueXdoby5jb21wb25lbnQuZ2V0RGlzcGxheUNvbHVtbnMobW9kZWwuY29sdW1ucykgfHwgW10pLm1hcChmdW5jdGlvbihjb2x1bW4gOiBhbnkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb2x1bW4udHlwZUVsZW1lbnRQcm9wZXJ0eUlkLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICBvYmplY3REYXRhOiBtb2RlbC5vYmplY3REYXRhLmZpbHRlcihmdW5jdGlvbihvYmplY3REYXRhIDogYW55KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmplY3REYXRhLnByb3BlcnRpZXMuZmlsdGVyKGZ1bmN0aW9uKHByb3BlcnR5IDogYW55KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGlzcGxheUNvbHVtbnMuaW5kZXhPZihwcm9wZXJ0eS50eXBlRWxlbWVudFByb3BlcnR5SWQpICE9IC0xICYmIHByb3BlcnR5LmNvbnRlbnRWYWx1ZS50b0xvd2VyQ2FzZSgpLmluZGV4T2Yoc3RhdGUuc2VhcmNoLnRvTG93ZXJDYXNlKCkpICE9IC0xXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmxlbmd0aCA+IDBcclxuXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHN0YXRlLnBhZ2UgPSAxO1xyXG4gICAgICAgICAgICBtYW55d2hvLnN0YXRlLnNldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCBzdGF0ZSwgdGhpcy5wcm9wcy5mbG93S2V5LCB0cnVlKTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlZnJlc2goKSBcclxuICAgIHtcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUpIHJldHVybjtcclxuXHJcbiAgICAgICAgbWFueXdoby5zdGF0ZS5zZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgeyBzZWFyY2g6ICcnIH0sIHRoaXMucHJvcHMuZmxvd0tleSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2VhcmNoKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyU2VsZWN0aW9uKCkgXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNlbGVjdGVkUm93czogW10gfSk7XHJcbiAgICAgICAgbWFueXdoby5zdGF0ZS5zZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgeyBvYmplY3REYXRhOiBbXSB9LCB0aGlzLnByb3BzLmZsb3dLZXksIHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uUm93Q2xpY2tlZChlIDogYW55KSBcclxuICAgIHtcclxuICAgICAgICB2YXIgc2VsZWN0ZWRSb3dzID0gdGhpcy5zdGF0ZS5zZWxlY3RlZFJvd3M7XHJcblxyXG4gICAgICAgIHZhciBtb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHRoaXMucHJvcHMuZmxvd0tleSk7XHJcblxyXG4gICAgICAgIGlmIChzZWxlY3RlZFJvd3MuaW5kZXhPZihlLmN1cnJlbnRUYXJnZXQuaWQpID09IC0xKSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1vZGVsLmlzTXVsdGlTZWxlY3QgPyBzZWxlY3RlZFJvd3MucHVzaChlLmN1cnJlbnRUYXJnZXQuaWQpIDogc2VsZWN0ZWRSb3dzID0gW2UuY3VycmVudFRhcmdldC5pZF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzZWxlY3RlZFJvd3Muc3BsaWNlKHNlbGVjdGVkUm93cy5pbmRleE9mKGUuY3VycmVudFRhcmdldC5pZCksIDEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNlbGVjdGVkUm93czogc2VsZWN0ZWRSb3dzIH0pO1xyXG4gICAgICAgIG1hbnl3aG8uc3RhdGUuc2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHsgb2JqZWN0RGF0YTogbWFueXdoby5jb21wb25lbnQuZ2V0U2VsZWN0ZWRSb3dzKG1vZGVsLCBzZWxlY3RlZFJvd3MpIH0sIHRoaXMucHJvcHMuZmxvd0tleSwgdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25PdXRjb21lKG9iamVjdERhdGFJZCA6IGFueSwgb3V0Y29tZUlkIDogYW55KSBcclxuICAgIHtcclxuXHJcbiAgICAgICAgdmFyIG1vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICBtYW55d2hvLnN0YXRlLnNldENvbXBvbmVudChtb2RlbC5pZCwgeyBvYmplY3REYXRhOiBtYW55d2hvLmNvbXBvbmVudC5nZXRTZWxlY3RlZFJvd3MobW9kZWwsIFtvYmplY3REYXRhSWRdKSB9LCB0aGlzLnByb3BzLmZsb3dLZXksIHRydWUpO1xyXG5cclxuICAgICAgICB2YXIgZmxvd0tleSA9IHRoaXMucHJvcHMuZmxvd0tleTtcclxuICAgICAgICB2YXIgb3V0Y29tZSA9IG1hbnl3aG8ubW9kZWwuZ2V0T3V0Y29tZShvdXRjb21lSWQsIHRoaXMucHJvcHMuZmxvd0tleSk7XHJcbiAgICAgICAgbWFueXdoby5lbmdpbmUubW92ZShvdXRjb21lLCB0aGlzLnByb3BzLmZsb3dLZXkpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChvdXRjb21lLmlzT3V0KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG1hbnl3aG8uZW5naW5lLmZsb3dPdXQob3V0Y29tZSwgZmxvd0tleSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25OZXh0KCkgXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIG1vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICB2YXIgc3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG5cclxuICAgICAgICBpZiAoIXN0YXRlLnBhZ2UpIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc3RhdGUucGFnZSA9IDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzdGF0ZS5wYWdlKys7XHJcbiAgICAgICAgbWFueXdoby5zdGF0ZS5zZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgc3RhdGUsIHRoaXMucHJvcHMuZmxvd0tleSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIGlmIChtb2RlbC5vYmplY3REYXRhUmVxdWVzdCB8fCBtb2RlbC5maWxlRGF0YVJlcXVlc3QpXHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoKCk7XHJcbiAgICAgICAgZWxzZSBpZiAobW9kZWwuYXR0cmlidXRlcy5wYWdpbmF0aW9uICYmIG1hbnl3aG8udXRpbHMuaXNFcXVhbChtb2RlbC5hdHRyaWJ1dGVzLnBhZ2luYXRpb24sICd0cnVlJywgdHJ1ZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25QcmV2KCkgXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIG1vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICB2YXIgc3RhdGUgPSBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgIHN0YXRlLnBhZ2UtLTtcclxuXHJcbiAgICAgICAgbWFueXdoby5zdGF0ZS5zZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgc3RhdGUsIHRoaXMucHJvcHMuZmxvd0tleSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIGlmIChtb2RlbC5vYmplY3REYXRhUmVxdWVzdCB8fCBtb2RlbC5maWxlRGF0YVJlcXVlc3QpXHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoKCk7XHJcbiAgICAgICAgZWxzZSBpZiAobW9kZWwuYXR0cmlidXRlcy5wYWdpbmF0aW9uICYmIG1hbnl3aG8udXRpbHMuaXNFcXVhbChtb2RlbC5hdHRyaWJ1dGVzLnBhZ2luYXRpb24sICd0cnVlJywgdHJ1ZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbFN0YXRlKCkgXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIHJldCA6IGFueSA9IHt9O1xyXG4gICAgICAgIHJldC5zZWxlY3RlZFJvd3MgPSBbXTtcclxuICAgICAgICByZXQud2luZG93V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCxcclxuICAgICAgICByZXQuc29ydEJ5T3JkZXIgPSAnQVNDJyxcclxuICAgICAgICByZXQubGFzdE9yZGVyQnkgPSAnJyxcclxuICAgICAgICByZXQub2JqZWN0RGF0YSA9IG51bGxcclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcyA6IGFueSlcclxuICAgIHtcclxuICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgXHJcblxyXG4gICAgY29tcG9uZW50V2lsbE1vdW50KCkgXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIG1vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICBpZiAoIW1vZGVsLm9iamVjdERhdGFSZXF1ZXN0KSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBvYmplY3REYXRhOiBtb2RlbC5vYmplY3REYXRhIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb21wb25lbnREaWRNb3VudCgpIFxyXG4gICAge1xyXG5cclxuICAgICAgICBcclxuXHJcbiAgICB9XHJcblxyXG4gICAgXHJcblxyXG4gICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMgOiBhbnkpIFxyXG4gICAge1xyXG4gICAgICAgIHZhciBtb2RlbCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KG5leHRQcm9wcy5pZCwgbmV4dFByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgIHZhciBzdGF0ZSA9IHRoaXMucHJvcHMuaXNEZXNpZ25UaW1lID8geyBlcnJvcjogbnVsbCwgbG9hZGluZzogZmFsc2UgfSA6IG1hbnl3aG8uc3RhdGUuZ2V0Q29tcG9uZW50KHRoaXMucHJvcHMuaWQsIHRoaXMucHJvcHMuZmxvd0tleSkgfHwge307XHJcblxyXG4gICAgICAgIGlmICghbW9kZWwub2JqZWN0RGF0YVJlcXVlc3QgJiYgIW1vZGVsLmZpbGVEYXRhUmVxdWVzdCAmJiBtYW55d2hvLnV0aWxzLmlzTnVsbE9yV2hpdGVzcGFjZShzdGF0ZS5zZWFyY2gpICYmIChtYW55d2hvLnV0aWxzLmlzTnVsbE9yV2hpdGVzcGFjZShzdGF0ZS5wYWdlKSB8fCBzdGF0ZS5wYWdlID09IDEpKSB7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgb2JqZWN0RGF0YTogbW9kZWwub2JqZWN0RGF0YSB9KTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIFxyXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSBcclxuICAgIHtcclxuICAgIH1cclxuXHJcbiAgIFxyXG4gICAgXHJcbiAgICByZW5kZXIoKVxyXG4gICAge1xyXG4gICAgICAgIG1hbnl3aG8ubG9nLmluZm8oJ1JlbmRlcmluZyBHb29nbGUgQ2hhcnQ6ICcgKyB0aGlzLnByb3BzLmlkKTtcclxuXHJcbiAgICAgICAgdmFyIG1vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgdGhpcy5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLnByb3BzLmlzRGVzaWduVGltZSA/IHsgZXJyb3I6IG51bGwsIGxvYWRpbmc6IGZhbHNlIH0gOiBtYW55d2hvLnN0YXRlLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpIHx8IHt9O1xyXG5cclxuICAgICAgICB0aGlzLm91dGNvbWVzID0gbWFueXdoby5tb2RlbC5nZXRPdXRjb21lcyh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG5cclxuICAgICAgICB2YXIgb2JqZWN0RGF0YSA9IHRoaXMucHJvcHMuaXNEZXNpZ25UaW1lID8gW10gOiBtb2RlbC5vYmplY3REYXRhO1xyXG5cclxuICAgICAgICBpZiAobW9kZWwub2JqZWN0RGF0YSAmJiBzdGF0ZS5vYmplY3REYXRhICYmICF0aGlzLnN0YXRlLm9iamVjdERhdGEpIHtcclxuXHJcbiAgICAgICAgICAgIG9iamVjdERhdGEgPSBtb2RlbC5vYmplY3REYXRhLm1hcChmdW5jdGlvbiAobW9kZWxJdGVtIDogYW55KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlT2JqZWN0RGF0YSA9IHN0YXRlLm9iamVjdERhdGEuZmlsdGVyKGZ1bmN0aW9uIChzdGF0ZUl0ZW0gOiBhbnkpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hbnl3aG8udXRpbHMuaXNFcXVhbChtb2RlbEl0ZW0uZXh0ZXJuYWxJZCwgc3RhdGVJdGVtLmV4dGVybmFsSWQpICYmIG1hbnl3aG8udXRpbHMuaXNFcXVhbChtb2RlbEl0ZW0uaW50ZXJuYWxJZCwgc3RhdGVJdGVtLmludGVybmFsSWQpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0pWzBdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzdGF0ZU9iamVjdERhdGEpIFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtYW55d2hvLnV0aWxzLmV4dGVuZCh7fSwgW21vZGVsSXRlbSwgc3RhdGVPYmplY3REYXRhXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2RlbEl0ZW07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBkaXNwbGF5Q29sdW1ucyA9ICh0aGlzLnByb3BzLmlzRGVzaWduVGltZSkgPyBbXSA6IHRoaXMuZ2V0RGlzcGxheUNvbHVtbnMobW9kZWwuY29sdW1ucywgdGhpcy5vdXRjb21lcyk7XHJcbiAgICAgICAgdmFyIGhhc01vcmVSZXN1bHRzID0gKG1vZGVsLm9iamVjdERhdGFSZXF1ZXN0ICYmIG1vZGVsLm9iamVjdERhdGFSZXF1ZXN0Lmhhc01vcmVSZXN1bHRzKSB8fCAobW9kZWwuZmlsZURhdGFSZXF1ZXN0ICYmIG1vZGVsLmZpbGVEYXRhUmVxdWVzdC5oYXNNb3JlUmVzdWx0cyk7XHJcbiAgICAgICAgdmFyIGNvbnRlbnQgPSBudWxsO1xyXG4gICAgICAgIHZhciByb3dPdXRjb21lcyA9IHRoaXMub3V0Y29tZXMuZmlsdGVyKGZ1bmN0aW9uIChvdXRjb21lIDogYW55KSB7IHJldHVybiAhb3V0Y29tZS5pc0J1bGtBY3Rpb24gfSk7XHJcbiAgICAgICAgdmFyIGhlYWRlck91dGNvbWVzID0gdGhpcy5vdXRjb21lcy5maWx0ZXIoZnVuY3Rpb24gKG91dGNvbWUgOiBhbnkpIHsgcmV0dXJuIG91dGNvbWUuaXNCdWxrQWN0aW9uIH0pO1xyXG5cclxuICAgICAgICBpZiAoc3RhdGUub2JqZWN0RGF0YSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG9iamVjdERhdGEgPSBzdGF0ZS5vYmplY3REYXRhO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHN0YXRlLmVycm9yKSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQgPSAgIDxkaXYgY2xhc3NOYW1lPSAndGFibGUtZXJyb3InPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSdsZWFkJz5zdGF0ZS5lcnJvci5tZXNzYWdlPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9J2J0biBidG4tZGFuZ2VyJyBvbkNsaWNrPXt0aGlzLnNlYXJjaH0+UmV0cnk8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkaXNwbGF5Q29sdW1ucy5sZW5ndGggPT0gMCkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjb250ZW50ID0gICA8ZGl2IGNsYXNzTmFtZT0gJ3RhYmxlLWVycm9yJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0nbGVhZCc+J05vIGRpc3BsYXkgY29sdW1ucyBoYXZlIGJlZW4gZGVmaW5lZCBmb3IgdGhpcyB0YWJsZSc8L3A+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQgPSB0aGlzLnJlbmRlckNoYXJ0KG9iamVjdERhdGEgfHwgW10sIHJvd091dGNvbWVzLCBkaXNwbGF5Q29sdW1ucyk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGNsYXNzTmFtZXMgOiBhbnkgPSBbXTtcclxuXHJcbiAgICAgICAgaWYgKG1vZGVsLmlzVmlzaWJsZSA9PSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWVzLnB1c2goJ2hpZGRlbicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjbGFzc05hbWVzID0gY2xhc3NOYW1lcy5jb25jYXQobWFueXdoby5zdHlsaW5nLmdldENsYXNzZXModGhpcy5wcm9wcy5wYXJlbnRJZCwgdGhpcy5wcm9wcy5pZCwgXCJnb29nbGUtY2hhcnRcIiwgdGhpcy5wcm9wcy5mbG93S2V5KSk7XHJcblxyXG4gICAgICAgICAgICBpZiAobW9kZWwuYXR0cmlidXRlcyAmJiBtb2RlbC5hdHRyaWJ1dGVzLmNsYXNzZXMpIFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWVzID0gY2xhc3NOYW1lcy5qb2luKCcgJykgKyAnICcgKyBtb2RlbC5hdHRyaWJ1dGVzLmNsYXNzZXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lcyA9IGNsYXNzTmFtZXMuam9pbignICcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgdmFsaWRhdGlvbkVsZW1lbnQgOiBhbnk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbW9kZWwuaXNWYWxpZCAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kZWwuaXNWYWxpZCA9PSBmYWxzZSkgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhbGlkYXRpb25FbGVtZW50ID0gPGRpdiBjbGFzc05hbWU9ICdoYXMtZXJyb3InPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSAnaGVscC1ibG9jaycgPnttb2RlbC52YWxpZGF0aW9uTWVzc2FnZX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobW9kZWwuaXNWaXNpYmxlID09IGZhbHNlKSBcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lcyArPSAnIGhpZGRlbic7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBjb250ZW50SXRlbXMgOiBhbnkgPSBbXTtcclxuICAgICAgICAgICAgY29udGVudEl0ZW1zLnB1c2godGhpcy5yZW5kZXJIZWFkZXIoc3RhdGUuc2VhcmNoLCBoZWFkZXJPdXRjb21lcywgdGhpcy5wcm9wcy5mbG93S2V5LCBtb2RlbC5pc1NlYXJjaGFibGUsIHRoaXMub25TZWFyY2hDaGFuZ2VkLCB0aGlzLm9uU2VhcmNoRW50ZXIsIHRoaXMuc2VhcmNoLCAobW9kZWwub2JqZWN0RGF0YVJlcXVlc3QgfHwgbW9kZWwuZmlsZURhdGFSZXF1ZXN0KSwgdGhpcy5yZWZyZXNoLCB0aGlzLnByb3BzLmlzRGVzaWduVGltZSwgbW9kZWwpKTtcclxuICAgICAgICAgICAgY29udGVudEl0ZW1zLnB1c2goY29udGVudCk7XHJcbiAgICAgICAgICAgIGNvbnRlbnRJdGVtcy5wdXNoKHRoaXMucmVuZGVyRm9vdGVyKHN0YXRlLnBhZ2UgfHwgMSwgaGFzTW9yZVJlc3VsdHMsIHRoaXMub25OZXh0LCB0aGlzLm9uUHJldiwgdGhpcy5wcm9wcy5pc0Rlc2lnblRpbWUpKTtcclxuICAgICAgICAgICAgY29udGVudEl0ZW1zLnB1c2godGhpcy5yZW5kZXJXYWl0KCkpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHJldHVybiAgPGRpdiBjbGFzc05hbWU9e2NsYXNzTmFtZXN9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ncGFuZWwgcGFuZWwtZGVmYXVsdCc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ncGFuZWwtaGVhZGluZyc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J3BhbmVsLWJvZHknPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NvbnRlbnRJdGVtc31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHBhcnNlQm9vbGVhbih2YWx1ZSA6IGFueSkgXHJcbiAgICB7XHJcbiAgICAgICAgaWYgKHZhbHVlID09IHRydWUgfHwgdmFsdWUgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHZhbHVlICE9IG51bGwgJiZcclxuICAgICAgICAgICAgdmFsdWUudG9Mb3dlckNhc2UoKSA9PSAndHJ1ZScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgY29udmVydFRvR29vZ2xlVHlwZShjb250ZW50VHlwZSA6IHN0cmluZykgXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGdvb2dsZVR5cGUgPSAnc3RyaW5nJztcclxuXHJcbiAgICAgICAgaWYgKGNvbnRlbnRUeXBlICE9IG51bGwpIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY29udGVudFR5cGUgPSBjb250ZW50VHlwZS50b1VwcGVyQ2FzZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvbnRlbnRUeXBlID09IG1hbnl3aG8uY29tcG9uZW50LmNvbnRlbnRUeXBlcy5udW1iZXIpIFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBnb29nbGVUeXBlID0gJ251bWJlcic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGdvb2dsZVR5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzcGxheUNvbHVtbnMoY29sdW1ucyA6IGFueSwgb3V0Y29tZXMgOiBhbnkpIFxyXG4gICAge1xyXG4gICAgICAgIHZhciBkaXNwbGF5Q29sdW1ucyA9IG1hbnl3aG8uY29tcG9uZW50LmdldERpc3BsYXlDb2x1bW5zKGNvbHVtbnMpIHx8IFtdO1xyXG5cclxuICAgICAgICBpZiAob3V0Y29tZXMuZmlsdGVyKGZ1bmN0aW9uIChvdXRjb21lICA6YW55KSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiAhb3V0Y29tZS5pc0J1bGtBY3Rpb247XHJcbiAgICAgICAgfSkubGVuZ3RoID4gMCkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBkaXNwbGF5Q29sdW1ucy51bnNoaWZ0KCdtdy1vdXRjb21lcycpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlDb2x1bW5zO1xyXG4gICAgfVxyXG5cclxuICAgIGFyZUJ1bGtBY3Rpb25zRGVmaW5lZChvdXRjb21lcyA6IGFueSkgXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIG91dGNvbWVzLmZpbHRlcihmdW5jdGlvbiAob3V0Y29tZSA6IGFueSkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gb3V0Y29tZS5pc0J1bGtBY3Rpb247XHJcbiAgICAgICAgfSkubGVuZ3RoICE9IDBcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJIZWFkZXIoc2VhcmNoVmFsdWUgOiBhbnksIG91dGNvbWVzIDogYW55LCBmbG93S2V5IDogc3RyaW5nLCBpc1NlYXJjaEVuYWJsZWQgOiBib29sZWFuLCBvblNlYXJjaENoYW5nZWQgOiBhbnksIFxyXG4gICAgICAgICAgICBvblNlYXJjaEVudGVyZWQgOiBhbnksIHNlYXJjaCA6IGFueSwgaXNPYmplY3REYXRhIDogYW55LCByZWZyZXNoIDogYW55LCBpc0Rlc2lnblRpbWUgOiBhbnksIG1vZGVsIDogYW55KVxyXG4gICAgIHtcclxuICAgICAgICB2YXIgbG9va1VwS2V5ID0gbWFueXdoby51dGlscy5nZXRMb29rVXBLZXkoZmxvd0tleSk7XHJcbiAgICAgICAgdmFyIGhlYWRlckVsZW1lbnRzID0gW107XHJcbiAgICAgICAgdmFyIHNlYXJjaEVsZW1lbnQgOiBhbnk7XHJcbiAgICAgICAgdmFyIG91dGNvbWVzRWxlbWVudCA6IGFueTtcclxuICAgICAgICB2YXIgcmVmcmVzaEVsZW1lbnQgOiBhbnk7XHJcbiAgICAgICAgdmFyIG1haW5FbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobG9va1VwS2V5KTtcclxuXHJcbiAgICAgICAgaWYgKChpc09iamVjdERhdGEgJiZcclxuICAgICAgICAgICAgIG1vZGVsLmF0dHJpYnV0ZXMgIT0gbnVsbCAmJlxyXG4gICAgICAgICAgICAgdGhpcy5wYXJzZUJvb2xlYW4obW9kZWwuYXR0cmlidXRlcy5lbmFibGVSZWZyZXNoKSA9PSB0cnVlKSB8fFxyXG4gICAgICAgICAgICAoaXNPYmplY3REYXRhICYmXHJcbiAgICAgICAgICAgICBtb2RlbC5hdHRyaWJ1dGVzID09IG51bGwpKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgcmVmcmVzaERpc2FibGVkID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZiAoaXNEZXNpZ25UaW1lKSByZWZyZXNoRGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgcmVmcmVzaEVsZW1lbnQgPSA8YnV0dG9uIGNsYXNzTmFtZT0nYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCB0YWJsZS1yZWZyZXNoJyBvbkNsaWNrPXtyZWZyZXNofSBkaXNhYmxlZD17cmVmcmVzaERpc2FibGVkfSAgID48c3BhbiBjbGFzc05hbWU9ICdnbHlwaGljb24gZ2x5cGhpY29uLXJlZnJlc2gnPjwvc3Bhbj48L2J1dHRvbj47XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGlzU2VhcmNoRW5hYmxlZCkgXHJcbiAgICAgICAge1xyXG5cclxuICAgICAgICAgICAgdmFyIHNlYXJjaERpc2FibGVkIDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgaWYgKGlzRGVzaWduVGltZSkgc2VhcmNoRGlzYWJsZWQ9dHJ1ZTtcclxuICAgXHJcbiAgICAgICAgICAgIHNlYXJjaEVsZW1lbnQgPSA8ZGl2IGNsYXNzTmFtZT0naW5wdXQtZ3JvdXAgdGFibGUtc2VhcmNoJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0ndGV4dCcgY2xhc3NOYW1lPSdmb3JtLWNvbnRyb2wnIHZhbHVlPXtzZWFyY2hWYWx1ZX0gIHBsYWNlaG9sZGVyPSdTZWFyY2gnIG9uQ2hhbmdlPXtvblNlYXJjaENoYW5nZWR9IG9uS2V5VXA9e29uU2VhcmNoRW50ZXJlZH0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0naW5wdXQtZ3JvdXAtYnRuJz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPSdidG4gYnRuLWRlZmF1bHQnIG9uQ2xpY2s9e3NlYXJjaH0gZGlzYWJsZWQ9e3NlYXJjaERpc2FibGVkfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J2dseXBoaWNvbiBnbHlwaGljb24tc2VhcmNoJz48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaW5wdXQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvdXRjb21lcykgXHJcbiAgICAgICAge1xyXG5cclxuICAgICAgICAgICAgdmFyIG91dGNvbWVFbGVtZW50cyA9IG91dGNvbWVzLm1hcChmdW5jdGlvbiAob3V0Y29tZSA6IGFueSkgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KG1hbnl3aG8uY29tcG9uZW50LmdldEJ5TmFtZSgnb3V0Y29tZScpLCB7IGlkOiBvdXRjb21lLmlkLCBmbG93S2V5OiBmbG93S2V5IH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIG91dGNvbWVzRWxlbWVudCA9ICAgPGRpdiBjbGFzc05hbWU9J3RhYmxlLW91dGNvbWVzJyA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtvdXRjb21lRWxlbWVudHN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobWFpbkVsZW1lbnQgJiYgbWFpbkVsZW1lbnQuY2xpZW50V2lkdGggPCA3NjgpIHtcclxuXHJcbiAgICAgICAgICAgIGhlYWRlckVsZW1lbnRzID0gW291dGNvbWVzRWxlbWVudCwgc2VhcmNoRWxlbWVudCwgcmVmcmVzaEVsZW1lbnRdO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcblxyXG4gICAgICAgICAgICBoZWFkZXJFbGVtZW50cyA9IFtyZWZyZXNoRWxlbWVudCwgc2VhcmNoRWxlbWVudCwgb3V0Y29tZXNFbGVtZW50XTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGVhZGVyRWxlbWVudHMubGVuZ3RoID4gMCkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gIDxkaXYgY2xhc3NOYW1lPSd0YWJsZS1oZWFkZXIgY2xlYXJmaXgnID5cclxuICAgICAgICAgICAgICAgICAgICAgICAge2hlYWRlckVsZW1lbnRzfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyRm9vdGVyKHBhZ2VJbmRleCA6IG51bWJlciwgaGFzTW9yZVJlc3VsdHMgOiBib29sZWFuLCBvbk5leHQgOiBhbnksIG9uUHJldiA6IGFueSwgaXNEZXNpZ25UaW1lIDogYm9vbGVhbikgXHJcbiAgICB7XHJcblxyXG4gICAgICAgIHZhciBmb290ZXJFbGVtZW50cyA9IFtdO1xyXG5cclxuICAgICAgICBpZiAocGFnZUluZGV4ID4gMSB8fCBoYXNNb3JlUmVzdWx0cykge1xyXG5cclxuICAgICAgICAgICAgZm9vdGVyRWxlbWVudHMucHVzaChSZWFjdC5jcmVhdGVFbGVtZW50KG1hbnl3aG8uY29tcG9uZW50LmdldEJ5TmFtZSgncGFnaW5hdGlvbicpLFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VJbmRleDogcGFnZUluZGV4LFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc01vcmVSZXN1bHRzOiBoYXNNb3JlUmVzdWx0cyxcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXJDbGFzc2VzOiAncHVsbC1yaWdodCcsXHJcbiAgICAgICAgICAgICAgICAgICAgb25OZXh0OiBvbk5leHQsXHJcbiAgICAgICAgICAgICAgICAgICAgb25QcmV2OiBvblByZXYsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNEZXNpZ25UaW1lOiBpc0Rlc2lnblRpbWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGZvb3RlckVsZW1lbnRzLmxlbmd0aCA+IDApIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuICA8ZGl2IGNsYXNzTmFtZT0ndGFibGUtZm9vdGVyIGNsZWFyZml4Jz5cclxuICAgICAgICAgICAgICAgICAgICAgICAge2Zvb3RlckVsZW1lbnRzfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckNoYXJ0KG9iamVjdERhdGEgOiBhbnkgLCBvdXRjb21lcyA6IGFueSAsIGRpc3BsYXlDb2x1bW5zIDogYW55KSBcclxuICAgIHtcclxuICAgICAgICB2YXIgbW9kZWwgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpO1xyXG5cclxuICAgICAgICB2YXIgd2lkdGggPSBcIjEwMCVcIjtcclxuICAgICAgICB2YXIgaGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIGRhdGEgPSBbXTtcclxuICAgICAgICAvL2FkZCB0aGUgZGlzcGxheSBjb2x1bW5zXHJcbiAgICAgICAgdmFyIGNvbHVtbnMgPSBbXTtcclxuICAgICAgICBpZiAoZGlzcGxheUNvbHVtbnMgIT0gbnVsbCAmJiAgZGlzcGxheUNvbHVtbnMubGVuZ3RoID4gMCkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRpc3BsYXlDb2x1bW5zLmxlbmd0aDsgaSsrKSBcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY29sdW1ucy5wdXNoKGRpc3BsYXlDb2x1bW5zW2ldLmxhYmVsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBkYXRhLnB1c2goY29sdW1ucyk7XHJcbiAgICAgICBcclxuICAgICAgICBpZiAob2JqZWN0RGF0YSAhPSBudWxsICYmIG9iamVjdERhdGEubGVuZ3RoID4gMCkgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdERhdGEubGVuZ3RoOyBpKyspIFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2JqZWN0RGF0YVtpXS5wcm9wZXJ0aWVzICE9IG51bGwgJiYgb2JqZWN0RGF0YVtpXS5wcm9wZXJ0aWVzLmxlbmd0aCA9PSBjb2x1bW5zLmxlbmd0aCkgXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvdyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL2xvb3Agb3ZlciB0aGUgZGlzcGxheSBjb2x1bW5zIGdldHRpbmcgdGhlIG9iamVjdERhdGEucHJvcGVydHkgZm9yIHRoYXQgaWRcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGRpc3BsYXlDb2x1bW5zLmxlbmd0aDsgaysrKSBcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgb2JqZWN0RGF0YVtpXS5wcm9wZXJ0aWVzLmxlbmd0aDsgaisrKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iamVjdERhdGFbaV0ucHJvcGVydGllc1tqXS50eXBlRWxlbWVudFByb3BlcnR5SWQgPT0gZGlzcGxheUNvbHVtbnNba10udHlwZUVsZW1lbnRQcm9wZXJ0eUlkKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnZlcnRUb0dvb2dsZVR5cGUoZGlzcGxheUNvbHVtbnNba10uY29udGVudFR5cGUpID09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBudW1iZXIgPSBwYXJzZUZsb2F0KG9iamVjdERhdGFbaV0ucHJvcGVydGllc1tqXS5jb250ZW50VmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKG51bWJlcikgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93LnB1c2gobnVtYmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3cucHVzaChvYmplY3REYXRhW2ldLnByb3BlcnRpZXNbal0uY29udGVudFZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2gocm93KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGNoYXJ0VHlwZSA6IGFueTtcclxuXHJcbiAgICAgICAgaWYgKG1vZGVsLmF0dHJpYnV0ZXMpIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIG9wdGlvbnMgOiBhbnkgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIGZvcih2YXIga2V5IGluICBtb2RlbC5hdHRyaWJ1dGVzKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2goa2V5KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjaGFydFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hhcnRUeXBlUmVzdWx0IDogYW55ID0gdGhpcy5jaGFydE5hbWVUb1R5cGUobW9kZWwuYXR0cmlidXRlc1trZXldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnRUeXBlID0gY2hhcnRUeXBlUmVzdWx0Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgb0tleSBpbiBjaGFydFR5cGVSZXN1bHQub3B0aW9ucylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1tvS2V5XSA9IGNoYXJ0VHlwZVJlc3VsdC5vcHRpb25zW29LZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL2V4Y2x1ZGUgdGhlc2VcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY2xhc3Nlc1wiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2RvIG5vdGhpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zW2tleV0gPSBtb2RlbC5hdHRyaWJ1dGVzW2tleV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY2hhcnRUeXBlID0gXCJQaWVDaGFydFwiO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcblxyXG5cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gIDxkaXYgaWQ9eyB0aGlzLnByb3BzLmlkIH0+XHJcbiAgICAgICAgICAgICAgICAgICAgPENoYXJ0IGNoYXJ0VHlwZT17Y2hhcnRUeXBlfSB3aWR0aD17d2lkdGh9IGhlaWdodD17aGVpZ2h0fSBsZWdlbmRUb2dnbGUgZGF0YT17ZGF0YX0gb3B0aW9ucz17b3B0aW9uc30gLz5cclxuICAgICAgICAgICAgICAgIDwvZGl2PjtcclxuICAgIH1cclxuICBcclxuXHJcbiAgICByZW5kZXJXYWl0KClcclxuICAgIHtcclxuICAgICAgICAvL3JldHVybiA8e21hbnl3aG8uY29tcG9uZW50LmdldEJ5TmFtZSgnd2FpdCcpfT5cclxuICAgICAgICAvL1JlYWN0LmNyZWF0ZUVsZW1lbnQobWFueXdoby5jb21wb25lbnQuZ2V0QnlOYW1lKCd3YWl0JyksIHsgaXNWaXNpYmxlOiBzdGF0ZS5sb2FkaW5nLCBtZXNzYWdlOiBzdGF0ZS5sb2FkaW5nICYmIHN0YXRlLmxvYWRpbmcubWVzc2FnZSwgaXNTbWFsbDogdHJ1ZSB9LCBudWxsKVxyXG4gXHJcbiAgIFxyXG4gICAgfVxyXG5cclxuICAgIGNoYXJ0TmFtZVRvVHlwZShuYW1lIDogc3RyaW5nKVxyXG4gICAge1xyXG4gICAgICAgIHZhciByZXN1bHQgOiBhbnkgPSB7bmFtZSA6IFwiXCIsIG9wdGlvbnM6IHt9fTtcclxuICAgICAgICBzd2l0Y2gobmFtZS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY2FzZSAnYW5ub3RhdGlvbic6IHJlc3VsdC5uYW1lID0gXCJBbm5vdGF0aW9uQ2hhcnRcIjsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2FyZWEnOiByZXN1bHQubmFtZSA9ICBcIkFyZWFDaGFydFwiOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnYmFyJzogcmVzdWx0Lm5hbWUgPSAgXCJCYXJDaGFydFwiOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnYnViYmxlJzogcmVzdWx0Lm5hbWUgPSAgXCJCdWJibGVDaGFydFwiOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY2FsZW5kYXInOiByZXN1bHQubmFtZSA9ICBcIkNhbGVuZGFyXCI7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdjYW5kbGVzdGljayc6IHJlc3VsdC5uYW1lID0gIFwiQ2FuZGxlc3RpY2tDaGFydFwiOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY29sdW1uJzogcmVzdWx0Lm5hbWUgPSAgXCJDb2x1bW5DaGFydFwiOyAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2dhbnR0JzogcmVzdWx0Lm5hbWUgPSAgXCJHYW5udFwiOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZ2F1Z2UnOiByZXN1bHQubmFtZSA9ICBcIkdhdWdlXCI7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdnZW8nOiByZXN1bHQubmFtZSA9ICBcIkdlb0NoYXJ0XCI7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdsaW5lJzogcmVzdWx0Lm5hbWUgPSAgXCJMaW5lQ2hhcnRcIjsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ29yZyc6IHJlc3VsdC5uYW1lID0gIFwiT3JnQ2hhcnRcIjsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3BpZSc6IHJlc3VsdC5uYW1lID0gIFwiUGllQ2hhcnRcIjsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3NhbmtleSc6IHJlc3VsdC5uYW1lID0gIFwiU2Fua2V5XCI7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdzY2F0dGVyJzogcmVzdWx0Lm5hbWUgPSAgXCJTY2F0dGVyQ2hhcnRcIjsgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3N0ZXBwZWRhcmVhJzogcmVzdWx0Lm5hbWUgPSAgXCJTdGVwcGVkQXJlYUNoYXJ0XCI7IGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd0YWJsZSc6IHJlc3VsdC5uYW1lID0gXCJUYWJsZVwiOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndGltZWxpbmVzJzogcmVzdWx0Lm5hbWUgPSAgXCJUaW1lTGluZVwiOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndHJlZW1hcCc6IHJlc3VsdC5uYW1lID0gIFwiVHJlZU1hcFwiOyBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndHJlbmQnOiBcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5vcHRpb25zLnRyZW5kbGluZXM9eyAwOiB7fSB9O1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSAgXCJTY2F0dGVyQ2hhcnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd3b3JkdHJlZSc6IFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm9wdGlvbnMud29yZHRyZWU9IHtmb3JtYXQ6ICdpbXBsaWNpdCcsIHdvcmQ6ICdjYXRzJyB9O1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSAgXCJXb3JkVHJlZVwiO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJlc3VsdC5uYW1lID0gIFwiUGllQ2hhcnRcIjtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuXHJcblxyXG5tYW55d2hvLmNvbXBvbmVudC5yZWdpc3RlcignR29vZ2xlQ2hhcnQnLCBHb29nbGVDaGFydCk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBHb29nbGVDaGFydDtcclxuXHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9Hb29nbGVDaGFydC50c3giLCJpbXBvcnQgeyBjcmVhdGVFbGVtZW50LCBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgKiBhcyBTY3JpcHQgZnJvbSAncmVhY3QtbG9hZC1zY3JpcHQnO1xuXG4vKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG52YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XG5cbnZhciBERUZBVUxUX0NIQVJUX0NPTE9SUyA9IFtcclxuICAgIFwiIzMzNjZDQ1wiLFxyXG4gICAgXCIjREMzOTEyXCIsXHJcbiAgICBcIiNGRjk5MDBcIixcclxuICAgIFwiIzEwOTYxOFwiLFxyXG4gICAgXCIjOTkwMDk5XCIsXHJcbiAgICBcIiMzQjNFQUNcIixcclxuICAgIFwiIzAwOTlDNlwiLFxyXG4gICAgXCIjREQ0NDc3XCIsXHJcbiAgICBcIiM2NkFBMDBcIixcclxuICAgIFwiI0I4MkUyRVwiLFxyXG4gICAgXCIjMzE2Mzk1XCIsXHJcbiAgICBcIiM5OTQ0OTlcIixcclxuICAgIFwiIzIyQUE5OVwiLFxyXG4gICAgXCIjQUFBQTExXCIsXHJcbiAgICBcIiM2NjMzQ0NcIixcclxuICAgIFwiI0U2NzMwMFwiLFxyXG4gICAgXCIjOEIwNzA3XCIsXHJcbiAgICBcIiMzMjkyNjJcIixcclxuICAgIFwiIzU1NzRBNlwiLFxyXG4gICAgXCIjM0IzRUFDXCJcclxuXTtcblxudmFyIFJlYWN0R29vZ2xlQ2hhcnRzTG9hZGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhSZWFjdEdvb2dsZUNoYXJ0c0xvYWRlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFJlYWN0R29vZ2xlQ2hhcnRzTG9hZGVyKHByb3BzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XHJcbiAgICAgICAgdmFyIGRvY3VtZW50U2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xyXG4gICAgICAgIF90aGlzLmxvYWRTY3JpcHQgPSB0cnVlO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9jdW1lbnRTY3JpcHRzLmxlbmd0aDsgaSArPSAxKSB7XHJcbiAgICAgICAgICAgIGlmIChkb2N1bWVudFNjcmlwdHNbaV0uc3JjLmluY2x1ZGVzKFwiZ3N0YXRpYy5jb20vY2hhcnRzL2xvYWRlci5qc1wiKSkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubG9hZFNjcmlwdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFJlYWN0R29vZ2xlQ2hhcnRzTG9hZGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5sb2FkU2NyaXB0ID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uTG9hZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZWFjdEdvb2dsZUNoYXJ0c0xvYWRlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfYSA9IHRoaXMucHJvcHMsIG9uRXJyb3IgPSBfYS5vbkVycm9yLCBvbkxvYWQgPSBfYS5vbkxvYWQ7XHJcbiAgICAgICAgaWYgKHRoaXMubG9hZFNjcmlwdCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gKGNyZWF0ZUVsZW1lbnQoU2NyaXB0LCB7IHVybDogXCJodHRwczovL3d3dy5nc3RhdGljLmNvbS9jaGFydHMvbG9hZGVyLmpzXCIsIG9uRXJyb3I6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICB9LCBvbkxvYWQ6IG9uTG9hZCB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlYWN0R29vZ2xlQ2hhcnRzTG9hZGVyO1xyXG59KENvbXBvbmVudCkpO1xuXG52YXIgX3RoaXMgPSB1bmRlZmluZWQ7XHJcbnZhciBHUkFZX0NPTE9SID0gXCIjQ0NDQ0NDXCI7XHJcbnZhciB1bmlxdWVJRCA9IDA7XHJcbnZhciBnZW5lcmF0ZVVuaXF1ZUlEID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdW5pcXVlSUQgKz0gMTtcclxuICAgIHJldHVybiBcInJlYWN0Z29vZ2xlZ3JhcGgtXCIgKyB1bmlxdWVJRDtcclxufTtcclxudmFyIGNoYXJ0RGVmYXVsdFByb3BzID0ge1xyXG4gICAgZ3JhcGhfaWQ6IG51bGwsXHJcbiAgICBsZWdlbmRfdG9nZ2xlOiBmYWxzZSxcclxuICAgIGdyYXBoSUQ6IG51bGwsXHJcbiAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgY29sb3JzOiBudWxsXHJcbiAgICB9LFxyXG4gICAgZGF0YTogbnVsbCxcclxuICAgIHJvd3M6IG51bGwsXHJcbiAgICBjb2x1bW5zOiBudWxsLFxyXG4gICAgZGlmZmRhdGE6IG51bGwsXHJcbiAgICBjaGFydEV2ZW50czogbnVsbCxcclxuICAgIGxlZ2VuZFRvZ2dsZTogZmFsc2UsXHJcbiAgICBjaGFydEFjdGlvbnM6IG51bGwsXHJcbiAgICBnZXRDaGFydFdyYXBwZXI6IGZ1bmN0aW9uIChjaGFydFdyYXBwZXIsIGdvb2dsZSkgeyB9LFxyXG4gICAgY2xhc3NOYW1lOiBcIlwiLFxyXG4gICAgc3R5bGU6IHt9LFxyXG4gICAgZm9ybWF0dGVyczogbnVsbCxcclxuICAgIHNwcmVhZFNoZWV0VXJsOiBudWxsLFxyXG4gICAgc3ByZWFkU2hlZXRRdWVyeVBhcmFtZXRlcnM6IHtcclxuICAgICAgICBoZWFkZXJzOiAxLFxyXG4gICAgICAgIGdpZDogMVxyXG4gICAgfSxcclxuICAgIHJvb3RQcm9wczoge31cclxufTtcclxudmFyIGxvYWREYXRhVGFibGVGcm9tU3ByZWFkU2hlZXQgPSBmdW5jdGlvbiAoZ29vZ2xlVml6LCBzcHJlYWRTaGVldFVybCwgdXJsUGFyYW1zKSB7XHJcbiAgICBpZiAodXJsUGFyYW1zID09PSB2b2lkIDApIHsgdXJsUGFyYW1zID0ge307IH1cclxuICAgIHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gWzIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IFwiXCIgKyAodXJsUGFyYW1zLmhlYWRlcnMgPyBcImhlYWRlcnM9XCIgKyB1cmxQYXJhbXMuaGVhZGVycyA6IFwiaGVhZGVycz0wXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeVN0cmluZyA9IFwiXCIgKyAodXJsUGFyYW1zLnF1ZXJ5ID8gXCImdHE9XCIgKyBlbmNvZGVVUklDb21wb25lbnQodXJsUGFyYW1zLnF1ZXJ5KSA6IFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBnaWQgPSBcIlwiICsgKHVybFBhcmFtcy5naWQgPyBcIiZnaWQ9XCIgKyB1cmxQYXJhbXMuZ2lkIDogXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNoZWV0ID0gXCJcIiArICh1cmxQYXJhbXMuc2hlZXQgPyBcIiZzaGVldD1cIiArIHVybFBhcmFtcy5zaGVldCA6IFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmxRdWVyeVN0cmluZyA9IFwiXCIgKyBoZWFkZXJzICsgZ2lkICsgc2hlZXQgKyBxdWVyeVN0cmluZztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsVG9TcHJlYWRTaGVldCA9IHNwcmVhZFNoZWV0VXJsICsgXCIvZ3Zpei90cT9cIiArIHVybFF1ZXJ5U3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IG5ldyBnb29nbGVWaXoudmlzdWFsaXphdGlvbi5RdWVyeSh1cmxUb1NwcmVhZFNoZWV0KTtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeS5zZW5kKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuaXNFcnJvcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJFcnJvciBpbiBxdWVyeTogIFwiICsgcmVzcG9uc2UuZ2V0TWVzc2FnZSgpICsgXCIgXCIgKyByZXNwb25zZS5nZXREZXRhaWxlZE1lc3NhZ2UoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlLmdldERhdGFUYWJsZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcbnZhciBDaGFydCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoQ2hhcnQsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBDaGFydCgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgICAgICAgbG9hZGluZ1N0YXR1czogXCJsb2FkaW5nXCIsXHJcbiAgICAgICAgICAgIGdvb2dsZTogbnVsbCxcclxuICAgICAgICAgICAgaGlkZGVuQ29sdW1uczogW11cclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmdyYXBoSUQgPSBudWxsO1xyXG4gICAgICAgIF90aGlzLmNoYXJ0V3JhcHBlciA9IG51bGw7XHJcbiAgICAgICAgX3RoaXMuZ2V0R3JhcGhJRCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hID0gX3RoaXNcclxuICAgICAgICAgICAgICAgIC5wcm9wcywgZ3JhcGhJRCA9IF9hLmdyYXBoSUQsIGdyYXBoX2lkID0gX2EuZ3JhcGhfaWQ7XHJcbiAgICAgICAgICAgIHZhciBpbnN0YW5jZUdyYXBoSUQ7XHJcbiAgICAgICAgICAgIGlmIChncmFwaElEID09PSBudWxsICYmIGdyYXBoX2lkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuZ3JhcGhJRCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlR3JhcGhJRCA9IGdlbmVyYXRlVW5pcXVlSUQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlR3JhcGhJRCA9IF90aGlzLmdyYXBoSUQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZ3JhcGhJRCAhPT0gbnVsbCAmJiBncmFwaF9pZCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2VHcmFwaElEID0gZ3JhcGhJRDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChncmFwaF9pZCAhPT0gbnVsbCAmJiBncmFwaElEID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZUdyYXBoSUQgPSBncmFwaF9pZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlR3JhcGhJRCA9IGdyYXBoSUQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuZ3JhcGhJRCA9IGluc3RhbmNlR3JhcGhJRDtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmdyYXBoSUQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBfdGhpcy5kcmF3ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2EsIGRhdGEsIGRpZmZkYXRhLCBjb2x1bW5zLCByb3dzLCBvcHRpb25zLCBsZWdlbmRfdG9nZ2xlLCBsZWdlbmRUb2dnbGUsIGNoYXJ0VHlwZSwgZm9ybWF0dGVycywgc3ByZWFkU2hlZXRVcmwsIHNwcmVhZFNoZWV0UXVlcnlQYXJhbWV0ZXJzLCBkYXRhVGFibGUsIGNoYXJ0RGlmZiwgb2xkRGF0YSwgbmV3RGF0YSwgY29sdW1uQ291bnQsIGksIGNvbHVtbklELCBwcmV2aW91c0NvbHVtbkxhYmVsLCBwcmV2aW91c0NvbHVtbklELCBwcmV2aW91c0NvbHVtblR5cGUsIGNoYXJ0O1xyXG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGFydFdyYXBwZXIgPT09IG51bGwgfHwgdGhpcy5zdGF0ZS5nb29nbGUgPT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXMucHJvcHMsIGRhdGEgPSBfYS5kYXRhLCBkaWZmZGF0YSA9IF9hLmRpZmZkYXRhLCBjb2x1bW5zID0gX2EuY29sdW1ucywgcm93cyA9IF9hLnJvd3MsIG9wdGlvbnMgPSBfYS5vcHRpb25zLCBsZWdlbmRfdG9nZ2xlID0gX2EubGVnZW5kX3RvZ2dsZSwgbGVnZW5kVG9nZ2xlID0gX2EubGVnZW5kVG9nZ2xlLCBjaGFydFR5cGUgPSBfYS5jaGFydFR5cGUsIGZvcm1hdHRlcnMgPSBfYS5mb3JtYXR0ZXJzLCBzcHJlYWRTaGVldFVybCA9IF9hLnNwcmVhZFNoZWV0VXJsLCBzcHJlYWRTaGVldFF1ZXJ5UGFyYW1ldGVycyA9IF9hLnNwcmVhZFNoZWV0UXVlcnlQYXJhbWV0ZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFydERpZmYgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlmZmRhdGEgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZERhdGEgPSB0aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLmFycmF5VG9EYXRhVGFibGUoZGlmZmRhdGEub2xkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0RhdGEgPSB0aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLmFycmF5VG9EYXRhVGFibGUoZGlmZmRhdGEubmV3KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0RGlmZiA9IHRoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb25bY2hhcnRUeXBlXS5wcm90b3R5cGUuY29tcHV0ZURpZmYob2xkRGF0YSwgbmV3RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGF0YSAhPT0gbnVsbCkpIHJldHVybiBbMywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVGFibGUgPSB0aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLmFycmF5VG9EYXRhVGFibGUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVGFibGUgPSBuZXcgdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5EYXRhVGFibGUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJvd3MgIT09IG51bGwgJiYgY29sdW1ucyAhPT0gbnVsbCkpIHJldHVybiBbMywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUYWJsZSA9IHRoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uYXJyYXlUb0RhdGFUYWJsZShbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uY29uY2F0KHJvd3MpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHNwcmVhZFNoZWV0VXJsICE9PSBudWxsKSkgcmV0dXJuIFszLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBsb2FkRGF0YVRhYmxlRnJvbVNwcmVhZFNoZWV0KHRoaXMuc3RhdGUuZ29vZ2xlLCBzcHJlYWRTaGVldFVybCwgc3ByZWFkU2hlZXRRdWVyeVBhcmFtZXRlcnMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUYWJsZSA9IChfYi5zZW50KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMsIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVRhYmxlID0gdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5hcnJheVRvRGF0YVRhYmxlKFtdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uQ291bnQgPSBkYXRhVGFibGUuZ2V0TnVtYmVyT2ZDb2x1bW5zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb2x1bW5Db3VudDsgaSArPSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5JRCA9IHRoaXMuZ2V0Q29sdW1uSUQoZGF0YVRhYmxlLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmhpZGRlbkNvbHVtbnMuaW5jbHVkZXMoY29sdW1uSUQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXNDb2x1bW5MYWJlbCA9IGRhdGFUYWJsZS5nZXRDb2x1bW5MYWJlbChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91c0NvbHVtbklEID0gZGF0YVRhYmxlLmdldENvbHVtbklkKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzQ29sdW1uVHlwZSA9IGRhdGFUYWJsZS5nZXRDb2x1bW5UeXBlKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUYWJsZS5yZW1vdmVDb2x1bW4oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVRhYmxlLmFkZENvbHVtbih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBwcmV2aW91c0NvbHVtbkxhYmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogcHJldmlvdXNDb2x1bW5JRCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogcHJldmlvdXNDb2x1bW5UeXBlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnQgPSB0aGlzLmNoYXJ0V3JhcHBlci5nZXRDaGFydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGFydFdyYXBwZXIuZ2V0Q2hhcnRUeXBlKCkgPT09IFwiVGltZWxpbmVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnQgJiYgY2hhcnQuY2xlYXJDaGFydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyLnNldE9wdGlvbnMob3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyLnNldERhdGFUYWJsZShkYXRhVGFibGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJ0V3JhcHBlci5kcmF3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFydERpZmYgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyLnNldERhdGFUYWJsZShjaGFydERpZmYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFydFdyYXBwZXIuZHJhdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXR0ZXJzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0dGVycyhkYXRhVGFibGUsIGZvcm1hdHRlcnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFydFdyYXBwZXIuc2V0RGF0YVRhYmxlKGRhdGFUYWJsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJ0V3JhcHBlci5kcmF3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxlZ2VuZFRvZ2dsZSA9PT0gdHJ1ZSB8fCBsZWdlbmRfdG9nZ2xlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdyYXlPdXRIaWRkZW5Db2x1bW5zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH07XHJcbiAgICAgICAgX3RoaXMuYXBwbHlGb3JtYXR0ZXJzID0gZnVuY3Rpb24gKGRhdGFUYWJsZSwgZm9ybWF0dGVycykge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuc3RhdGUuZ29vZ2xlID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGZvcm1hdHRlcnNfMSA9IGZvcm1hdHRlcnM7IF9pIDwgZm9ybWF0dGVyc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZvcm1hdHRlciA9IGZvcm1hdHRlcnNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGZvcm1hdHRlci50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIkFycm93Rm9ybWF0XCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpekZvcm1hdHRlciA9IG5ldyBfdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5BcnJvd0Zvcm1hdChmb3JtYXR0ZXIub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5mb3JtYXQoZGF0YVRhYmxlLCBmb3JtYXR0ZXIuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJCYXJGb3JtYXRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdml6Rm9ybWF0dGVyID0gbmV3IF90aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLkJhckZvcm1hdChmb3JtYXR0ZXIub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5mb3JtYXQoZGF0YVRhYmxlLCBmb3JtYXR0ZXIuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJDb2xvckZvcm1hdFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aXpGb3JtYXR0ZXIgPSBuZXcgX3RoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uQ29sb3JGb3JtYXQoZm9ybWF0dGVyLm9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmFuZ2VzID0gZm9ybWF0dGVyLnJhbmdlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCByYW5nZXNfMSA9IHJhbmdlczsgX2EgPCByYW5nZXNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHJhbmdlc18xW19hXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5hZGRSYW5nZS5hcHBseSh2aXpGb3JtYXR0ZXIsIHJhbmdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aXpGb3JtYXR0ZXIuZm9ybWF0KGRhdGFUYWJsZSwgZm9ybWF0dGVyLmNvbHVtbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiRGF0ZUZvcm1hdFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aXpGb3JtYXR0ZXIgPSBuZXcgX3RoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uRGF0ZUZvcm1hdChmb3JtYXR0ZXIub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5mb3JtYXQoZGF0YVRhYmxlLCBmb3JtYXR0ZXIuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJOdW1iZXJGb3JtYXRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdml6Rm9ybWF0dGVyID0gbmV3IF90aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLk51bWJlckZvcm1hdChmb3JtYXR0ZXIub3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpekZvcm1hdHRlci5mb3JtYXQoZGF0YVRhYmxlLCBmb3JtYXR0ZXIuY29sdW1uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJQYXR0ZXJuRm9ybWF0XCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpekZvcm1hdHRlciA9IG5ldyBfdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5QYXR0ZXJuRm9ybWF0KGZvcm1hdHRlci5vcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdml6Rm9ybWF0dGVyLmZvcm1hdChkYXRhVGFibGUsIGZvcm1hdHRlci5jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmdyYXlPdXRIaWRkZW5Db2x1bW5zID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuY2hhcnRXcmFwcGVyID09PSBudWxsIHx8IF90aGlzLnN0YXRlLmdvb2dsZSA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdmFyIGRhdGFUYWJsZSA9IF90aGlzLmNoYXJ0V3JhcHBlci5nZXREYXRhVGFibGUoKTtcclxuICAgICAgICAgICAgaWYgKGRhdGFUYWJsZSA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdmFyIGNvbHVtbkNvdW50ID0gZGF0YVRhYmxlLmdldE51bWJlck9mQ29sdW1ucygpO1xyXG4gICAgICAgICAgICB2YXIgaGFzQUhpZGRlbkNvbHVtbiA9IF90aGlzLnN0YXRlLmhpZGRlbkNvbHVtbnMubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgaWYgKGhhc0FIaWRkZW5Db2x1bW4gPT09IGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IF90aGlzLnByb3BzLm9wdGlvbnM7XHJcbiAgICAgICAgICAgIHZhciBjb2xvcnMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBjb2x1bW5Db3VudCAtIDEgfSkubWFwKGZ1bmN0aW9uIChkb250Y2FyZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbklEID0gX3RoaXMuZ2V0Q29sdW1uSUQoZGF0YVRhYmxlLCBpICsgMSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc3RhdGUuaGlkZGVuQ29sdW1ucy5pbmNsdWRlcyhjb2x1bW5JRCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gR1JBWV9DT0xPUjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLmNvbG9ycyAhPT0gXCJ1bmRlZmluZWRcIiAmJlxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuY29sb3JzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnMuY29sb3JzW2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERFRkFVTFRfQ0hBUlRfQ09MT1JTW2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgX3RoaXMuY2hhcnRXcmFwcGVyLnNldE9wdGlvbnMoX19hc3NpZ24oe30sIF90aGlzLnByb3BzLm9wdGlvbnMsIHsgY29sb3JzOiBjb2xvcnMgfSkpO1xyXG4gICAgICAgICAgICBfdGhpcy5jaGFydFdyYXBwZXIuZHJhdygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgX3RoaXMub25SZXNpemUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5jaGFydFdyYXBwZXIgPT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIF90aGlzLmNoYXJ0V3JhcHBlci5kcmF3KCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBfdGhpcy5zZXRDaGFydEFjdGlvbnMgPSBmdW5jdGlvbiAoY3VycmVudEFjdGlvbnMsIHByZXZpb3VzQWN0aW9ucykge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuY2hhcnRXcmFwcGVyID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB2YXIgY2hhcnQgPSBfdGhpcy5jaGFydFdyYXBwZXIuZ2V0Q2hhcnQoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBwcmV2aW91c0FjdGlvbnNfMSA9IHByZXZpb3VzQWN0aW9uczsgX2kgPCBwcmV2aW91c0FjdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGFydEFjdGlvbiA9IHByZXZpb3VzQWN0aW9uc18xW19pXTtcclxuICAgICAgICAgICAgICAgIGNoYXJ0LnJlbW92ZUFjdGlvbihjaGFydEFjdGlvbi5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoY2hhcnRBY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGNoYXJ0LnNldEFjdGlvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGNoYXJ0QWN0aW9uLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGNoYXJ0QWN0aW9uLnRleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGFydEFjdGlvbi5hY3Rpb24oX3RoaXMuY2hhcnRXcmFwcGVyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBjdXJyZW50QWN0aW9uc18xID0gY3VycmVudEFjdGlvbnM7IF9hIDwgY3VycmVudEFjdGlvbnNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGFydEFjdGlvbiA9IGN1cnJlbnRBY3Rpb25zXzFbX2FdO1xyXG4gICAgICAgICAgICAgICAgX2xvb3BfMShjaGFydEFjdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmdldENvbHVtbklEID0gZnVuY3Rpb24gKGRhdGFUYWJsZSwgY29sdW1uSW5kZXgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChkYXRhVGFibGUuZ2V0Q29sdW1uSWQoY29sdW1uSW5kZXgpIHx8XHJcbiAgICAgICAgICAgICAgICBkYXRhVGFibGUuZ2V0Q29sdW1uTGFiZWwoY29sdW1uSW5kZXgpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmxpc3RlblRvQ2hhcnRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS5nb29nbGUgPT09IG51bGwgfHwgX3RoaXMuY2hhcnRXcmFwcGVyID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uZXZlbnRzLnJlbW92ZUFsbExpc3RlbmVycyhfdGhpcy5jaGFydFdyYXBwZXIpO1xyXG4gICAgICAgICAgICB2YXIgX2EgPSBfdGhpc1xyXG4gICAgICAgICAgICAgICAgLnByb3BzLCBjaGFydEV2ZW50cyA9IF9hLmNoYXJ0RXZlbnRzLCBsZWdlbmRfdG9nZ2xlID0gX2EubGVnZW5kX3RvZ2dsZSwgbGVnZW5kVG9nZ2xlID0gX2EubGVnZW5kVG9nZ2xlO1xyXG4gICAgICAgICAgICBpZiAoY2hhcnRFdmVudHMgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHZhciBfbG9vcF8yID0gZnVuY3Rpb24gKGV2ZW50XzEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnROYW1lID0gZXZlbnRfMS5ldmVudE5hbWUsIGNhbGxiYWNrID0gZXZlbnRfMS5jYWxsYmFjaztcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdGF0ZS5nb29nbGUudmlzdWFsaXphdGlvbi5ldmVudHMuYWRkTGlzdGVuZXIoX3RoaXMuY2hhcnRXcmFwcGVyLCBldmVudE5hbWUsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY2hhcnRXcmFwcGVyICE9PSBudWxsICYmIF90aGlzLnN0YXRlLmdvb2dsZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJ0V3JhcHBlcjogX3RoaXMuY2hhcnRXcmFwcGVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzOiBfdGhpcy5wcm9wcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb29nbGU6IF90aGlzLnN0YXRlLmdvb2dsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZTogX3RoaXMuc3RhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRBcmdzOiBhcmdzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgY2hhcnRFdmVudHNfMSA9IGNoYXJ0RXZlbnRzOyBfaSA8IGNoYXJ0RXZlbnRzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50XzEgPSBjaGFydEV2ZW50c18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICBfbG9vcF8yKGV2ZW50XzEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChsZWdlbmRUb2dnbGUgPT09IHRydWUgfHwgbGVnZW5kX3RvZ2dsZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubGlzdGVuVG9MZWdlbmRUb2dnbGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgX3RoaXMubGlzdGVuVG9MZWdlbmRUb2dnbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS5nb29nbGUgPT09IG51bGwgfHwgX3RoaXMuY2hhcnRXcmFwcGVyID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX3RoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uZXZlbnRzLmFkZExpc3RlbmVyKF90aGlzLmNoYXJ0V3JhcHBlciwgXCJzZWxlY3RcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmNoYXJ0V3JhcHBlciA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hhcnQgPSBfdGhpcy5jaGFydFdyYXBwZXIuZ2V0Q2hhcnQoKTtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxlY3Rpb24gPSBjaGFydC5nZXRTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhVGFibGUgPSBfdGhpcy5jaGFydFdyYXBwZXIuZ2V0RGF0YVRhYmxlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0aW9uLmxlbmd0aCA9PT0gMCB8fFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvblswXS5yb3cgIT09IG51bGwgfHxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhVGFibGUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgY29sdW1uSW5kZXggPSBzZWxlY3Rpb25bMF0uY29sdW1uO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbklEID0gX3RoaXMuZ2V0Q29sdW1uSUQoZGF0YVRhYmxlLCBjb2x1bW5JbmRleCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc3RhdGUuaGlkZGVuQ29sdW1ucy5pbmNsdWRlcyhjb2x1bW5JRCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAoc3RhdGUpIHsgcmV0dXJuIChfX2Fzc2lnbih7fSwgc3RhdGUsIHsgaGlkZGVuQ29sdW1uczogc3RhdGUuaGlkZGVuQ29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKGNvbElEKSB7IHJldHVybiBjb2xJRCAhPT0gY29sdW1uSUQ7IH0pLnNsaWNlKCkgfSkpOyB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRyYXcoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gKF9fYXNzaWduKHt9LCBzdGF0ZSwgeyBoaWRkZW5Db2x1bW5zOiBzdGF0ZS5oaWRkZW5Db2x1bW5zLmNvbmNhdChbY29sdW1uSURdKSB9KSk7IH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZHJhdygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmhhbmRsZUdvb2dsZUNoYXJ0c0xvYWRlclNjcmlwdExvYWRlZCA9IGZ1bmN0aW9uICh3aW5kb3dHb29nbGVDaGFydHMpIHtcclxuICAgICAgICAgICAgdmFyIF9hID0gX3RoaXMucHJvcHMsIHZlcnNpb24gPSBfYS5jaGFydFZlcnNpb24sIHBhY2thZ2VzID0gX2EuY2hhcnRQYWNrYWdlcywgbGFuZ3VhZ2UgPSBfYS5jaGFydExhbmd1YWdlLCBtYXBzQXBpS2V5ID0gX2EubWFwc0FwaUtleTtcclxuICAgICAgICAgICAgd2luZG93R29vZ2xlQ2hhcnRzLmNoYXJ0cy5sb2FkKHZlcnNpb24gfHwgXCJjdXJyZW50XCIsIHtcclxuICAgICAgICAgICAgICAgIHBhY2thZ2VzOiBwYWNrYWdlcyB8fCBbXCJjb3JlY2hhcnRcIl0sXHJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZTogbGFuZ3VhZ2UgfHwgXCJlblwiLFxyXG4gICAgICAgICAgICAgICAgbWFwc0FwaUtleTogbWFwc0FwaUtleVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgd2luZG93R29vZ2xlQ2hhcnRzLmNoYXJ0cy5zZXRPbkxvYWRDYWxsYmFjayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZShmdW5jdGlvbiAoc3RhdGUpIHsgcmV0dXJuIChfX2Fzc2lnbih7fSwgc3RhdGUsIHsgbG9hZGluZ1N0YXR1czogXCJyZWFkeVwiLCBnb29nbGU6IHdpbmRvd0dvb2dsZUNoYXJ0cyB9KSk7IH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLmhhbmRsZUdvb2dsZUNoYXJ0c0xvYWRlclNjcmlwdEVycm9yZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkgeyByZXR1cm4gKF9fYXNzaWduKHt9LCBzdGF0ZSwgeyBsb2FkaW5nU3RhdHVzOiBcImVycm9yZWRcIiB9KSk7IH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgQ2hhcnQucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBsb2FkaW5nU3RhdHVzOiBcImxvYWRpbmdcIiB9KTtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLm9uUmVzaXplKTtcclxuICAgIH07XHJcbiAgICBDaGFydC5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XHJcbiAgICAgICAgdmFyIHByb3BzID0gdGhpcy5wcm9wcztcclxuICAgICAgICBpZiAocHJldlN0YXRlLmxvYWRpbmdTdGF0dXMgIT09IFwicmVhZHlcIiAmJlxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmxvYWRpbmdTdGF0dXMgPT09IFwicmVhZHlcIiAmJlxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmdvb2dsZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgY2hhcnRDb25maWcgPSB7XHJcbiAgICAgICAgICAgICAgICBjaGFydFR5cGU6IHRoaXMucHJvcHMuY2hhcnRUeXBlLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczogdGhpcy5wcm9wcy5vcHRpb25zLFxyXG4gICAgICAgICAgICAgICAgY29udGFpbmVySWQ6IHRoaXMuZ2V0R3JhcGhJRCgpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyID0gbmV3IHRoaXMuc3RhdGUuZ29vZ2xlLnZpc3VhbGl6YXRpb24uQ2hhcnRXcmFwcGVyKGNoYXJ0Q29uZmlnKTtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5Ub0NoYXJ0RXZlbnRzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhdygpO1xyXG4gICAgICAgICAgICBwcm9wcy5nZXRDaGFydFdyYXBwZXIodGhpcy5jaGFydFdyYXBwZXIsIHRoaXMuc3RhdGUuZ29vZ2xlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJvcHMuY2hhcnRFdmVudHMgIT09IHByZXZQcm9wcy5jaGFydEV2ZW50cykge1xyXG4gICAgICAgICAgICB0aGlzLmxpc3RlblRvQ2hhcnRFdmVudHMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByb3BzLmNoYXJ0QWN0aW9ucyAhPT0gbnVsbCB8fCBwcmV2UHJvcHMuY2hhcnRBY3Rpb25zICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChwcm9wcy5jaGFydEFjdGlvbnMgIT09IHByZXZQcm9wcy5jaGFydEFjdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0Q2hhcnRBY3Rpb25zKHByb3BzLmNoYXJ0QWN0aW9ucywgcHJldlByb3BzLmNoYXJ0QWN0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByb3BzLmRhdGEgIT09IHByZXZQcm9wcy5kYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhdygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocHJvcHMucm93cyAhPT0gcHJldlByb3BzLnJvd3MgfHwgcHJvcHMuY29sdW1ucyAhPT0gcHJldlByb3BzLmNvbHVtbnMpIHtcclxuICAgICAgICAgICAgdGhpcy5kcmF3KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIENoYXJ0LnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5jaGFydFdyYXBwZXIgPT09IG51bGwgfHwgdGhpcy5zdGF0ZS5nb29nbGUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLm9uUmVzaXplKTtcclxuICAgICAgICB0aGlzLnN0YXRlLmdvb2dsZS52aXN1YWxpemF0aW9uLmV2ZW50cy5yZW1vdmVBbGxMaXN0ZW5lcnModGhpcy5jaGFydFdyYXBwZXIpO1xyXG4gICAgICAgIGlmICh0aGlzLmNoYXJ0V3JhcHBlci5nZXRDaGFydFR5cGUoKSA9PT0gXCJUaW1lbGluZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhcnRXcmFwcGVyLmdldENoYXJ0KCkgJiYgdGhpcy5jaGFydFdyYXBwZXIuZ2V0Q2hhcnQoKS5jbGVhckNoYXJ0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIENoYXJ0LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZGl2U3R5bGUgPSBfX2Fzc2lnbih7IGhlaWdodDogdGhpcy5wcm9wcy5oZWlnaHQgfHwgKHRoaXMucHJvcHMub3B0aW9ucyAmJiB0aGlzLnByb3BzLm9wdGlvbnMuaGVpZ2h0KSwgd2lkdGg6IHRoaXMucHJvcHMud2lkdGggfHwgKHRoaXMucHJvcHMub3B0aW9ucyAmJiB0aGlzLnByb3BzLm9wdGlvbnMud2lkdGgpIH0sIHRoaXMucHJvcHMuc3R5bGUpO1xyXG4gICAgICAgIHJldHVybiAoY3JlYXRlRWxlbWVudChcImRpdlwiLCBfX2Fzc2lnbih7IGlkOiB0aGlzLmdldEdyYXBoSUQoKSwgc3R5bGU6IGRpdlN0eWxlLCBjbGFzc05hbWU6IHRoaXMucHJvcHMuY2xhc3NOYW1lIH0sIHRoaXMucHJvcHMucm9vdFByb3BzKSxcclxuICAgICAgICAgICAgY3JlYXRlRWxlbWVudChSZWFjdEdvb2dsZUNoYXJ0c0xvYWRlciwgeyBvbkVycm9yOiB0aGlzLmhhbmRsZUdvb2dsZUNoYXJ0c0xvYWRlclNjcmlwdEVycm9yZWQsIG9uTG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB3aW5kb3dXaXRoR29vZ2xlID0gd2luZG93O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3dXaXRoR29vZ2xlLmdvb2dsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5oYW5kbGVHb29nbGVDaGFydHNMb2FkZXJTY3JpcHRMb2FkZWQod2luZG93V2l0aEdvb2dsZS5nb29nbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gfSksXHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUubG9hZGluZ1N0YXR1cyA9PT0gXCJsb2FkaW5nXCIgJiZcclxuICAgICAgICAgICAgICAgICh0aGlzLnByb3BzLmxvYWRlciA/IHRoaXMucHJvcHMubG9hZGVyIDogXCJSZW5kZXJpbmcgQ2hhcnQuLi5cIikpKTtcclxuICAgIH07XHJcbiAgICBDaGFydC5kZWZhdWx0UHJvcHMgPSBjaGFydERlZmF1bHRQcm9wcztcclxuICAgIHJldHVybiBDaGFydDtcclxufShDb21wb25lbnQpKTtcblxuZXhwb3J0IGRlZmF1bHQgQ2hhcnQ7XG5leHBvcnQgeyBDaGFydCB9O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvcmVhY3QtZ29vZ2xlLWNoYXJ0cy9kaXN0L2luZGV4LmVzbS5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfcmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxudmFyIF9wcm9wVHlwZXMgPSByZXF1aXJlKCdwcm9wLXR5cGVzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxudmFyIFNjcmlwdCA9IGZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhTY3JpcHQsIF9SZWFjdCRDb21wb25lbnQpO1xuXG4gIC8vIEEgZGljdGlvbmFyeSBtYXBwaW5nIHNjcmlwdCBVUkwgdG8gYSBib29sZWFuIHZhbHVlIGluZGljYXRpbmcgaWYgdGhlIHNjcmlwdFxuICAvLyBoYXMgZmFpbGVkIHRvIGxvYWQuXG5cblxuICAvLyBBIGRpY3Rpb25hcnkgbWFwcGluZyBzY3JpcHQgVVJMcyB0byBhIGRpY3Rpb25hcnkgbWFwcGluZ1xuICAvLyBjb21wb25lbnQga2V5IHRvIGNvbXBvbmVudCBmb3IgYWxsIGNvbXBvbmVudHMgdGhhdCBhcmUgd2FpdGluZ1xuICAvLyBmb3IgdGhlIHNjcmlwdCB0byBsb2FkLlxuICBmdW5jdGlvbiBTY3JpcHQocHJvcHMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2NyaXB0KTtcblxuICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChTY3JpcHQuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihTY3JpcHQpKS5jYWxsKHRoaXMsIHByb3BzKSk7XG5cbiAgICBfdGhpcy5zY3JpcHRMb2FkZXJJZCA9ICdpZCcgKyBfdGhpcy5jb25zdHJ1Y3Rvci5pZENvdW50Kys7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgc3BhY2UtdW5hcnktb3BzLCBuby1wbHVzcGx1c1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIC8vIEEgY291bnRlciB1c2VkIHRvIGdlbmVyYXRlIGEgdW5pcXVlIGlkIGZvciBlYWNoIGNvbXBvbmVudCB0aGF0IHVzZXNcbiAgLy8gU2NyaXB0TG9hZGVyTWl4aW4uXG5cblxuICAvLyBBIGRpY3Rpb25hcnkgbWFwcGluZyBzY3JpcHQgVVJMIHRvIGEgYm9vbGVhbiB2YWx1ZSBpbmRpY2F0aW5nIGlmIHRoZSBzY3JpcHRcbiAgLy8gaGFzIGFscmVhZHkgYmVlbiBsb2FkZWQuXG5cblxuICBfY3JlYXRlQ2xhc3MoU2NyaXB0LCBbe1xuICAgIGtleTogJ2NvbXBvbmVudERpZE1vdW50JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICB2YXIgX3Byb3BzID0gdGhpcy5wcm9wcyxcbiAgICAgICAgICBvbkVycm9yID0gX3Byb3BzLm9uRXJyb3IsXG4gICAgICAgICAgb25Mb2FkID0gX3Byb3BzLm9uTG9hZCxcbiAgICAgICAgICB1cmwgPSBfcHJvcHMudXJsO1xuXG5cbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yLmxvYWRlZFNjcmlwdHNbdXJsXSkge1xuICAgICAgICBvbkxvYWQoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3Rvci5lcnJvcmVkU2NyaXB0c1t1cmxdKSB7XG4gICAgICAgIG9uRXJyb3IoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiB0aGUgc2NyaXB0IGlzIGxvYWRpbmcsIGFkZCB0aGUgY29tcG9uZW50IHRvIHRoZSBzY3JpcHQncyBvYnNlcnZlcnNcbiAgICAgIC8vIGFuZCByZXR1cm4uIE90aGVyd2lzZSwgaW5pdGlhbGl6ZSB0aGUgc2NyaXB0J3Mgb2JzZXJ2ZXJzIHdpdGggdGhlIGNvbXBvbmVudFxuICAgICAgLy8gYW5kIHN0YXJ0IGxvYWRpbmcgdGhlIHNjcmlwdC5cbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yLnNjcmlwdE9ic2VydmVyc1t1cmxdKSB7XG4gICAgICAgIHRoaXMuY29uc3RydWN0b3Iuc2NyaXB0T2JzZXJ2ZXJzW3VybF1bdGhpcy5zY3JpcHRMb2FkZXJJZF0gPSB0aGlzLnByb3BzO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY29uc3RydWN0b3Iuc2NyaXB0T2JzZXJ2ZXJzW3VybF0gPSBfZGVmaW5lUHJvcGVydHkoe30sIHRoaXMuc2NyaXB0TG9hZGVySWQsIHRoaXMucHJvcHMpO1xuXG4gICAgICB0aGlzLmNyZWF0ZVNjcmlwdCgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2NvbXBvbmVudFdpbGxVbm1vdW50JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICB2YXIgdXJsID0gdGhpcy5wcm9wcy51cmw7XG5cbiAgICAgIHZhciBvYnNlcnZlcnMgPSB0aGlzLmNvbnN0cnVjdG9yLnNjcmlwdE9ic2VydmVyc1t1cmxdO1xuXG4gICAgICAvLyBJZiB0aGUgY29tcG9uZW50IGlzIHdhaXRpbmcgZm9yIHRoZSBzY3JpcHQgdG8gbG9hZCwgcmVtb3ZlIHRoZVxuICAgICAgLy8gY29tcG9uZW50IGZyb20gdGhlIHNjcmlwdCdzIG9ic2VydmVycyBiZWZvcmUgdW5tb3VudGluZyB0aGUgY29tcG9uZW50LlxuICAgICAgaWYgKG9ic2VydmVycykge1xuICAgICAgICBkZWxldGUgb2JzZXJ2ZXJzW3RoaXMuc2NyaXB0TG9hZGVySWRdO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2NyZWF0ZVNjcmlwdCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVNjcmlwdCgpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICB2YXIgX3Byb3BzMiA9IHRoaXMucHJvcHMsXG4gICAgICAgICAgb25DcmVhdGUgPSBfcHJvcHMyLm9uQ3JlYXRlLFxuICAgICAgICAgIHVybCA9IF9wcm9wczIudXJsLFxuICAgICAgICAgIGF0dHJpYnV0ZXMgPSBfcHJvcHMyLmF0dHJpYnV0ZXM7XG5cbiAgICAgIHZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcblxuICAgICAgb25DcmVhdGUoKTtcblxuICAgICAgLy8gYWRkICdkYXRhLScgb3Igbm9uIHN0YW5kYXJkIGF0dHJpYnV0ZXMgdG8gdGhlIHNjcmlwdCB0YWdcbiAgICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgICByZXR1cm4gc2NyaXB0LnNldEF0dHJpYnV0ZShwcm9wLCBhdHRyaWJ1dGVzW3Byb3BdKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHNjcmlwdC5zcmMgPSB1cmw7XG5cbiAgICAgIC8vIGRlZmF1bHQgYXN5bmMgdG8gdHJ1ZSBpZiBub3Qgc2V0IHdpdGggY3VzdG9tIGF0dHJpYnV0ZXNcbiAgICAgIGlmICghc2NyaXB0Lmhhc0F0dHJpYnV0ZSgnYXN5bmMnKSkge1xuICAgICAgICBzY3JpcHQuYXN5bmMgPSAxO1xuICAgICAgfVxuXG4gICAgICB2YXIgY2FsbE9ic2VydmVyRnVuY0FuZFJlbW92ZU9ic2VydmVyID0gZnVuY3Rpb24gY2FsbE9ic2VydmVyRnVuY0FuZFJlbW92ZU9ic2VydmVyKHNob3VsZFJlbW92ZU9ic2VydmVyKSB7XG4gICAgICAgIHZhciBvYnNlcnZlcnMgPSBfdGhpczIuY29uc3RydWN0b3Iuc2NyaXB0T2JzZXJ2ZXJzW3VybF07XG4gICAgICAgIE9iamVjdC5rZXlzKG9ic2VydmVycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgaWYgKHNob3VsZFJlbW92ZU9ic2VydmVyKG9ic2VydmVyc1trZXldKSkge1xuICAgICAgICAgICAgZGVsZXRlIF90aGlzMi5jb25zdHJ1Y3Rvci5zY3JpcHRPYnNlcnZlcnNbdXJsXVtfdGhpczIuc2NyaXB0TG9hZGVySWRdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgc2NyaXB0Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMyLmNvbnN0cnVjdG9yLmxvYWRlZFNjcmlwdHNbdXJsXSA9IHRydWU7XG4gICAgICAgIGNhbGxPYnNlcnZlckZ1bmNBbmRSZW1vdmVPYnNlcnZlcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICBvYnNlcnZlci5vbkxvYWQoKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICBzY3JpcHQub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMyLmNvbnN0cnVjdG9yLmVycm9yZWRTY3JpcHRzW3VybF0gPSB0cnVlO1xuICAgICAgICBjYWxsT2JzZXJ2ZXJGdW5jQW5kUmVtb3ZlT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgb2JzZXJ2ZXIub25FcnJvcigpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdyZW5kZXInLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gU2NyaXB0O1xufShfcmVhY3QyLmRlZmF1bHQuQ29tcG9uZW50KTtcblxuU2NyaXB0LnByb3BUeXBlcyA9IHtcbiAgYXR0cmlidXRlczogX3Byb3BUeXBlcy5Qcm9wVHlwZXMub2JqZWN0LCAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHJlYWN0L2ZvcmJpZC1wcm9wLXR5cGVzXG4gIG9uQ3JlYXRlOiBfcHJvcFR5cGVzLlByb3BUeXBlcy5mdW5jLFxuICBvbkVycm9yOiBfcHJvcFR5cGVzLlByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIG9uTG9hZDogX3Byb3BUeXBlcy5Qcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB1cmw6IF9wcm9wVHlwZXMuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkXG59O1xuU2NyaXB0LmRlZmF1bHRQcm9wcyA9IHtcbiAgYXR0cmlidXRlczoge30sXG4gIG9uQ3JlYXRlOiBmdW5jdGlvbiBvbkNyZWF0ZSgpIHt9LFxuICBvbkVycm9yOiBmdW5jdGlvbiBvbkVycm9yKCkge30sXG4gIG9uTG9hZDogZnVuY3Rpb24gb25Mb2FkKCkge30gfTtcblNjcmlwdC5zY3JpcHRPYnNlcnZlcnMgPSB7fTtcblNjcmlwdC5sb2FkZWRTY3JpcHRzID0ge307XG5TY3JpcHQuZXJyb3JlZFNjcmlwdHMgPSB7fTtcblNjcmlwdC5pZENvdW50ID0gMDtcbmV4cG9ydHMuZGVmYXVsdCA9IFNjcmlwdDtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vbm9kZV9tb2R1bGVzL3JlYWN0LWxvYWQtc2NyaXB0L2xpYi9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxMy1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gIHZhciBSRUFDVF9FTEVNRU5UX1RZUEUgPSAodHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgIFN5bWJvbC5mb3IgJiZcbiAgICBTeW1ib2wuZm9yKCdyZWFjdC5lbGVtZW50JykpIHx8XG4gICAgMHhlYWM3O1xuXG4gIHZhciBpc1ZhbGlkRWxlbWVudCA9IGZ1bmN0aW9uKG9iamVjdCkge1xuICAgIHJldHVybiB0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JyAmJlxuICAgICAgb2JqZWN0ICE9PSBudWxsICYmXG4gICAgICBvYmplY3QuJCR0eXBlb2YgPT09IFJFQUNUX0VMRU1FTlRfVFlQRTtcbiAgfTtcblxuICAvLyBCeSBleHBsaWNpdGx5IHVzaW5nIGBwcm9wLXR5cGVzYCB5b3UgYXJlIG9wdGluZyBpbnRvIG5ldyBkZXZlbG9wbWVudCBiZWhhdmlvci5cbiAgLy8gaHR0cDovL2ZiLm1lL3Byb3AtdHlwZXMtaW4tcHJvZFxuICB2YXIgdGhyb3dPbkRpcmVjdEFjY2VzcyA9IHRydWU7XG4gIG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9mYWN0b3J5V2l0aFR5cGVDaGVja2VycycpKGlzVmFsaWRFbGVtZW50LCB0aHJvd09uRGlyZWN0QWNjZXNzKTtcbn0gZWxzZSB7XG4gIC8vIEJ5IGV4cGxpY2l0bHkgdXNpbmcgYHByb3AtdHlwZXNgIHlvdSBhcmUgb3B0aW5nIGludG8gbmV3IHByb2R1Y3Rpb24gYmVoYXZpb3IuXG4gIC8vIGh0dHA6Ly9mYi5tZS9wcm9wLXR5cGVzLWluLXByb2RcbiAgbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2ZhY3RvcnlXaXRoVGhyb3dpbmdTaGltcycpKCk7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL25vZGVfbW9kdWxlcy9wcm9wLXR5cGVzL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSA1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDEzLXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgZW1wdHlGdW5jdGlvbiA9IHJlcXVpcmUoJ2ZianMvbGliL2VtcHR5RnVuY3Rpb24nKTtcbnZhciBpbnZhcmlhbnQgPSByZXF1aXJlKCdmYmpzL2xpYi9pbnZhcmlhbnQnKTtcbnZhciBSZWFjdFByb3BUeXBlc1NlY3JldCA9IHJlcXVpcmUoJy4vbGliL1JlYWN0UHJvcFR5cGVzU2VjcmV0Jyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIHNoaW0ocHJvcHMsIHByb3BOYW1lLCBjb21wb25lbnROYW1lLCBsb2NhdGlvbiwgcHJvcEZ1bGxOYW1lLCBzZWNyZXQpIHtcbiAgICBpZiAoc2VjcmV0ID09PSBSZWFjdFByb3BUeXBlc1NlY3JldCkge1xuICAgICAgLy8gSXQgaXMgc3RpbGwgc2FmZSB3aGVuIGNhbGxlZCBmcm9tIFJlYWN0LlxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpbnZhcmlhbnQoXG4gICAgICBmYWxzZSxcbiAgICAgICdDYWxsaW5nIFByb3BUeXBlcyB2YWxpZGF0b3JzIGRpcmVjdGx5IGlzIG5vdCBzdXBwb3J0ZWQgYnkgdGhlIGBwcm9wLXR5cGVzYCBwYWNrYWdlLiAnICtcbiAgICAgICdVc2UgUHJvcFR5cGVzLmNoZWNrUHJvcFR5cGVzKCkgdG8gY2FsbCB0aGVtLiAnICtcbiAgICAgICdSZWFkIG1vcmUgYXQgaHR0cDovL2ZiLm1lL3VzZS1jaGVjay1wcm9wLXR5cGVzJ1xuICAgICk7XG4gIH07XG4gIHNoaW0uaXNSZXF1aXJlZCA9IHNoaW07XG4gIGZ1bmN0aW9uIGdldFNoaW0oKSB7XG4gICAgcmV0dXJuIHNoaW07XG4gIH07XG4gIC8vIEltcG9ydGFudCFcbiAgLy8gS2VlcCB0aGlzIGxpc3QgaW4gc3luYyB3aXRoIHByb2R1Y3Rpb24gdmVyc2lvbiBpbiBgLi9mYWN0b3J5V2l0aFR5cGVDaGVja2Vycy5qc2AuXG4gIHZhciBSZWFjdFByb3BUeXBlcyA9IHtcbiAgICBhcnJheTogc2hpbSxcbiAgICBib29sOiBzaGltLFxuICAgIGZ1bmM6IHNoaW0sXG4gICAgbnVtYmVyOiBzaGltLFxuICAgIG9iamVjdDogc2hpbSxcbiAgICBzdHJpbmc6IHNoaW0sXG4gICAgc3ltYm9sOiBzaGltLFxuXG4gICAgYW55OiBzaGltLFxuICAgIGFycmF5T2Y6IGdldFNoaW0sXG4gICAgZWxlbWVudDogc2hpbSxcbiAgICBpbnN0YW5jZU9mOiBnZXRTaGltLFxuICAgIG5vZGU6IHNoaW0sXG4gICAgb2JqZWN0T2Y6IGdldFNoaW0sXG4gICAgb25lT2Y6IGdldFNoaW0sXG4gICAgb25lT2ZUeXBlOiBnZXRTaGltLFxuICAgIHNoYXBlOiBnZXRTaGltLFxuICAgIGV4YWN0OiBnZXRTaGltXG4gIH07XG5cbiAgUmVhY3RQcm9wVHlwZXMuY2hlY2tQcm9wVHlwZXMgPSBlbXB0eUZ1bmN0aW9uO1xuICBSZWFjdFByb3BUeXBlcy5Qcm9wVHlwZXMgPSBSZWFjdFByb3BUeXBlcztcblxuICByZXR1cm4gUmVhY3RQcm9wVHlwZXM7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy9mYWN0b3J5V2l0aFRocm93aW5nU2hpbXMuanNcbi8vIG1vZHVsZSBpZCA9IDZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDEzLXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogXG4gKi9cblxuZnVuY3Rpb24gbWFrZUVtcHR5RnVuY3Rpb24oYXJnKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGFyZztcbiAgfTtcbn1cblxuLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIGFjY2VwdHMgYW5kIGRpc2NhcmRzIGlucHV0czsgaXQgaGFzIG5vIHNpZGUgZWZmZWN0cy4gVGhpcyBpc1xuICogcHJpbWFyaWx5IHVzZWZ1bCBpZGlvbWF0aWNhbGx5IGZvciBvdmVycmlkYWJsZSBmdW5jdGlvbiBlbmRwb2ludHMgd2hpY2hcbiAqIGFsd2F5cyBuZWVkIHRvIGJlIGNhbGxhYmxlLCBzaW5jZSBKUyBsYWNrcyBhIG51bGwtY2FsbCBpZGlvbSBhbGEgQ29jb2EuXG4gKi9cbnZhciBlbXB0eUZ1bmN0aW9uID0gZnVuY3Rpb24gZW1wdHlGdW5jdGlvbigpIHt9O1xuXG5lbXB0eUZ1bmN0aW9uLnRoYXRSZXR1cm5zID0gbWFrZUVtcHR5RnVuY3Rpb247XG5lbXB0eUZ1bmN0aW9uLnRoYXRSZXR1cm5zRmFsc2UgPSBtYWtlRW1wdHlGdW5jdGlvbihmYWxzZSk7XG5lbXB0eUZ1bmN0aW9uLnRoYXRSZXR1cm5zVHJ1ZSA9IG1ha2VFbXB0eUZ1bmN0aW9uKHRydWUpO1xuZW1wdHlGdW5jdGlvbi50aGF0UmV0dXJuc051bGwgPSBtYWtlRW1wdHlGdW5jdGlvbihudWxsKTtcbmVtcHR5RnVuY3Rpb24udGhhdFJldHVybnNUaGlzID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcztcbn07XG5lbXB0eUZ1bmN0aW9uLnRoYXRSZXR1cm5zQXJndW1lbnQgPSBmdW5jdGlvbiAoYXJnKSB7XG4gIHJldHVybiBhcmc7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGVtcHR5RnVuY3Rpb247XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvZmJqcy9saWIvZW1wdHlGdW5jdGlvbi5qc1xuLy8gbW9kdWxlIGlkID0gN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxMy1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogVXNlIGludmFyaWFudCgpIHRvIGFzc2VydCBzdGF0ZSB3aGljaCB5b3VyIHByb2dyYW0gYXNzdW1lcyB0byBiZSB0cnVlLlxuICpcbiAqIFByb3ZpZGUgc3ByaW50Zi1zdHlsZSBmb3JtYXQgKG9ubHkgJXMgaXMgc3VwcG9ydGVkKSBhbmQgYXJndW1lbnRzXG4gKiB0byBwcm92aWRlIGluZm9ybWF0aW9uIGFib3V0IHdoYXQgYnJva2UgYW5kIHdoYXQgeW91IHdlcmVcbiAqIGV4cGVjdGluZy5cbiAqXG4gKiBUaGUgaW52YXJpYW50IG1lc3NhZ2Ugd2lsbCBiZSBzdHJpcHBlZCBpbiBwcm9kdWN0aW9uLCBidXQgdGhlIGludmFyaWFudFxuICogd2lsbCByZW1haW4gdG8gZW5zdXJlIGxvZ2ljIGRvZXMgbm90IGRpZmZlciBpbiBwcm9kdWN0aW9uLlxuICovXG5cbnZhciB2YWxpZGF0ZUZvcm1hdCA9IGZ1bmN0aW9uIHZhbGlkYXRlRm9ybWF0KGZvcm1hdCkge307XG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gIHZhbGlkYXRlRm9ybWF0ID0gZnVuY3Rpb24gdmFsaWRhdGVGb3JtYXQoZm9ybWF0KSB7XG4gICAgaWYgKGZvcm1hdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludmFyaWFudCByZXF1aXJlcyBhbiBlcnJvciBtZXNzYWdlIGFyZ3VtZW50Jyk7XG4gICAgfVxuICB9O1xufVxuXG5mdW5jdGlvbiBpbnZhcmlhbnQoY29uZGl0aW9uLCBmb3JtYXQsIGEsIGIsIGMsIGQsIGUsIGYpIHtcbiAgdmFsaWRhdGVGb3JtYXQoZm9ybWF0KTtcblxuICBpZiAoIWNvbmRpdGlvbikge1xuICAgIHZhciBlcnJvcjtcbiAgICBpZiAoZm9ybWF0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGVycm9yID0gbmV3IEVycm9yKCdNaW5pZmllZCBleGNlcHRpb24gb2NjdXJyZWQ7IHVzZSB0aGUgbm9uLW1pbmlmaWVkIGRldiBlbnZpcm9ubWVudCAnICsgJ2ZvciB0aGUgZnVsbCBlcnJvciBtZXNzYWdlIGFuZCBhZGRpdGlvbmFsIGhlbHBmdWwgd2FybmluZ3MuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBhcmdzID0gW2EsIGIsIGMsIGQsIGUsIGZdO1xuICAgICAgdmFyIGFyZ0luZGV4ID0gMDtcbiAgICAgIGVycm9yID0gbmV3IEVycm9yKGZvcm1hdC5yZXBsYWNlKC8lcy9nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBhcmdzW2FyZ0luZGV4KytdO1xuICAgICAgfSkpO1xuICAgICAgZXJyb3IubmFtZSA9ICdJbnZhcmlhbnQgVmlvbGF0aW9uJztcbiAgICB9XG5cbiAgICBlcnJvci5mcmFtZXNUb1BvcCA9IDE7IC8vIHdlIGRvbid0IGNhcmUgYWJvdXQgaW52YXJpYW50J3Mgb3duIGZyYW1lXG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpbnZhcmlhbnQ7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvZmJqcy9saWIvaW52YXJpYW50LmpzXG4vLyBtb2R1bGUgaWQgPSA4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDEzLXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgUmVhY3RQcm9wVHlwZXNTZWNyZXQgPSAnU0VDUkVUX0RPX05PVF9QQVNTX1RISVNfT1JfWU9VX1dJTExfQkVfRklSRUQnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0UHJvcFR5cGVzU2VjcmV0O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvcHJvcC10eXBlcy9saWIvUmVhY3RQcm9wVHlwZXNTZWNyZXQuanNcbi8vIG1vZHVsZSBpZCA9IDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==